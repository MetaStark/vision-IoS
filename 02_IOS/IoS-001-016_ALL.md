Dashboard LLM Interface â€” Context Hydration Layer (CHL) Workflow Specification

Canonical Version: 2026.DRAFT.1
Owner: Dashboard Team (Interface), STIG (Technical Authority), VEGA (Governance Oversight)
Purpose: Define exactly how canonical system context and user prompts are combined and delivered to any LLM advisor, without drift, override or ambiguity.
Scope: All LLM calls originating from FjordHQ dashboards.

1. Mission of CHL

The Context Hydration Layer (CHL) ensures that every LLM request from the dashboard is fully saturated with canonical system truth before any user input is considered.

CHL guarantees:

System truth is always applied first

User prompt is always applied second

LLM can never override or ignore the context_package

All calls are consistent, auditable and role-aligned

It is the delivery glue between IoS-013 Truth Gateway and the LLM.

2. Position in the Architecture

Runtime chain:

IoS-013 (ASPE + CDS)
      â†“
Truth Gateway (Interface)
      â†“
CHL (Dashboard Middleware)
      â†“
LLM Advisor (via LLM API)
      â†“
Response â†’ Dashboard UI


IoS-013: produces and validates context

Truth Gateway: returns atomic, signed truth_payload

CHL: merges truth_payload + user prompt into one governed LLM request

3. CHL Workflow â€“ Exact Sequence

For every LLM call from the dashboard, CHL must follow this sequence:

Receive user_intent from UI (raw text + selected advisor role).

Call IoS-013 Truth Gateway to obtain truth_payload:

context_package

context_hash

issued_at

integrity_signature

Validate that truth_payload is present and marked valid.

Construct LLM SYSTEM CONTEXT from context_package + role + constraints:

state_vector

adr_index

ios_index

authority_map

operational_constraints

llm_role

constitutional prohibitions

Attach user prompt as separate, lower-priority content.

Send full request to LLM API.

Bind returned output to:

state_snapshot_hash

context_hash

quad_hash (if applicable)
and log that binding.

No step may be skipped.
No parallel path is allowed.

4. Separation of System Context vs User Prompt

CHL must enforce a hard separation between:

SYSTEM_CONTEXT (immutable, from IoS-013)

USER_PROMPT (mutable, from dashboard user)

Rules:

SYSTEM_CONTEXT is injected at system-level / high priority.

USER_PROMPT is injected at dialogue-level / normal priority.

USER_PROMPT can never override or negate SYSTEM_CONTEXT.

CHL must not modify or filter the context_package.

CHL is a conduit, not an editor, for system truth.

5. Governance Constraints Enforced by CHL

CHL must ensure the following before sending any LLM request:

A valid truth_payload has been obtained from IoS-013.

state_snapshot_hash is present and non-stale (ADR-018).

llm_role is defined and consistent with authority_map.

Operational constraints (LIDS threshold, DEFCON, RISL) are embedded.

No user-supplied text is placed before system context.

If any of these fail â†’ the call is not sent.

6. Fail-Closed Behavior

If CHL detects:

missing or invalid truth_payload

failed validations from Truth Gateway

inconsistent role vs authority_map

internal errors assembling SYSTEM_CONTEXT

Then CHL must:

Abort the LLM call.

Return an error to the dashboard (e.g. â€œSystem context unavailable â€“ reasoning blockedâ€).

Raise a governance event for VEGA (for monitoring/triage).

No fallback to:

cached context

partial context

hardcoded defaults

â€œbest effortâ€ prompts

If context fails, the safest answer is no answer.

7. Logging & Audit

CHL must log, for each LLM call:

agent_id / advisor_id

llm_role

reference to truth_payload (hash / id)

timestamp

whether call was SENT or BLOCKED

state_snapshot_hash + context_hash + (if relevant) quad_hash

LLM output must be stored with a pointer back to:

the exact state that governed it

the exact context_hash that hydrated it

This completes the Context â†’ Reasoning â†’ Output chain.

8. Responsibilities

Dashboard Team

Implement CHL workflow exactly as specified.

Ensure all LLM calls pass through CHL â€“ no bypass.

STIG

Guarantee IoS-013 Truth Gateway contract is stable and documented.

Provide schema and test fixtures for CHL implementers.

VEGA

Monitor CHL logs.

Flag any LLM request that did not pass through CHL.

Treat any bypass as a governance violation under ADR-018.

9. Success Criteria

CHL is successful when:

Every advisor-LLM sees the same system reality.

No LLM request leaves the dashboard without valid system context.

No reasoning occurs if IoS-013 is unavailable or fails validation.

All outputs can be tied back to a specific state and context_hash.

You can switch between advisors in dashboardet og fÃ¥ identisk fakta om systemet â€“ uansett tidligere samtaler.
# G0 CHANGE PROPOSAL: CEIO Geopolitical Friction Mandate Expansion

**Proposal ID:** G0-2026-019
**Submitted By:** STIG (EC-003)
**Submission Date:** 2026-01-19
**Classification:** MANDATE_EXPANSION
**Priority:** P1
**Target Agent:** CEIO (Chief External Intelligence Officer)

---

## 1. EXECUTIVE SUMMARY

This proposal expands CEIO's mandate from traditional macro-economic intelligence to include **geopolitical friction monitoring**, enabling FjordHQ to detect and respond to structural shifts in global liquidity architecture.

**Strategic Context:** The activation of BRICS Bridge (mBridge), Brazil's Drex CBDC interoperability, and Trump-era tariff escalation (30-245%) represent a "Financial Fission" - the fragmentation of dollar hegemony as the single source of global liquidity truth.

**Core Thesis:** FjordHQ must evolve from linear trend perception to **causal regime understanding** by treating geopolitical friction as a first-class macro factor.

---

## 2. CONSTITUTIONAL ALIGNMENT

### 2.1 ADR-014 Compliance (Sub-Executive Governance)

CEIO's current mandate per ADR-014:
> "Chief External Intelligence Officer: Hente og transformere eksterne data (nyheter, makro, sentiment) til en styringsklar signalstruktur"

**Expansion Justification:** Geopolitical friction (tariffs, sanctions, alternative settlement systems) is a macro input that directly affects regime classification and asset allocation. This expansion is a natural extension of CEIO's "eksterne data" mandate, not a new authority.

### 2.2 IoS Integration Matrix

| IoS | Integration Point | Change Type |
|-----|------------------|-------------|
| IoS-001 | New canonical asset: Geopolitical Friction Index | EXTENDS |
| IoS-003 | New regime: `BIFURCATED_LIQUIDITY` | EXTENDS |
| IoS-006 | New feature cluster: `GEOPOLITICAL_FRICTION` | EXTENDS |
| IoS-007 | New causal edges: BRICS â†’ De-dollarization â†’ Crypto | EXTENDS |
| IoS-008 | TTL reduction during geopolitical volatility | CONFIGURES |

### 2.3 ADR-013 Compliance (One-Source-of-Truth)

All geopolitical data flows through `fhq_macro.macro_nodes` as the canonical layer. No parallel truth structures created.

---

## 3. SCOPE DEFINITION

### 3.1 In Scope

1. **Data Source Expansion**
   - USTR (US Trade Representative) - Tariff schedules
   - BIS (Bank for International Settlements) - Cross-border payment flows
   - IMF COFER - Currency composition of foreign exchange reserves
   - Alternative settlement monitoring (mBridge, CIPS, SPFS)

2. **Macro Node Creation**
   - `MACRO_GEOPOLITICAL_FRICTION` - Composite de-dollarization pressure index
   - `MACRO_TARIFF_EFFECTIVE_RATE` - Trade-weighted average tariff rate
   - `MACRO_BRICS_SETTLEMENT_SHARE` - Non-USD international settlement percentage
   - `MACRO_SANCTIONS_INTENSITY` - Active sanctions count and scope

3. **Causal Edge Modeling**
   - `TARIFF_RATE â†’ DXY` (AMPLIFIES)
   - `BRICS_SETTLEMENT â†’ DXY` (INHIBITS)
   - `GEOPOLITICAL_FRICTION â†’ BTC-USD` (LEADS)
   - `SANCTIONS_INTENSITY â†’ CRYPTO_ADOPTION` (AMPLIFIES)

4. **Regime Extension**
   - New regime: `BIFURCATED_LIQUIDITY`
   - Trigger conditions and hysteresis rules

### 3.2 Out of Scope

- Direct trading signals from geopolitical events (remains FINN/LINE domain)
- Political sentiment analysis (not quantifiable per ADR-003)
- Predictive modeling of government actions (outside epistemic boundary)
- Real-time news feed processing (latency concerns)

---

## 4. TECHNICAL SPECIFICATION

### 4.1 New Data Sources (fhq_governance.approved_data_sources)

| Source Code | Source Name | Type | Verification Method |
|-------------|-------------|------|---------------------|
| USTR | US Trade Representative | GOVERNMENT_AGENCY | Official publication cross-check |
| BIS | Bank for International Settlements | INTERNATIONAL_ORG | API with hash verification |
| IMF_COFER | IMF Currency Composition | INTERNATIONAL_ORG | Quarterly publication |
| SWIFT_GPI | SWIFT gpi Tracker | FINANCIAL_INFRA | Licensed data feed |

### 4.2 New Macro Nodes (fhq_macro.macro_nodes)

```sql
-- Geopolitical Friction Index (Composite)
{
  node_id: 'MACRO_GEOPOLITICAL_FRICTION',
  node_type: 'MACRO_FACTOR',
  subtype: 'GEOPOLITICAL',
  description: 'Composite de-dollarization pressure index',
  source_tier: 'DERIVED',
  frequency: 'WEEKLY',
  stress_threshold: 0.70,
  extreme_threshold: 0.85
}

-- Effective Tariff Rate
{
  node_id: 'MACRO_TARIFF_EFFECTIVE_RATE',
  node_type: 'MACRO_FACTOR',
  subtype: 'TRADE',
  description: 'Trade-weighted average US tariff rate',
  source_tier: 'LAKE',
  source_provider: 'USTR',
  frequency: 'MONTHLY',
  stress_threshold: 15.0,  -- percent
  extreme_threshold: 25.0
}

-- BRICS Settlement Share
{
  node_id: 'MACRO_BRICS_SETTLEMENT_SHARE',
  node_type: 'MACRO_FACTOR',
  subtype: 'LIQUIDITY',
  description: 'Non-USD international settlement percentage',
  source_tier: 'PULSE',
  source_provider: 'BIS',
  frequency: 'QUARTERLY',
  stress_threshold: 20.0,  -- percent
  extreme_threshold: 30.0
}

-- Sanctions Intensity
{
  node_id: 'MACRO_SANCTIONS_INTENSITY',
  node_type: 'MACRO_FACTOR',
  subtype: 'GEOPOLITICAL',
  description: 'Active US/EU sanctions programs count and scope',
  source_tier: 'LAKE',
  source_provider: 'OFAC',
  frequency: 'WEEKLY'
}
```

### 4.3 New Causal Edges (fhq_macro.macro_edges)

| Source | Target | Edge Type | Hypothesis |
|--------|--------|-----------|------------|
| MACRO_TARIFF_EFFECTIVE_RATE | MACRO_DXY | AMPLIFIES | Higher tariffs strengthen USD short-term |
| MACRO_BRICS_SETTLEMENT_SHARE | MACRO_DXY | INHIBITS | Alternative settlement weakens USD demand |
| MACRO_GEOPOLITICAL_FRICTION | BTC-USD | LEADS | Friction drives neutral reserve adoption |
| MACRO_SANCTIONS_INTENSITY | MACRO_BRICS_SETTLEMENT_SHARE | AMPLIFIES | Sanctions accelerate BRICS adoption |
| MACRO_GEOPOLITICAL_FRICTION | MACRO_VIX | AMPLIFIES | Friction increases market uncertainty |

### 4.4 New Regime Definition (IoS-003)

```yaml
regime: BIFURCATED_LIQUIDITY
description: "Global liquidity split between USD and alternative settlement systems"
trigger_conditions:
  - MACRO_BRICS_SETTLEMENT_SHARE > 15%
  - MACRO_TARIFF_EFFECTIVE_RATE > 20%
  - MACRO_GEOPOLITICAL_FRICTION > 0.60
hysteresis:
  entry_confirmation_days: 5
  exit_confirmation_days: 10
implications:
  - Reduce confidence in USD-correlated forecasts
  - Increase weight on crypto as neutral reserve
  - Shorten TTL on all macro-driven decisions
```

---

## 5. CEIO MANDATE EXPANSION

### 5.1 Current Mandate (Per ADR-014)

```
CEIO shall:
- Ingest external macro data from approved sources
- Transform raw data into signal-ready structures
- Maintain data freshness per IoS-001 standards
- Report to STIG for infrastructure, FINN for research integration
```

### 5.2 Expanded Mandate (Post-Approval)

```
CEIO shall additionally:
- Monitor geopolitical friction indicators from approved sources
- Compute and maintain MACRO_GEOPOLITICAL_FRICTION composite index
- Alert LARS when friction exceeds stress_threshold
- Provide weekly briefing to CEO on de-dollarization metrics
- Trigger DEFCON escalation if extreme_threshold breached
- Coordinate with CRIO for causal hypothesis validation
```

### 5.3 New CEIO Contracts

| Trigger Event | Expected Action | SLA |
|---------------|-----------------|-----|
| GEOPOLITICAL_DATA_REFRESH | Update friction nodes | 6 hours |
| FRICTION_STRESS_THRESHOLD | Alert LARS + CEO | 30 minutes |
| FRICTION_EXTREME_THRESHOLD | Trigger DEFCON-3 | 10 minutes |
| TARIFF_ANNOUNCEMENT | Capture and quantify | 4 hours |

---

## 6. IMPLEMENTATION PLAN

### Phase 1: Infrastructure (Days 1-3)
- [ ] Migration 311: Create geopolitical friction tables and nodes
- [ ] Approve new data sources in governance registry
- [ ] Register CEIO expanded contracts

### Phase 2: Data Ingestion (Days 4-7)
- [ ] Implement USTR tariff scraper
- [ ] Implement BIS cross-border flow parser
- [ ] Implement BRICS settlement estimator
- [ ] Backfill historical data (2020-present)

### Phase 3: Causal Modeling (Days 8-14)
- [ ] CRIO validates edge hypotheses with historical data
- [ ] Bootstrap significance testing on LEADS relationships
- [ ] VEGA attestation of causal graph integrity

### Phase 4: Regime Integration (Days 15-21)
- [ ] IoS-003 regime engine update for BIFURCATED_LIQUIDITY
- [ ] IoS-008 TTL adjustment rules
- [ ] Shadow mode testing (7 days)

### Phase 5: Activation (Day 22)
- [ ] CEO review and G4 approval
- [ ] Production activation
- [ ] First weekly geopolitical briefing

---

## 7. RISK ASSESSMENT

### 7.1 Data Quality Risks

| Risk | Mitigation |
|------|------------|
| BRICS data opacity | Use multiple proxies (BIS, SWIFT alternatives, trade flow analysis) |
| Tariff schedule complexity | Focus on effective rate, not line-item |
| Political event unpredictability | We model friction, not predict events |

### 7.2 Model Risks

| Risk | Mitigation |
|------|------------|
| Spurious correlation | CRIO Lane C validation required |
| Regime flip-flopping | Hysteresis rules with 5-day confirmation |
| Overconfidence in geopolitical signals | Confidence ceiling at 0.60 for friction-derived forecasts |

### 7.3 Operational Risks

| Risk | Mitigation |
|------|------------|
| CEIO scope creep | Hard boundary: no political prediction |
| Information overload | Weekly digest, not real-time alerts (except thresholds) |
| API cost escalation | BIS and IMF are free; SWIFT requires budget review |

---

## 8. SUCCESS CRITERIA

### 8.1 Quantitative

- MACRO_GEOPOLITICAL_FRICTION node populated with 5+ years historical data
- At least 3 LEADS edges validated with p < 0.05
- Regime detection latency < 5 days from structural shift
- Zero CEIO scope violations (no political prediction)

### 8.2 Qualitative

- CEO receives actionable weekly geopolitical briefing
- FINN can reference friction factors in forecast rationale
- System detects "Financial Fission" events before mainstream narrative

---

## 9. GOVERNANCE GATE REQUIREMENTS

### G1 (Technical Validation)
- [ ] STIG validates Migration 311 schema
- [ ] Data source connectivity verified
- [ ] Historical backfill complete

### G2 (Research Validation)
- [ ] CRIO validates causal hypotheses
- [ ] FINN confirms integration with forecast engine
- [ ] CDMO confirms canonical data storage

### G3 (Audit Verification)
- [ ] VEGA attests causal graph integrity
- [ ] Ed25519 signatures on all new contracts
- [ ] Evidence bundle complete

### G4 (CEO Activation)
- [ ] CEO reviews evidence bundle
- [ ] Shadow mode results satisfactory
- [ ] Final approval signed

---

## 10. ATTESTATION

**Submitted By:** STIG
**Contract:** EC-003_2026_PRODUCTION
**Timestamp:** 2026-01-19T10:00:00Z

**Constitutional Compliance:**
- ADR-014: CEIO mandate expansion within "External Intelligence" scope
- ADR-013: All data flows through canonical fhq_macro schema
- ADR-004: Full G0-G4 gate process followed
- IoS-006: Feature cluster extension, not replacement

**Strategic Alignment:**
This expansion enables FjordHQ to detect structural shifts in global liquidity architecture before they manifest as price movements. By treating geopolitical friction as a macro factor rather than news noise, we maintain epistemic discipline while gaining first-mover advantage.

---

## APPENDIX A: Geopolitical Friction Index Formula

```
GFI = w1 * TARIFF_NORMALIZED +
      w2 * BRICS_SETTLEMENT_DELTA +
      w3 * SANCTIONS_INTENSITY_NORMALIZED +
      w4 * USD_RESERVE_SHARE_DELTA

Where:
- w1 = 0.30 (tariff impact weight)
- w2 = 0.35 (settlement shift weight - highest)
- w3 = 0.20 (sanctions weight)
- w4 = 0.15 (reserve composition weight)

Normalization: Each component scaled 0-1 based on historical percentiles
Update frequency: Weekly
```

## APPENDIX B: BIFURCATED_LIQUIDITY Regime Characteristics

```yaml
regime_characteristics:
  volatility_expectation: ELEVATED
  correlation_stability: LOW
  usd_correlation_reliability: DEGRADED
  crypto_neutral_reserve_thesis: STRENGTHENED
  forecast_confidence_ceiling: 0.60
  ttl_multiplier: 0.5  # Half normal TTL

portfolio_implications:
  - Reduce USD-denominated position confidence
  - Increase crypto allocation ceiling (subject to Brier validation)
  - Diversify macro factor exposure
  - Monitor mBridge volume as leading indicator
```

---

**END OF G0 PROPOSAL**

*Awaiting CEO review for G1 gate opening.*
# IoS-001_2026_PRODUCTION
## Canonical Asset & Context Registry

**Intelligence Operating System Module (IoS Series)**
**MBB C-Suite Charter â€“ Application Layer Foundation**

---

| Field | Value |
|-------|-------|
| Canonical Version | 2026.PROD.3 |
| Status | ACTIVE (G4_CONSTITUTIONAL) |
| Phase | APPLICATION LAYER â€“ FOUNDATIONAL |
| Entity | IoS-001 |
| Owner Role | CDMO (Chief Data & Model Officer) |
| Strategic Authority | LARS (CSO) |
| Governance Authority | VEGA |
| Dependencies | ADR-001, ADR-006, ADR-012, ADR-013, ADR-016 |
| Successor Modules | IoS-002, IoS-003, IoS-004, IoS-005 |
| Effective Date | 2025-12-11 (VEGA Attested) |
| Location | fhq_meta.ios_registry + /02_IOS/IoS-001_2026_PRODUCTION.md |
| Correction | 2025-12-11: Added Â§3.4 Canonical Indicator Registry, Â§4.5 Indicator Governance, updated Â§2.1 Scalability, Â§4.1 Onboarding Criteria |

---

## 1. Purpose

This contract establishes **IoS-001 â€“ Canonical Asset & Context Registry**, the sovereign foundation of the FjordHQ Intelligence Operating System.

IoS-001 defines the **Canonical Universe** of financial instruments, exchanges, regions, calendars, liquidity classes, and modelling contexts.

It ensures that every data point, indicator, forecast, regime, or trade is tagged with the correct:

- Asset Identity
- Exchange Identity
- Geographic Context
- Sector & Model Taxonomy
- Training Context
- Execution Constraints

**Without IoS-001, no other IoS module can function.**

This module replaces ad-hoc symbols with formal ontology.
It is the **Constitution of the Application Layer**.

---

## 2. Mandate

IoS-001 must:

### 2.1 Establish Canonical Asset Identity (Scalability Requirements)

Define one and only one authoritative representation for each tradable instrument:

- Canonical ID
- Ticker
- MIC (Market Identifier Code)
- Region
- Currency
- Asset Class
- Lot Size
- Tick Size
- Trading Hours
- Market Calendar

**Scalability Target: 500+ Assets**

The Canonical Universe must support a minimum of 500 active assets distributed across:

| Asset Class | Target Count | Exchange(s) |
|-------------|--------------|-------------|
| Crypto | 50+ | XCRY |
| FX | 20+ | XFOR |
| US Equities | 120+ | XNYS, XNAS, ARCX |
| Oslo BÃ¸rs | 50+ | XOSL |
| EU Equities | 100+ | XETR, XPAR, XLON |

**Incremental Onboarding:** New assets may be added in batches via governance-approved migrations, subject to Â§4.1 onboarding criteria.

This eliminates ambiguity and ensures deterministic asset referencing across:

- FINN (Research)
- LARS (Strategy)
- CSEO (Blueprints)
- LINE (Execution)
- CFAO (Validation)
- VEGA (Governance)

### 2.2 Establish Contextual Modelling Framework

Formalize the mapping between assets and their modelling contexts:

- Regime Models
- Volatility Models
- Perception Models
- Signal Pipelines
- Sector Classification
- Feature Definitions
- Context Windows

This enables FINN and LARS to interpret data correctly, regardless of vendor feed or timestamp distortions.

### 2.3 Enforce Single Source of Truth (ADR-013)

IoS-001 is the exclusive registry where:

- assets are defined
- modeling contexts are assigned
- exchange metadata is stored
- training contexts are linked
- sector taxonomies are encoded

All downstream systems must query IoS-001 rather than ingesting raw metadata from external providers.

### 2.4 Governance Integration

IoS-001 is subject to governance by:

- CDMO (Owner & Curator)
- LARS (Strategic Universe Definition)
- STIG (Schema Enforcement & Runtime Guarantees)
- VEGA (TRiSM & Constitutional Guardrails)

No asset or context becomes active without:

1. Airlock Validation (CDMO)
2. Schema Conformance (STIG)
3. Context Verification (FINN/LARS)
4. Canonical Attestation (VEGA)

---

## 3. Architecture & Data Model

IoS-001 spans four canonical tables.

### 3.1 fhq_meta.exchanges

Holds exchange-level metadata.

**Fields:**

| Field | Type | Description |
|-------|------|-------------|
| mic | TEXT (PK) | Market Identifier Code |
| operating_mic | TEXT | Operating MIC |
| exchange_name | TEXT | Full exchange name |
| country_code | TEXT | ISO country code |
| timezone | TEXT | IANA timezone |
| region | TEXT | Geographic region |
| open_time | TIME | Market open time |
| close_time | TIME | Market close time |
| calendar_id | TEXT | Trading calendar reference |
| yahoo_suffix | TEXT | Yahoo Finance ticker suffix |
| trading_hours | JSONB | Detailed trading hours (pre, regular, post, auction) |
| settlement_convention | TEXT | Settlement convention (T+0, T+2, etc.) |
| is_active | BOOLEAN | Exchange active status |
| vega_signature_id | UUID | VEGA attestation reference |

**Registered Exchanges:**

| MIC | Exchange | Country | Region |
|-----|----------|---------|--------|
| XCRY | Cryptocurrency (24/7) | - | GLOBAL |
| XFOR | Foreign Exchange (24/5) | - | GLOBAL |
| XNYS | New York Stock Exchange | US | NORTH_AMERICA |
| XNAS | NASDAQ Stock Market | US | NORTH_AMERICA |
| ARCX | NYSE Arca | US | NORTH_AMERICA |
| XOSL | Oslo BÃ¸rs (Euronext Oslo) | NO | EUROPE |
| XETR | Deutsche BÃ¶rse XETRA | DE | EUROPE |
| XPAR | Euronext Paris | FR | EUROPE |
| XLON | London Stock Exchange | GB | EUROPE |

**Purpose:** Ensure deterministic mapping of trading hours, liquidity regime, and session boundaries.

### 3.2 fhq_meta.assets

Defines every asset in the Canonical Universe.

**Fields:**

| Field | Type | Description |
|-------|------|-------------|
| canonical_id | TEXT (PK) | Unique canonical identifier |
| ticker | TEXT | Trading symbol |
| exchange_mic | TEXT (FK) | Exchange MIC reference |
| asset_class | TEXT | Asset classification |
| currency | TEXT | Quote currency |
| lot_size | NUMERIC | Minimum trade size |
| tick_size | NUMERIC | Minimum price increment |
| sector | TEXT | Sector classification |
| risk_profile | TEXT | Risk categorization (LOW, MEDIUM, HIGH, VERY_HIGH) |
| active_flag | BOOLEAN | Active status |
| min_daily_volume_usd | NUMERIC | Â§4.1 Liquidity threshold |
| required_history_days | INTEGER | Minimum history days required |
| gap_policy | TEXT | Data gap handling (INTERPOLATE, FORWARD_FILL, SKIP_IF_GAP, FX_ADJUST) |
| liquidity_tier | TEXT | Liquidity classification (TIER_1, TIER_2, TIER_3) |
| onboarding_date | DATE | Date asset was onboarded |
| data_quality_status | ENUM | Quality status (see Â§4.1) |
| valid_row_count | INTEGER | Number of valid data rows |
| quarantine_threshold | INTEGER | Rows needed to exit quarantine |
| full_history_threshold | INTEGER | Rows for full history status |
| price_source_field | TEXT | Price field for signals (adj_close or close) |
| vega_signature_id | UUID | VEGA attestation reference |

**Dual Price Ontology (GIPS Alignment):**

| Price Field | Purpose | Used By |
|-------------|---------|---------|
| adj_close | Signal Truth (Total Return) | IoS-002, IoS-003, IoS-005 |
| close | Execution Truth | IoS-004, P&L |

For equities, `adj_close` captures corporate actions (splits, dividends). For crypto/FX, `adj_close = close`.

**Purpose:** One asset, one identity, one truth.

### 3.3 fhq_meta.model_context_registry

Maps functional modeling contexts to assets.

**Fields:**

| Field | Type | Description |
|-------|------|-------------|
| context_id | UUID (PK) | Unique context identifier |
| canonical_id | TEXT (FK) | Asset reference |
| regime_model | TEXT | Regime model reference (e.g., HMM_REGIME_V1) |
| forecast_model | TEXT | Forecast model reference (e.g., ARIMA_GARCH_V1) |
| perception_model | TEXT | Perception model reference |
| feature_set | JSONB | Indicator families and lookback configuration |
| embedding_profile | JSONB | Embedding configuration |
| model_priority | INTEGER | Processing priority (1 = highest) |
| is_active | BOOLEAN | Context active status |
| vega_signature_id | UUID | VEGA attestation reference |

**Purpose:** Every model knows its domain. No model can run out-of-context.

### 3.4 fhq_meta.canonical_indicator_registry

Defines all canonical technical indicators used by IoS-002.

**Fields:**

| Field | Type | Description |
|-------|------|-------------|
| indicator_id | UUID (PK) | Unique indicator identifier |
| indicator_name | TEXT (UNIQUE) | Indicator name (e.g., RSI_14, MACD_12_26_9) |
| category | TEXT | Category (MOMENTUM, TREND, VOLATILITY, ICHIMOKU, VOLUME) |
| calculation_method | TEXT | Formula description |
| source_standard | TEXT | Academic/industry reference (e.g., "Wilder 1978") |
| ios_module | TEXT | Owning IoS module (always 'IoS-002') |
| default_parameters | JSONB | Default calculation parameters |
| formula_hash | TEXT | SHA-256 hash of formula for integrity |
| indicator_version | TEXT | Version number |
| price_input_field | TEXT | Price field to use (adj_close per Dual Price Ontology) |
| is_active | BOOLEAN | Indicator active status |
| vega_signature_id | UUID | VEGA attestation reference |

**Registered Indicator Categories:**

| Category | Count | Examples |
|----------|-------|----------|
| MOMENTUM | 6 | RSI_14, STOCH_RSI_14, CCI_20, MFI_14, WILLIAMS_R_14, ROC_20 |
| TREND | 8 | MACD_12_26_9, EMA_9, EMA_20, EMA_50, SMA_50, SMA_200, ADX_14, PSAR |
| VOLATILITY | 5 | BB_20_2, ATR_14, KELTNER_20_2, DONCHIAN_20, STDDEV_20 |
| ICHIMOKU | 3 | ICHIMOKU, ICHIMOKU_TENKAN_9, ICHIMOKU_KIJUN_26 |
| VOLUME | 5 | OBV, VWAP, VOLUME_SMA_20, AD_LINE, CMF_20 |

**Purpose:** Standardize indicator definitions across all IoS modules. Ensure reproducibility via formula_hash and academic source citations.

---

## 4. Responsibilities of the Owner (CDMO)

CDMO must:

### 4.1 Curate the Canonical Universe (Onboarding Criteria)

Approve, reject, or modify assets based on:

- liquidity threshold
- governance status
- sector taxonomy
- risk class
- modeling requirements

**Data Quality Status ENUM:**

| Status | Description | IoS-003 Access |
|--------|-------------|----------------|
| QUARANTINED | < threshold rows, awaiting Iron Curtain validation | BLOCKED |
| SHORT_HISTORY | Between threshold and full history | FLAGGED |
| FULL_HISTORY | > full history threshold (5 years) | FULL ACCESS |
| DELISTED_RETAINED | Inactive but preserved for backtest integrity | BACKTEST ONLY |

**Iron Curtain Rule:**

No asset enters IoS-003 (Regime Engine) until minimum history is achieved:

| Asset Class | Quarantine Threshold | Full History Threshold |
|-------------|---------------------|------------------------|
| Equities | 252 rows (1 year) | 1,260 rows (5 years) |
| FX | 252 rows (1 year) | 1,260 rows (5 years) |
| Crypto | 365 rows (1 year, 24/7) | 1,825 rows (5 years) |

**Liquidity Thresholds (min_daily_volume_usd):**

| Asset Class | TIER_1 | TIER_2 | TIER_3 |
|-------------|--------|--------|--------|
| Crypto | > $100M | $10M-$100M | $1M-$10M |
| FX Major | > $100B | $10B-$100B | $1B-$10B |
| US Equities | > $100M | $10M-$100M | $1M-$10M |
| Oslo BÃ¸rs | > 100M NOK | 10M-100M NOK | 1M-10M NOK |
| EU Equities | > â‚¬100M | â‚¬10M-â‚¬100M | â‚¬1M-â‚¬10M |

**Gap Policy:**

| Policy | Description | Asset Classes |
|--------|-------------|---------------|
| INTERPOLATE | Linear interpolation for missing values | Crypto |
| FORWARD_FILL | Carry forward last valid value | FX, Equities |
| SKIP_IF_GAP | Skip day if gap > 3 consecutive days | US Equities |
| FX_ADJUST | Forward-fill with FX adjustment | Oslo BÃ¸rs |

**Survivorship Integrity:**

Delisted assets must never be deleted. They are marked:
- `active_flag = FALSE`
- `data_quality_status = 'DELISTED_RETAINED'`

This ensures IoS-004 backtests are free from survivorship bias.

**CDMO is the gatekeeper of asset identity.**

### 4.2 Enforce Context Economy

Apply measurable rules:

- Similarity Score threshold: â‰¥ 0.75
- Tier-specific context budget:
  - T1 (LARS): 128k tokens
  - T2 (FINN): 32k tokens
  - T3 (LINE): 4k tokens
- Priority Weights:
  - Regime Alignment: 40%
  - Causal Centrality: 30%
  - Alpha Impact: 30%

**Context is capital. CDMO allocates it.**

### 4.3 Operate the Airlock Protocol

No data enters canonical tables unless:

- Schema_Valid = TRUE
- Null_Check < 1%
- Time_Continuity = TRUE
- Anomaly_Detection < 3Ïƒ
- Cost_Check = TRUE
- Source_Signature = VALID

**Contaminated data dies in quarantine.**

### 4.4 Maintain the Model Vault Lineage

Every model must have:

- Training_Data_Hash
- Code_Hash
- Config_Hash
- Performance_Metrics
- TRiSM_Attestation_ID

**Invalid lineage â†’ automatic REVOKE.**

### 4.5 Indicator Governance Protocol

Technical indicators in `fhq_meta.canonical_indicator_registry` are subject to:

**Registration Workflow:**
1. FINN/LARS propose indicator specification
2. STIG validates formula and parameters
3. CDMO approves for canonical registry
4. VEGA attests with Ed25519 signature

**Requirements for Indicator Registration:**
- `source_standard`: Academic or industry reference (BIS/ISO 8000 compliance)
- `formula_hash`: SHA-256 hash of calculation method
- `price_input_field`: Must align with Dual Price Ontology (adj_close for signals)
- `category`: Must be one of MOMENTUM, TREND, VOLATILITY, ICHIMOKU, VOLUME

**Indicator Modification:**
- Any change to calculation_method requires new formula_hash
- Version increment required for parameter changes
- VEGA re-attestation required for any modification

**Purpose:** Ensure indicator reproducibility and audit trail for GIPS compliance.

---

## 5. Constraints

IoS-001 **cannot**:

- Execute trades
- Generate signals
- Make forecasts
- Define strategies
- Alter ADRs
- Modify agent behavior
- Override VEGA
- Write to non-canonical schemas

**IoS-001 is definition, not inference.**

---

## 6. Activation Conditions

IoS-001 becomes ACTIVE when:

1. CDMO provides the formal specification
2. STIG enforces schema migrations
3. FINN validates context mappings
4. LARS approves the Canonical Universe
5. VEGA attests and signs content_hash
6. Hash-chain is committed

Only then do downstream IoS modules unlock:

- IoS-002 Feature Vectors
- IoS-003 Regime Engine
- IoS-004 Backtest Engine
- IoS-005 Skill Metrics

---

## 7. Cryptographic Identity

All IoS-001 artifacts must include:

- SHA-256 content_hash
- VEGA attestation (Ed25519)
- hash_chain_id
- governance_action_id
- lineage metadata snapshot

**Unsigned = invalid.**
**Unattested = blocked.**

---

## 8. Signatures

| Role | Agent | Status |
|------|-------|--------|
| Owner | CDMO | Ed25519 â€” Registered |
| Strategic Authority | LARS (CSO) | Ed25519 â€” Registered |
| Governance Authority | VEGA | Ed25519 â€” Attested (2025-12-11) |
| CEO | Final Constitutional Approval | APPROVED |

---

## 9. Change Log

| Version | Date | Changes |
|---------|------|---------|
| 2026.PROD.1 | 2025-11-28 | Initial release |
| 2026.PROD.2 | 2025-11-28 | Removed invalid ADR references, purged unapproved seed data |
| 2026.PROD.3 | 2025-12-11 | Added Â§3.4 Canonical Indicator Registry, Â§4.5 Indicator Governance, updated Â§2.1 with 500+ asset scalability, updated Â§4.1 with Iron Curtain and Dual Price Ontology |

---

*Document Version: 2026.PROD.3*
*Created: 2025-11-28*
*Updated: 2025-12-11 (IOS-001_UPDATE_20251211)*
*Location: /02_IOS/IoS-001_2026_PRODUCTION.md*
IoS-002 â€“ Indicator Engine (Sensory Cortex)Canonical Version: 2026.PROD.1Status: DRAFT FOR G1 (Technical Validation)Owner: FINN (Research & Insight Domain)Authority Chain: ADR-001 â†’ ADR-003 â†’ ADR-007 â†’ IoS-001 â†’ IoS-002Governing Agent: VEGA (Compliance & Oversight)Environment: fhq_market (Source), fhq_research (Target)1. Executive SummaryIoS-002 establishes the Sensory Cortex of the FjordHQ Intelligence Operating System.In the transition from Data to Alpha, raw OHLCV (Open, High, Low, Close, Volume) data is insufficient for high-fidelity reasoning. It requires a deterministic transformation layer to convert "market noise" into "auditable features."The Indicator Engine is the sole authorized system component responsible for calculating, validating, and storing technical market drivers. It serves as the bridge between:Raw Reality (IoS-001 Canonical Assets)Strategic Reasoning (IoS-003 Meta-Perception)Without this module, the reasoning agents (FINN/LARS) are effectively blind, forced to hallucinate patterns from raw noise. With this module, they perceive mathematically defined reality.2. Strategic Scope & Feature UniverseThis module does not interpret the market; it measures it. It produces the "Feature Vectors" required for downstream AI reasoning, aligned with Gartner's definition of reliable data foundations for reasoning models2222.The engine computes four classes of deterministic features:2.1 Momentum & Oscillators (The "Pulse")RSI (14) â€“ Relative Strength IndexStochRSI â€“ Stochastic RSICCI â€“ Commodity Channel IndexMFI â€“ Money Flow IndexPurpose: Quantify overextension and reversal probability.2.2 Trend & Direction (The "Current")MACD â€“ Moving Average Convergence DivergenceMoving Averages: EMA (9, 20, 50, 200), SMA (50, 200)Ichimoku Cloud: Full 5-line suite (Tenkan, Kijun, Senkou A/B, Chikou)PSAR â€“ Parabolic SARPurpose: Objectively define market regime (Bull/Bear/Neutral).2.3 Volatility & Risk (The "Weather")Bollinger Bands (20, 2 std dev)ATR (14) â€“ Average True RangePurpose: Define dynamic risk parameters for Position Sizing (IoS-012).2.4 Volume & Force (The "Fuel")OBV â€“ On-Balance VolumeROC â€“ Rate of ChangePurpose: Validate price action through participation.3. Architectural Rationale (Why Position #002?)The FjordHQ Value Chain dictates that feature extraction must precede reasoning.Data Integrity (ADR-001/013): FINN owns the research domain. Features must be calculated once and stored canonically to prevent "calculation drift" between agents.Orchestration Logic (ADR-007): The pipeline FETCH -> CALC -> THINK -> ACT breaks if the CALC stage is missing. Reasoning agents (LARS) cannot be allowed to calculate their own indicators on the fly (violation of Separation of Concerns).Compliance (ADR-003): BCBS-239 and ISO-8000 require full lineage. We must prove exactly how a signal was derived. Hard-coding this in IoS-002 ensures auditability.GenAI Readiness: This module prepares structured data for future Vector Database ingestion, enabling GraphRAG capabilities later3333.4. Functional Requirements4.1 Deterministic CalculationInput: Canonical OHLCV from fhq_market.Processing: Standardized mathematical formulas (TA-Lib or verifiable Python equivalent).Output: float64 precision stored in fhq_research.Constraint: Same Input + Same Code = Identical Output (Zero Tolerance for deviation).4.2 Immutable Lineage (BCBS-239)Every calculated row must include:calculation_timestampengine_version (e.g., v1.0.1)formula_hash (SHA-256 of the logic used)4.3 Anti-Hallucination Tolerances (ADR-010)Float Tolerance: $\le 0.1\%$ deviation against reference benchmark.Completeness: No NULL values allowed in active trading windows.Verification: VEGA must be able to independently verify a random sample of calculations.5. Deliverables (Data Assets)Upon activation, IoS-002 delivers the following Canonical Tables in the fhq_research schema:Table NameGranularityContentindicator_momentumTime-seriesRSI, Stoch, CCI, MFIindicator_trendTime-seriesMACD, EMA_, SMA_, PSARindicator_volatilityTime-seriesBB_*, ATRindicator_ichimokuTime-seriesTenkan, Kijun, Cloud_A, Cloud_B, ChikouEvidence Bundle:A "Golden Sample" dataset proving calculation accuracy against a known external benchmark (e.g., TradingView or Binance standard values).6. Governance AlignmentADR-001 (Roles): FINN acts as the "Chief Research Officer," owning the definition of indicators. STIG owns the implementation (SQL/Python).ADR-010 (Reconciliation): Indicators are classified as Medium Criticality (Operational/Analytical). Errors here trigger a "Warning" but not immediate system suspension unless they cascade to P&L.Gartner Alignment: By structuring data before feeding it to LLMs, we mitigate the risk of hallucination inherent in GenAI, leveraging structured inputs for better reasoning4444.7. Change Gates (ADR-004)G0 (Submission): FINN defines the indicator list.G1 (Technical): STIG verifies code efficiency and schema.G2 (Governance): VEGA checks against ADR-003 (Standards).G3 (Audit): VEGA runs the "Golden Sample" test.G4 (Activation): CEO approves deployment to Production.8. Acceptance CriteriaIoS-002 is considered ACTIVE when:[ ] All specified indicators are calculating automatically on new OHLCV ingest.[ ] Data is stored in fhq_research with full lineage metadata.[ ] A "Golden Sample" test confirms <0.001% deviation from standard libraries.[ ] VEGA has successfully attested the first batch of data.[ ] The Orchestrator pipeline CALC_INDICATORS stage is live.
Red Team Evaluation: FHQ HMM v2.0 Algorithmic Specifications & Empirical Roadmap for HMM v3.01. Executive Summary and Evaluation Mandate1.1. The MandateThe Quantitative Risk Committee (QRC) has commissioned this "Red Team" evaluation to subject the proposed FHQ HMM v2.0 algorithmic trading specification to a rigorous, adversarial audit. The mandate is explicit: to stress-test the theoretical and empirical validity of the model's four foundational pillars against the rigorous standards of contemporary quantitative finance literature and econometric stability.The v2.0 specification is built upon a Hidden Markov Model (HMM) framework characterized by:Hyper-Granular State Space: A 9-state hidden variable structure intended to capture nuanced market phases.Endogenous Feature Set: A pure technical input vector comprising 7 canonical indicators.Static Temporal Window: A fixed 252-day (one trading year) lookback period for parameter calibration.Commingled Asset Universe: A unified modeling approach applied indiscriminately across traditional Foreign Exchange (Forex) pairs and Cryptocurrency assets.The objective of this report is not merely to critique but to empirically valid or refute these design choices and, where deficiencies are identified, to construct a scientifically robust specification for HMM v3.0.1.2. Summary of FindingsThe Red Teamâ€™s exhaustive analysis, grounded in over 80 distinct academic and industry research sources, indicates that the FHQ HMM v2.0 specification carries critical model risks that likely render it unfit for deployment in live trading environments. The architecture appears to suffer from the "curse of dimensionality" and "overfitting to noise," significantly increasing the probability of Type I (false positive) and Type II (false negative) errors in regime detection.Key Findings:Rejection of the 9-State Model: The empirical evidence overwhelmingly supports low-cardinality models (2-4 states). A 9-state architecture induces severe overfitting, statistical instability, and a lack of economic interpretability. The statistical penalties (AIC/BIC) for such complexity are prohibitive, and the resultant "state flickering" renders the signal unusable for tactical allocation.1Insufficiency of Technical Inputs: Relying solely on endogenous technical data ignores the causal drivers of regime shiftsâ€”specifically macroeconomic shocks and liquidity cycles. The v2.0 model is reactive rather than predictive. Empirical support strongly favors Input-Output HMMs (IOHMM) that condition transition probabilities on exogenous variables like the VIX and yield spreads.4Failure of Static Windows: The 252-day lookback is a relic of stationary econometrics. In a non-stationary financial environment, it creates dangerous lags during structural breaks and artificial volatility (the "ghost effect") when data exits the window. Online Expectation-Maximization (EM) and Bayesian Online Changepoint Detection (BOCD) are demonstrated to be superior, adapting instantaneously to new regimes.7Asset Class Incompatibility: Commingling Crypto and Forex under a single regime definition ignores the heterogeneity of their volatility drivers and the state-dependent nature of their correlations. A Factorial or Hierarchical HMM approach is required to model the distinct stochastic processes of these asset classes.10Consequently, this report outlines the comprehensive theoretical and practical framework for HMM v3.0, advocating for a parsimonious 3-4 state architecture, an IOHMM structure capable of ingesting exogenous macro-variables, a recursive Online EM learning algorithm, and a segmented modeling approach for multi-asset portfolios.2. The Dimensionality Crisis: Empirically Refuting the 9-State ArchitectureThe most ambitious, yet most scientifically fragile, pillar of the v2.0 specification is the proposal of a 9-state hidden variable structure. The intuitionâ€”that markets have fine-grained gradations such as "weak bull," "strong bull," "correction," "crash," "rebound," etc.â€”is intuitively appealing but statistically flawed when applied to noisy financial time series.2.1. The Statistical Penalty of Complexity (AIC/BIC Analysis)In quantitative modeling, the principle of parsimony (Occam's Razor) is encoded in model selection criteria such as the Akaike Information Criterion (AIC) and the Bayesian Information Criterion (BIC). These metrics penalize models for the number of estimated parameters to prevent overfitting.$$BIC = -2 \ln(\hat{L}) + k \ln(n)$$Where $\hat{L}$ is the maximized likelihood, $k$ is the number of parameters, and $n$ is the sample size.In a fully connected HMM, the number of parameters $k$ grows quadratically with the number of states ($N$) due to the transition matrix ($N^2 - N$) and linearly with the number of features ($M$) for means and covariances.For the proposed v2.0 9-state model with 7 features:Transition Matrix parameters: $9^2 - 9 = 72$ (assuming ergodicity).Emission parameters (assuming diagonal covariance for simplicity): $9 \times (7 \text{ means} + 7 \text{ variances}) = 126$.Total parameters $\approx 198$.Contrast this with a standard 3-state model:Transition Matrix: $3^2 - 3 = 6$.Emission parameters: $3 \times 14 = 42$.Total parameters $\approx 48$.The 9-state model requires estimating over four times the number of parameters. For the likelihood term $\ln(\hat{L})$ to justify this added complexity in the BIC equation, the 9-state model would need to explain the data variance significantly better than the 3-state model. However, financial return data is notoriously noisy (low signal-to-noise ratio). Research examining the DAX index using the fHMM package specifically compared 2-state (Normal distribution) vs. 3-state (t-distribution) models.1 The findings were conclusive: while a 3-state model using t-distributions (to capture fat tails) offered an improvement over a 2-state Normal model, expanding beyond this count yielded diminishing returns and higher BIC values, indicating overfitting.12.2. The "Crash State" Identification ProblemOne might argue that a 9-state model is necessary to capture rare "tail events" or distinct "crash" states. However, the literature on the optimal number of states highlights a critical practical limitation. Gatumel and Ielpo (2011), as referenced in community discussions on HMM state selection, demonstrate that while statistical tests might reject the hypothesis that 2 regimes are sufficient, the utility of adding states diminishes rapidly beyond 4 or 5.2When a model includes a specific "Crash" state (e.g., State 9), this state is, by definition, rare. This leads to two problems:Sparse Data for Calibration: There are too few historical data points to robustly estimate the mean and covariance of this specific state. The variance of the parameter estimates becomes enormous.Detection Lag: Because the transition probability into a "Crash" state is typically low (markets are usually stable), the Viterbi algorithm or the Forward-Backward algorithm requires a very strong sequence of negative observations to "switch" the decoded state to "Crash." By the time the model identifies the state with high probability, the crash has often already occurred or is rebounding.2This phenomenon renders the granular states "whipsaw factories." The model might flicker into "State 9" for a single day at the bottom of the move, triggering a sell signal exactly at the wrong time, before flickering back to "State 3" (Rebound). A parsimonious 2-state or 3-state model, which groups "Crash" and "Bear" into a broader "High Volatility" regime, tends to be more stable and actionable for trend-following or defensive strategies.122.3. Economic Interpretability and State FlickeringA 9-state model suffers from a severe lack of economic interpretability. In a 3-state model, regimes map clearly to market phases:State 1 (Bull): Positive Mean, Low Variance.State 2 (Bear): Negative Mean, High Variance.State 3 (Uncertainty): Flat Mean, High Variance (or "Sideways").When 9 states are introduced, the distinctions become blurred. What is the economic difference between "State 4" and "State 5"? Often, the Gaussians describing these states overlap significantly. This leads to state flickering, where the most likely state path ($q_t$) jumps rapidly between adjacent states (e.g., 4 $\rightarrow$ 5 $\rightarrow$ 4) due to minor noise in the input data. This instability makes it impossible to build a coherent trading strategy, as transaction costs from rebalancing would destroy any theoretical alpha.3Research utilizing HMMs for the S&P 500 and Russell 3000 explicitly avoids this by restricting the model to 3 states (Bull, Bear, Neutral) and using these robust labels to drive ensemble methods (voting classifiers) rather than relying on the raw HMM output for granular timing.3 The stability of the regime signal is paramount; a 9-state model is inherently unstable.2.4. Recommendation for HMM v3.0: Parsimony with Heavy TailsInstead of increasing the number of states to capture complexity, HMM v3.0 should increase the complexity of the emission distributions within a parsimonious state space.Architecture: 3 to 4 Latent States.Distributions: Replace Normal (Gaussian) emissions with Multivariate Student-t distributions or Gaussian Mixture Models (GMM) per state.Justification: Financial returns exhibit leptokurtosis (fat tails). A 2-state Gaussian HMM tries to fit outliers by creating a third "high variance" state. A 2-state Student-t HMM can capture the stable regime and the volatile regime (including outliers) naturally within the distribution's degrees of freedom parameter ($\nu$), avoiding the need for extra states.13. The Endogeneity Trap: Validating the Feature SetThe v2.0 specification relies on a "Pure Technical Input Set" comprising 7 canonical features (likely momentum, RSI, volatility, etc.). This represents an endogenous approach, assuming that the future state of the market is entirely encoded in its past price and volume history. The Red Team evaluation identifies this as a critical failure point for predicting structural regime shifts.3.1. The Theoretical Deficit of Pure TechnicalsHidden Markov Models trained solely on returns or technical indicators act essentially as sophisticated filters for volatility clustering (GARCH-like behavior). They are reactive. They can tell you that volatility has increased, but they struggle to predict why or when a shift is imminent if the price action hasn't yet broken down.However, market regimes are often driven by exogenous shocksâ€”changes in the cost of capital (interest rates), inflation expectations, or geopolitical risk. These factors often move before the asset price crashes. For example, a yield curve inversion or a spike in the VIX often precedes a Bear market regime.13 A model blind to these variables is fighting with one hand tied behind its back.3.2. Evidence for Macro-Financial Factors (IOHMM)The literature on Input-Output HMMs (IOHMM) or Non-Homogeneous HMMs provides a compelling alternative. In an IOHMM, the transition probabilities $A_{ij}$ are not constant parameters but are functions of a covariate vector $u_t$ (external data).$$P(S_t = j | S_{t-1} = i, u_t) = \text{softmax}(W_j u_t + b_j)$$Research demonstrates that including "push factors" such as the VIX (volatility index) and Treasury yield spreads significantly improves the model's ability to anticipate regime shifts.4Key Macro-Variables Identified in Research:VIX (Volatility Index): Acts as a proxy for global risk appetite. High VIX levels increase the probability of transitioning to a "Crisis" state.14Yield Curve Spreads (e.g., 10Y-2Y): A robust predictor of recessionary regimes. Inverted curves skew transition probabilities toward "Bear" states.13Inflation Expectations: Inflation data impacts the correlation structure between assets (stock-bond correlation), fundamentally altering the regime definition.15Liquidity Measures (TED Spread): Indicators of interbank funding stress are critical for detecting "Liquidity Crisis" regimes, which differ from standard "Economic Recession" regimes.16The IMF's working paper on Regime-Switching Dynamic Factor Models emphasizes that "Nowcasting" with large-dimensional datasets (including macro indicators) provides superior performance in identifying recession start and end dates compared to pure time-series models.6 The macro data provides the "context" that technical data lacks.3.3. The "Forest of Opinions" ArchitectureTo mitigate the risk of relying on any single feature set, HMM v3.0 should adopt a hybrid approach. The "Forest of Opinions" framework 3 utilizes the HMM not as the final trading signal, but as a "meta-labeler."Step 1: The HMM (using macro + technicals) segments history into Regimes (Bull, Bear, Neutral).Step 2: Specialist supervised learning models (e.g., Random Forests or XGBoost) are trained separately for each regime.17Model A (Bull Specialist): Trained only on data where $S_t = \text{Bull}$. Might prioritize momentum features.Model B (Bear Specialist): Trained only on data where $S_t = \text{Bear}$. Might prioritize mean-reversion or short-selling signals.This approach acknowledges that the relationship between features and returns changes depending on the regime.17 v2.0's monolithic approach fails to capture this non-linearity.3.4. Recommendation for HMM v3.0: The Hybrid Input VectorThe v3.0 specification must mandate a Hybrid Input Vector utilizing the IOHMM framework.Emission Inputs ($y_t$): Technicals (Log-Returns, Realized Volatility) â€“ determining the current distribution.Transition Covariates ($u_t$): Macro-Financials (VIX, Yield Curve, Inflation) â€“ determining the probability of change.Justification: This allows the model to remain sensitive to price action (technicals) while being "primed" for a regime change by the macro environment.44. The Stationary Fallacy: Rejecting the 252-Day Static WindowThe v2.0 specification employs a static sliding window of 252 days (one trading year) for model training. This assumes that financial data is stationary within that window and that data older than one year is irrelevant. The Red Team identifies this as a critical structural weakness, particularly in the face of rapid structural breaks (e.g., COVID-19, Flash Crashes).4.1. The Lag and the "Ghost Effect"A fixed window creates two opposing risks that degrade performance:Lag (The Inertia Problem): If a structural break occurs today (e.g., a sudden shift from Low Vol to High Vol), a 252-day window is still dominated by ~250 days of "old regime" data. The model's parameters (mean and covariance) will move sluggishly, underestimating risk for weeks until enough new data accumulates.The Ghost Effect: Exactly 253 days after a major shock (e.g., a massive volatility spike), that data point drops out of the moving window. The model's estimated volatility will suddenly collapse, not because the market has changed today, but because a data point from a year ago expired. This artificial "shock" can trigger erroneous trade signals.94.2. Superiority of Online Learning (Online EM & BOCD)Modern computational statistics offers Online Learning algorithms that are superior to batch sliding windows for non-stationary data.4.2.1. Bayesian Online Changepoint Detection (BOCD)BOCD, as detailed by Adams and MacKay (2007) and implemented in various financial contexts 7, fundamentally changes the approach to "lookback."Mechanism: Instead of a fixed window, BOCD maintains a run length ($r_t$) probability distribution. $r_t$ represents the number of time steps since the last regime change.Process: For each new data point $x_t$, the algorithm calculates the probability that the current regime is continuing ($r_t = r_{t-1} + 1$) versus the probability that a changepoint has occurred ($r_t = 0$).Implication: If a major shock occurs, the "changepoint probability" spikes, the run length drops to zero, and the model effectively "resets" its priors. It immediately starts learning the new regime parameters from scratch, without being weighed down by irrelevant historical data. This offers zero-lag adaptation to structural breaks.184.2.2. Online Expectation-Maximization (Online EM)For updating the HMM parameters themselves, Online EM 8 allows for recursive updates of the sufficient statistics.Batch EM: Requires passing over the entire 252-day dataset multiple times until convergence. Slow and computationally expensive.Online EM: Updates the parameters $\phi_t$ based on the previous estimate $\phi_{t-1}$ and the new observation $y_t$, using a step size (learning rate) $\gamma_t$.$$\hat{S}_t = (1 - \gamma_t) \hat{S}_{t-1} + \gamma_t S(y_t)$$Benefit: This method is computationally efficient (suitable for high-frequency updates) and, crucially, can be tuned with an adaptive learning rate. During periods of high "surprisal" (model error), the learning rate can increase to adapt faster.204.3. Recommendation for HMM v3.0: Recursive AdaptationThe v3.0 specification must abandon the sliding window in favor of Recursive Online Estimation.Algorithm: Bayesian Online Changepoint Detection (BOCD) combined with Online EM.Justification: This eliminates the arbitrary 252-day cutoff. The model retains long-term memory of stable parameters (when no changepoint is detected) while possessing the agility to discard old data immediately upon detecting a structural break.95. Asset Universe Heterogeneity: The Crypto-Forex DivergenceThe v2.0 specification aims to apply the HMM architecture across a commingled universe of Forex and Cryptocurrency assets. The Red Team evaluation warns that this conflation ignores the fundamental heterogeneity of these asset classes, likely leading to model failure.5.1. Divergent Volatility Profiles and DriversBitcoin (BTC) and other cryptocurrencies exhibit volatility characteristics that are fundamentally distinct from fiat currencies. Research indicates that BTC volatility can exceed that of major Forex pairs (e.g., EUR/USD) by a factor of ten.10 A "High Volatility" regime for EUR/USD might be statistically indistinguishable from a "Low Volatility" regime for Bitcoin.Result: If a single HMM is trained on both, the quantization of states will be skewed. The model will likely map all BTC observations to the "Extreme" states and all Forex observations to the "Central" states, breaking the regime detection logic for both.Furthermore, the drivers differ.Forex: Driven by interest rate differentials, trade balances, and central bank policy.22Crypto: Driven by "crypto-specific" factors such as hashrate, on-chain transaction volume, and regulatory news, alongside speculative momentum.23 While there is some correlation with global liquidity, crypto often decouples, acting as a "risk-on" asset in some regimes and a "digital gold" hedge in others.155.2. State-Dependent CorrelationsCorrelations between Crypto and TradFi are not static; they are regime-dependent.Crisis Regimes: During liquidity crises (e.g., March 2020), correlations converge to 1 (contagion).Inflation Regimes: In high inflation regimes, specifically in Emerging Markets and Developing Economies (EMDEs), Bitcoin often acts as a currency hedge, negatively correlated with the local fiat currency.23Speculative Regimes: In developed markets, Bitcoin often correlates with tech stocks (Nasdaq) and liquidity injections.23A standard HMM assuming a static covariance structure across these assets will fail to capture these dynamic decoupling events.5.3. Recommendation for HMM v3.0: Hierarchical SegmentationHMM v3.0 must adopt a Hierarchical or Factorial HMM (FHMM) approach.11Option A (Factorial HMM): The model consists of multiple independent Markov chains.Chain 1 (Global Factor): Models the broad "Risk On/Risk Off" environment (driven by VIX, Dollar Index). Affects all assets.Chain 2 (Asset-Specific Factor): Separate chains for "Crypto Sentiment" and "Forex Macro."Observation: The final asset return is a function of both the Global state and its specific Local state.Option B (Segmentation): Separate HMMs are trained for the Crypto sleeve and the Forex sleeve. Their outputs (Regime signals) are then fed into a master Portfolio Allocation algorithm. This prevents the high variance of crypto from washing out the subtle signals in the forex market.266. Synthesis: Technical Specifications & Roadmap for HMM v3.0Based on the empirical rebuttal of v2.0 assumptions, the Red Team proposes the following technical specifications for the transition to HMM v3.0.6.1. HMM v3.0 Specification MatrixComponentFHQ HMM v2.0 (Proposed)HMM v3.0 Specification (Red Team)Empirical RationaleState Space9 States (High Granularity)3-4 States (Parsimonious)Minimizes BIC penalty; prevents "state flickering"; improves interpretability (Bull/Bear/Neutral).1EmissionsGaussian (Normal)Multivariate Student-t or GMMCaptures financial "fat tails" (kurtosis) without needing extra "crash" states.1Model TypeHomogeneous HMMInput-Output HMM (IOHMM)Allows transition probabilities to be dynamic, driven by exogenous macro factors.4Inputs7 Technicals (Endogenous)Hybrid Vector (Tech + Macro + On-Chain)Macro factors (VIX, Yields) predict regime shifts; Technicals describe current state.13TemporalStatic 252-Day WindowOnline EM / BOCDEliminates lag; adapts instantly to structural breaks; removes "ghost effects".7Asset ScopeCommingled UniverseFactorial / Hierarchical HMMRespects distinct volatility drivers and regime-dependent correlations of Crypto vs Forex.10StrategyDirect Signal Generation"Forest of Opinions" (Meta-Labeling)HMM defines the regime; Regime-Specific classifiers (Random Forest) generate the trade signal.36.2. Implementation RoadmapPhase 1: Data Infrastructure & Feature Engineering (Weeks 1-4)Action: Construct the Hybrid Input Vector.Data Sources: Integrate FRED (for Yield Curve, Inflation), CBOE (for VIX), and Glassnode (for Crypto on-chain metrics).Task: Engineer "Lead-Lag" features. Test the predictive power of macro variables on future realized volatility using Granger Causality tests.24Phase 2: Algorithm Development (Weeks 5-10)Action: Develop the IOHMM core.Library: Evaluate hmmlearn (Python) or DepmixS4 (R) for IOHMM capabilities. If unavailable, implement custom Online EM utilizing Jax or PyTorch for gradient-based optimization of transition weights.5Task: Implement BOCD (Bayesian Online Changepoint Detection) as a parallel module to trigger "hard resets" of the model parameters during shock events.27Phase 3: Backtesting & Validation (Weeks 11-16)Action: Comparative Backtesting (v2.0 vs v3.0).Metrics: Compare Sharpe Ratio, Sortino Ratio, and Max Drawdown. Crucially, measure "Regime Stability" (average duration of a regime) to quantify and minimize state flickering.Stress Test: Specifically isolate performance during the March 2020 crash and the 2022 Inflation/Rate Hike cycle to validate the model's adaptive capabilities.287. ConclusionThe "Red Team" evaluation concludes that FHQ HMM v2.0 is empirically flawed and operationally risky. The reliance on a high-cardinality 9-state architecture and a static lookback window constitutes a fragility that will likely result in overfitting to historical noise and catastrophic lag during structural shifts. Furthermore, the exclusion of macroeconomic data in a regime-switching context negates the primary advantage of HMMsâ€”the ability to detect structural shifts driven by economic fundamentals.By transitioning to HMM v3.0â€”characterized by a parsimonious state space, hybrid macro-technical inputs via an IOHMM framework, recursive online learning, and asset-class segmentationâ€”the fund can build a robust, interpretable, and truly adaptive algorithmic trading system capable of navigating the non-stationary dynamics of modern financial markets. The prompt adoption of these v3.0 specifications is strongly recommended.
# IoS-003B: Micro-Regime Taxonomy within CRISIS Macro State

**Status:** G2_OBSERVATIONAL
**Directive:** CEO-DIR-2026-OPS-MICROREGIME-003
**Author:** STIG (EC-003), commissioned by FINN (EC-006)
**Classification:** GOVERNANCE-CRITICAL / OBSERVATIONAL
**Execution Authority:** NONE
**Capital Authority:** ZERO
**Created:** 2026-02-01T18:46 CET (DAY32)

---

## 1. Motivation

The current macro regime state is CRISIS (confidence 0.9615), with belief_regime=STRESS and is_policy_divergent=true. The CRISIS label is a monolithic classification that collapses several distinct market micro-conditions into a single bucket. This creates two problems:

1. **Volatility Observer Blind Spot:** All 24 IoS-009 observations are `envelope_non_compliant` because CRISIS blocks SELL_VOL strategies unconditionally. Yet within CRISIS, there exist conditions where observation of protective strategies (BUY_VOL) would be informative.

2. **Hypothesis Stagnation:** 897 of 1024 hypotheses are FALSIFIED, many under a regime label too coarse to capture why. If CRISIS contains sub-states with meaningfully different return distributions, the falsification signal is noisy.

This document defines 4 micro-regimes within CRISIS that preserve the macro-level safety invariant while enabling finer-grained observational research.

---

## 2. Hard Constraints

| Constraint | Enforcement |
|-----------|-------------|
| NO changes to IoS-012 (Execution Engine) | Code review + assertion |
| NO changes to IoS-009 (Volatility Observer) execution path | Module boundary respected |
| NO changes to options_shadow_adapter.py | File not imported or modified |
| Micro-regimes are OBSERVATIONAL METADATA only | Written to `micro_regime` column, never to execution tables |
| Macro CRISIS label remains authoritative for all execution gates | DEFCON, kill-switch, and envelope still read macro only |
| No new execution authority granted | EXECUTION_AUTHORITY = NONE preserved |

---

## 3. Empirical Basis (Database Evidence)

### 3.1 Current Sovereign Regime Distribution (2026-01-29)

From `fhq_perception.sovereign_regime_state_v4` latest snapshot across 48 assets:

| Sovereign Regime | Count | Notable Assets |
|-----------------|-------|----------------|
| BEAR | ~30 | ADA, ALGO, AVAX, DOGE, ETH, SOL, XRP |
| STRESS | ~8 | BTC (96.2%), CHZ (98.4%), EOS (99.7%), EURCHF |
| NEUTRAL | ~6 | MKR, QNT, RPL, XTZ, FLOW, MANA |
| BULL | ~4 | AXS, AUDUSD, CHZ(prior), MATIC(stale) |

### 3.2 Stress Probability Distribution within BEAR Assets

Not all BEAR assets are equal. The `stress_prob` varies dramatically:

| Cluster | stress_prob Range | Assets | Interpretation |
|---------|------------------|--------|----------------|
| BEAR-pure | < 0.20 | CRO (0.002), ALGO (0.010), CRV (0.19) | Declining orderly, low contagion risk |
| BEAR-stressed | 0.20 - 0.60 | DOGE (0.22), ADA (0.15), ETC (0.29), AVAX (0.20) | Declining with elevated stress, contagion possible |
| BEAR-acute | > 0.60 | BCH (0.64), BNB (0.54), DOT (0.85), ETH (0.83) | Near-STRESS, high contagion, potential cascade |

### 3.3 Macro Regime State

```
current_regime: CRISIS
regime_confidence: 0.9615
belief_regime: STRESS
belief_confidence: 0.8499
is_policy_divergent: true
divergence_reason: HYSTERESIS: 1/5 confirms (CEO-DIR-2026-001 identified)
transition_state: PENDING_CONFIRMATION
```

The divergence between belief (STRESS) and policy (CRISIS) itself is a signal. The hysteresis mechanism requires 5 confirmations to transition; currently at 1/5.

### 3.4 Experiment Results Under CRISIS

| Experiment | Result | Trigger Count | Win/Loss | Note |
|-----------|--------|---------------|----------|------|
| EXP-2026-T1-0003 | FALSIFIED | 0 | - | direction_accuracy: 0.35 |
| EXP-2026-T1-0005 | WEAKENED | 0 | - | direction_accuracy: 0.41 (near threshold) |
| EXP_ALPHA_SAT_A_V1.1 | FALSIFIED | 19 | 0/19 | BBW squeeze, avg return +2.82% but direction wrong |
| EXP_ALPHA_SAT_B_V1.1 | FALSIFIED | 0 | - | RSI>70 in STRONG_BULL, no triggers in BEAR regime |
| EXP_ALPHA_SAT_C_V1.1 | FALSIFIED | 0 | - | BB position in NEUTRAL, no triggers in current regime |
| EXP_ALPHA_SAT_D_V1.0 | FALSIFIED | 0 | - | BB breakout in BULL_OR_NEUTRAL, no triggers |
| EXP_ALPHA_SAT_E_V1.0 | **RUNNING** | 0 | - | RSI<35 pullback in BULL, still collecting |
| EXP_ALPHA_SAT_F_V1.0 | FALSIFIED | 16 | 15/1 | RSI<20 bounce in BEAR/STRESS, 93.8% bounce rate |

**Key Observation:** Most experiments cannot trigger under CRISIS because their regime_filter requires BULL or NEUTRAL. Only EXP_ALPHA_SAT_F (BEAR_OR_STRESS filter) and EXP_ALPHA_SAT_A (no regime filter) produced triggers. This confirms the micro-regime taxonomy is needed to differentiate actionable sub-conditions within the CRISIS envelope.

---

## 4. Micro-Regime Taxonomy

### 4.1 Definition: 4 Micro-Regimes within CRISIS

| Micro-Regime | Code | Condition | Market Character |
|-------------|------|-----------|-----------------|
| **CRISIS_ACUTE** | `MR_ACUTE` | Portfolio avg stress_prob > 0.80 AND >50% assets in STRESS | Active contagion, cascade risk, max defensive |
| **CRISIS_SYSTEMIC** | `MR_SYSTEMIC` | Portfolio avg stress_prob 0.50-0.80 AND >30% assets with stress_prob > 0.60 | Broad stress, cross-asset correlation spike |
| **CRISIS_SELECTIVE** | `MR_SELECTIVE` | Portfolio avg stress_prob 0.20-0.50 AND <30% assets in STRESS | Sector-specific stress, some assets decoupling |
| **CRISIS_EXHAUSTION** | `MR_EXHAUSTION` | Portfolio avg stress_prob < 0.20 OR belief_regime divergent from policy AND transition_state = PENDING | Vol compression, potential bottom formation |

### 4.2 Classification Logic

```
FUNCTION classify_micro_regime(
    sovereign_states: Dict[asset, regime_record],
    macro_state: regime_state_record
) -> MicroRegime:

    stress_probs = [r.stress_prob for r in sovereign_states.values()]
    avg_stress = mean(stress_probs)
    pct_stress = count(r for r in sovereign_states if r.sovereign_regime == 'STRESS') / len(sovereign_states)
    pct_high_stress = count(r for r in sovereign_states if r.stress_prob > 0.60) / len(sovereign_states)

    -- Check exhaustion first (divergence signal)
    IF macro_state.is_policy_divergent AND macro_state.transition_state == 'PENDING_CONFIRMATION':
        IF avg_stress < 0.20:
            RETURN MR_EXHAUSTION

    -- Acute: overwhelming stress
    IF avg_stress > 0.80 AND pct_stress > 0.50:
        RETURN MR_ACUTE

    -- Systemic: broad but not universal stress
    IF avg_stress > 0.50 AND pct_high_stress > 0.30:
        RETURN MR_SYSTEMIC

    -- Selective: localized stress
    IF avg_stress > 0.20:
        RETURN MR_SELECTIVE

    -- Exhaustion: stress fading
    RETURN MR_EXHAUSTION
```

### 4.3 Current Classification (2026-02-01)

Based on the latest sovereign_regime_state_v4 snapshot:

- Total assets in universe: 48
- Assets in STRESS: ~8 (~17%)
- Assets with stress_prob > 0.60: ~12 (~25%) â€” BCH, BNB, DOT, ETH, BTC, CHZ, EOS, EURCHF, SAND, etc.
- Portfolio avg stress_prob: ~0.35 (estimated from weighted distribution)
- is_policy_divergent: true
- transition_state: PENDING_CONFIRMATION

**Classification: `MR_SELECTIVE`** â€” The majority of assets are in BEAR (not STRESS), stress is concentrated in major-cap crypto (BTC, ETH) and a few altcoins, while most of the portfolio shows orderly decline. The policy divergence (CRISIS vs belief STRESS) at 1/5 confirms suggests the macro regime may be transitioning.

### 4.4 Observational Implications per Micro-Regime

| Micro-Regime | Options Observation Policy | Hypothesis Generation | Envelope Relaxation |
|-------------|--------------------------|----------------------|-------------------|
| MR_ACUTE | OBSERVE protective only (PROTECTIVE_PUT) | Suspend new generation | NONE â€” all blocked |
| MR_SYSTEMIC | OBSERVE protective + defined-risk | Allow BEAR-thesis only | NONE â€” macro blocks |
| MR_SELECTIVE | OBSERVE all strategies, log counterfactuals | Allow regime-conditional | NONE â€” macro blocks |
| MR_EXHAUSTION | OBSERVE all, flag potential transition | Allow full generation | NONE â€” awaits macro transition |

**Critical:** Envelope relaxation is ALWAYS NONE under CRISIS macro. Micro-regimes provide observational granularity only. The DEFCON/kill-switch system and strategy eligibility envelope continue to read the macro CRISIS label. This is a hard invariant.

---

## 5. Regime-Delta Integration

### 5.1 Existing Infrastructure

The `fhq_operational.regime_delta` table already exists with the following schema:

| Column | Type | Purpose |
|--------|------|---------|
| delta_type | text | Type of regime change detected |
| intensity | numeric | Magnitude of the change |
| momentum_vector | text | Direction of the change |
| bollinger_width | numeric | Volatility bandwidth |
| squeeze_tightness | numeric | Squeeze compression level |
| canonical_regime | text | Current regime at detection |
| regime_alignment | boolean | Whether delta aligns with regime |

The table is currently empty (0 rows). The micro-regime classifier will produce `MICRO_REGIME_SHIFT` delta events when the micro-regime changes within CRISIS.

### 5.2 Delta Event Format

When micro-regime transitions occur, the classifier writes to `fhq_operational.regime_delta`:

```
delta_type: 'MICRO_REGIME_SHIFT'
canonical_regime: 'CRISIS'
intensity: abs(new_avg_stress - old_avg_stress)
momentum_vector: 'IMPROVING' | 'DETERIORATING' | 'STABLE'
regime_alignment: true (always aligned with CRISIS macro)
```

### 5.3 Integration Points (Observer-Only)

| Consumer | How It Uses Micro-Regime | Authority Level |
|----------|------------------------|-----------------|
| volatility_observer.py (IoS-009) | Reads micro_regime from latest classification; logs in observation metadata | READ-ONLY |
| options_hypothesis_canon | New column `micro_regime_at_observation` captures state at hypothesis creation | METADATA-ONLY |
| CADENCE_STATE.json | Reports current micro_regime in status | REPORTING-ONLY |
| Decision Pack Generator | Includes micro_regime context in daily pack | INFORMATIONAL |

**NOT integrated with (hard constraint):**
- options_shadow_adapter.py â€” NO import, NO read
- unified_execution_gateway.py â€” NO changes
- options_defcon_killswitch.py â€” NO changes
- Any execution table â€” NO writes

---

## 6. Falsification Design

The micro-regime taxonomy itself must be falsifiable:

| Criterion | Falsified If | Measurement |
|-----------|-------------|-------------|
| Micro-regimes capture distinct return distributions | Return distributions are statistically identical across micro-regimes (KS-test p > 0.10) | Compare 30-day returns per micro-regime after 90 days |
| Micro-regime transitions predict macro transitions | Micro-regime progression (ACUTE â†’ SYSTEMIC â†’ SELECTIVE â†’ EXHAUSTION) does NOT precede macro regime changes | Count predictive vs. non-predictive sequences |
| Micro-regimes improve hypothesis quality | Hypotheses generated under micro-regime context have same falsification rate as without | Compare falsification rates before/after micro-regime metadata |
| MR_EXHAUSTION identifies bottoms | MR_EXHAUSTION classification does NOT precede recovery within 30 days at rate > chance (50%) | Track EXHAUSTION â†’ recovery transitions |

---

## 7. Files Created by This Directive

| File | Type | Purpose |
|------|------|---------|
| `02_IOS/IoS-003B_MICRO_REGIME_TAXONOMY.md` | Specification | This document |
| `04_DATABASE/MIGRATIONS/353_micro_regime_infrastructure.sql` | Migration | Add micro_regime columns + classification table |
| `03_FUNCTIONS/micro_regime_classifier.py` | Module | Classification logic + CLI |
| `03_FUNCTIONS/evidence/CEO_DIR_2026_OPS_MICROREGIME_003_EVIDENCE.json` | Evidence | Classification results + test status |

---

## 8. Acceptance Criteria

| # | Criterion | Verification |
|---|-----------|-------------|
| 1 | 4 micro-regimes defined with deterministic classification logic | This document |
| 2 | Current state classified correctly against database evidence | Classifier output matches manual analysis |
| 3 | Migration adds metadata columns without altering execution tables | information_schema verification |
| 4 | No execution authority granted | Assertion-enforced in code |
| 5 | Integration points are read-only | Code review |
| 6 | Full experiment status report delivered | Evidence JSON |
# IoS-003C: Crypto Regime Engine

**Status:** P1_ACTIVATED
**Assigned To:** FINN (Financial Investments Neural Network)
**API Requirement:** DeepSeek Reasoning API
**Activated:** 2026-01-18
**Directive:** CEO-DIR-2026-076, **CEO-DIR-2026-089** (Discipline Upgrade)

---

## 1. Executive Summary

The Crypto Regime Engine (IoS-003C) is a dedicated research module to develop regime classification for cryptocurrency assets. This is explicitly **separate** from the equity regime engine (IoS-003) due to fundamental structural differences between asset classes.

**Core Doctrine:** Alpha speaks first. Measurement verifies. Instruments listen. Capital waits.

**Scope:** Crypto regime research only. No execution. No paper. No live. No cross-domain coupling.

---

## 2. HARD CONSTRAINTS (ABSOLUTE) â€” CEO-DIR-2026-089

### 2.1 Domain Separation (ENFORCED)

- Crypto regimes **MUST NOT** alter, recalibrate, or influence any EQUITY signal, inversion logic, confidence ceiling, OKR, or ledger.
- Any attempt to reuse equity regime definitions, thresholds, or labeling logic is **PROHIBITED** unless explicitly authorized in a later CEO directive.

### 2.2 No Execution Pressure

- Research outputs are descriptive and evaluative only.
- No PnL targets, no trade simulation objectives, no options logic embedded in IoS-003C research layer.

### 2.3 Definition Freeze

- Target definition, horizon definition, dataset inclusion rules, and regime ontology must be **FROZEN at Gate 1**.
- Any change after freeze requires VEGA logged exception + CEO approval.

---

## 3. Why Equity Regimes Fail for Crypto

| Equity Regime Driver | Crypto Reality |
|---------------------|----------------|
| M2 Money Supply | Stablecoin Velocity is the driver |
| Real Rates (10Y TIPS) | DeFi yields and funding rates dominate |
| VIX as stress proxy | Perp funding rates + liquidation cascades |
| Sector rotation | Protocol/narrative rotation |
| Market hours | 24/7 continuous trading |
| Regulatory clarity | Regulatory uncertainty is structural |

**Empirical Evidence:**
- STRESS@99%+ on crypto has **inconsistent** inversion characteristics
- Vol-squeezes are misinterpreted as STRESS by equity HMMs
- Funding rate dynamics have no equity analog

---

## 4. DISCIPLINE REQUIREMENTS (MANDATORY) â€” CEO-DIR-2026-089

### 4.1 HYSTERESIS (IoS-003 Section 3.1 Discipline)

**Purpose:** Prevent flip-flopping in volatile markets and make regimes operationally meaningful.

**Owner:** FINN
**Gate:** G1 (2026-01-25)

**Requirements:**
- Define deterministic transition thresholds using hysteresis buffers
- Buffers must be volatility-adjusted (explicit rule required)

**Deliverables:**
- [ ] Entry threshold per regime transition
- [ ] Exit threshold per regime transition
- [ ] Minimum dwell time rule (if used)
- [ ] Proof that hysteresis reduces regime churn without hiding true transitions

**STIG Verification:** Hysteresis parameters and transitions must be logged and reproducible.

---

### 4.2 CRIO ACTIVATION FOR LANE C (ADR-014)

**Purpose:** Causal mechanism clarity for microstructure stress.

**Owner:** CRIO
**Gate:** G3 (2026-02-15)

**Delegation:** Lane C (funding, OI, liquidations, basis, microstructure stress) is delegated to CRIO for causal mapping.

**CRIO Deliverables:**
- [ ] Causal mechanism map (what transmits to what, under which conditions)
- [ ] Mechanism hypotheses that are falsifiable
- [ ] Shortlist of "must-have" microstructure variables with rationale and expected directionality
- [ ] Funding Rate Arbitrage mapping (CEO recommendation)
- [ ] Short Squeeze Dynamics mapping (CEO recommendation)

**Scope:** GraphRAG/causal reasoning only â€” NOT model building.

---

### 4.3 STATISTICAL DISCIPLINE (IoS-005)

**Purpose:** Prove predictive skill is not luck.

**Owner:** FINN
**Gate:** G3 (2026-02-15)

**Requirements:**
- Gate 3 results must pass bootstrap significance
- Null hypothesis: performance equals random baseline for the chosen target
- Minimum: **p < 0.05** for primary KPI (Brier improvement or directional skill)

**Deliverables:**
- [ ] Bootstrap method described
- [ ] Number of resamples
- [ ] Confidence intervals for key metrics
- [ ] Sensitivity across subperiods (minimum: high-vol vs low-vol windows)

**Failure Mode:** If p >= 0.05, IoS-003C does NOT advance to Gate 4.

---

### 4.4 CONTEXTUAL INTEGRITY AND CANONICAL IDS (IoS-001)

**Purpose:** Prevent identity drift across spot/derivatives and across providers.

**Owner:** STIG
**Gate:** G2 (2026-02-01)

**Requirements:**
STIG must verify â€” against database truth â€” that Lane A and Lane C inputs can be anchored to:
- `canonical_id` (asset identity)
- `exchange_mic` (venue identity, where applicable)
- `instrument_type` (spot, perp, option â€” classification only)

**AIRLOCK Protocol:**
If a provider cannot support canonical ID tagging, it must be placed behind an explicit "AIRLOCK" label with clear lineage, and excluded from any canonical conclusions until resolved.

---

### 4.5 EPOCH-BASED EVALUATION (Crypto 24/7 Primitive)

**Purpose:** Create a stable evaluation boundary equivalent to "trading day" for auditability.

**Owner:** STIG
**Gate:** G2 (2026-02-01)

**Canonical Evaluation Delimiter:**
- **00:00 UTC Snapshot** as the boundary for horizon evaluation and outcome capture

**Requirements:**
- Horizons must be defined relative to this epoch boundary
- NOT "calendar day add"
- NOT local exchange time

**Benefits:**
- Comparability across venues and timezones
- Prevents silent denominator shifts

**STIG Verification:** Outcome capture uses epoch convention consistently and is logged as part of the evidence bundle.

---

## 5. Research Lanes

### Lane A: Macro Liquidity
| Dimension | Data Source | Hypothesis |
|-----------|-------------|------------|
| **Net Stablecoin Liquidity** | On-chain (Glassnode, Dune) | Stablecoin inflows = risk-on, outflows = risk-off |
| **Global Liquidity Friction** | DXY + 10Y Real Rates | Macro squeeze compresses crypto first |

### Lane B: Volatility & Sentiment
| Dimension | Data Source | Hypothesis |
|-----------|-------------|------------|
| **Volatility Clustering** | GARCH/realized vol patterns | Regime persistence detection |
| **Narrative Momentum** | Social sentiment (LunarCrush, Santiment) | Reflexivity in crypto markets |

### Lane C: Microstructure Stress (CRIO Domain)
| Dimension | Data Source | Hypothesis |
|-----------|-------------|------------|
| **Perp Funding Rates** | Coinglass, Laevitas | Extreme funding = mean reversion signal |
| **Liquidation Cascades** | Coinglass | Stress transmission mechanism |
| **Open Interest** | Coinglass | Leverage buildup indicator |
| **Basis/Spread** | Kaiko | Arbitrage stress indicator |
| **Exchange Flow Ratio** | Glassnode | Selling pressure indicator |

---

## 6. GATE REQUIREMENTS (BINDING) â€” CEO-DIR-2026-089

### Gate 1 â€” 2026-01-25
**Owner:** FINN

| Requirement | Status |
|-------------|--------|
| Regime ontology frozen (3-6 states) | PENDING |
| Primary target frozen (what we predict) | PENDING |
| Hysteresis specification included (transition thresholds) | PENDING |

---

### Gate 2 â€” 2026-02-01
**Owner:** STIG (+ CDMO if applicable)

| Requirement | Status |
|-------------|--------|
| Data "AIRLOCK" validation completed for Lane A and Lane C | PENDING |
| Canonical ID tagging verified (or explicitly flagged as blocked) | PENDING |
| Epoch boundary (00:00 UTC) implemented for evaluation semantics | PENDING |

---

### Gate 3 â€” 2026-02-15
**Owner:** FINN + CRIO

| Requirement | Status |
|-------------|--------|
| Brier < 0.25 on primary target (as defined in Gate 1) | PENDING |
| Bootstrap significance p < 0.05 on primary KPI | PENDING |
| CRIO causal mechanism map delivered for Lane C | PENDING |

---

### Gate 4 â€” 2026-02-22
**Owner:** VEGA

| Requirement | Status |
|-------------|--------|
| Evidence Bundle signed | PENDING |

**Evidence Bundle Contents:**
- Definition freeze proof
- Dataset lineage and AIRLOCK status
- Canonical ID compliance report
- Hysteresis proof (reduced churn)
- Significance report (bootstrap)
- Calibration and stability summary

**NO G4 SIGNATURE = NO CEO DECISION GATE**

---

## 7. Success Criteria

| Metric | Target | Rationale |
|--------|--------|-----------|
| Brier Score | < 0.25 | Must beat random by structural correctness |
| Bootstrap p-value | < 0.05 | Prove predictive skill is not luck |
| Hit Rate | > 55% | Directional edge required |
| Regime Persistence | > 3 days mean | Regimes must be tradeable |
| Hysteresis Churn Reduction | Demonstrable | Operational meaningfulness |

---

## 8. Research Sources

### Academic Literature
- "Cryptocurrency Market Microstructure" (Makarov & Schoar, 2020)
- "Bitcoin Trading and Volatility" (Baur & Dimpfl, 2021)
- "Stablecoin Runs" (Lyons & Viswanath-Natraj, 2023)

### On-Chain Analytics Providers
- Glassnode (chain metrics, exchange flows)
- Dune Analytics (DeFi flows)
- DefiLlama (TVL dynamics)

### Market Microstructure Data
- Coinglass (funding rates, liquidations, OI)
- Laevitas (options flow)
- Kaiko (order book depth, basis)

### Sentiment/Narrative
- LunarCrush (social metrics)
- Santiment (developer activity)

---

## 9. Governance

### 9.1 Isolation Requirements

```
CRYPTO REGIME ENGINE (IoS-003C)
â”œâ”€â”€ Separate schema: vision_crypto (proposed)
â”œâ”€â”€ Separate forecast table: crypto_regime_forecasts
â”œâ”€â”€ Separate outcome table: crypto_regime_outcomes
â”œâ”€â”€ NO cross-reference to equity tables
â”œâ”€â”€ NO shared calibration parameters
â”œâ”€â”€ AIRLOCK for non-canonical data sources
â””â”€â”€ Epoch boundary: 00:00 UTC
```

### 9.2 Authority Boundaries

| Agent | Role | Gate |
|-------|------|------|
| FINN | Research, model development, hysteresis design | G1, G3 |
| CRIO | Lane C causal mechanism mapping | G3 |
| STIG | Data pipeline, canonical ID verification, epoch implementation | G2 |
| VEGA | Audit, evidence bundle attestation | G4 |
| CEO | Final approval for production activation | Post-G4 |

### 9.3 Change Gates (ADR-004)

All transitions between Gate 1-4 must be logged in `fhq_meta.adr_audit_log` with specific event_type in compliance with ADR-004.

### 9.4 Canonical Truth Protection (ADR-013)

No sub-executives (CRIO, CDMO) have write access to canonical domains. Any attempt to write crypto regimes to `fhq_meta.canonical_domain_registry` before G4 is a **Class A violation**.

### 9.5 Crypto Forecast Status

**CURRENT: BLOCKED**

No crypto forecasts may be generated until IoS-003C passes G4 audit.

---

## 10. Risk Register

| # | Risk | Severity | Mitigation |
|---|------|----------|------------|
| R1 | Data Lineage Contamination | HIGH | AIRLOCK protocol for non-canonical sources |
| R2 | Target Ambiguity | HIGH | Definition freeze at G1 |
| R3 | Identity Drift (spot vs perp) | HIGH | Canonical ID tagging verification at G2 |
| R4 | Sample Size Insufficient | MEDIUM | Minimum 100 forecasts before G3 |
| R5 | Regime Non-Stationarity | MEDIUM | Hysteresis buffers + high/low vol subperiod testing |

---

## 11. Timeline

| Milestone | Target Date | Owner | Status |
|-----------|-------------|-------|--------|
| Research Kickoff | 2026-01-18 | FINN | **ACTIVATED** |
| **Gate 1: Definition Freeze** | 2026-01-25 | FINN | PENDING |
| **Gate 2: Data Infrastructure** | 2026-02-01 | STIG | PENDING |
| **Gate 3: Model Validation** | 2026-02-15 | FINN+CRIO | PENDING |
| **Gate 4: VEGA Attestation** | 2026-02-22 | VEGA | PENDING |
| CEO Decision Gate | 2026-02-28 | CEO | PENDING |

---

## 12. CEO Guidance

> "Crypto regimes will not be 'good enough' by being clever. They will be accepted only if they are: deterministic in definitions, statistically defensible, identity-clean, causally coherent, comparable over time. Do this once. Do it right. Then we move."
>
> â€” CEO-DIR-2026-089

> "This is not caution. This is correctness. Crypto and equity are epistemically non-transferable domains. Build from first principles."
>
> â€” CEO-DIR-2026-076

---

## References

- **CEO-DIR-2026-089**: IoS-003C Discipline Upgrade (Research Only)
- **CEO-DIR-2026-076**: STRESS Inversion Validation + Crypto Regime Separation
- **ADR-003**: Institutional Standards (MDLC)
- **ADR-004**: Change Gates (G0-G4)
- **ADR-013**: Kernel Specification (Infrastructure Sovereignty)
- **ADR-014**: Sub-Executive Governance
- **IoS-001**: Contextual Integrity
- **IoS-003**: Regime Classification Engine (EQUITY)
- **IoS-005**: Statistical Discipline
IoS-004 â€” Regime-Driven Allocation Engine

Version: 2026.PROD.0
Owner: LARS
Tier: Tier-2 (Decision Layer)
Parent: IoS-003 Meta-Perception Engine
Status: Awaiting stig verification

1. Purpose & Mission

IoS-004 is FjordHQâ€™s first capital-allocation module - (Until further notice - ONLY PAPER MODE)
It transforms canonical regime states from IoS-003 (the HMM v2.0 Meta-Perception Engine) into deterministic, auditable portfolio weights.

Mission:
Convert market regimes into capital exposure with zero ambiguity, zero hidden assumptions, and zero leverage unless explicitly authorized.

IoS-004 provides:

A unified, deterministic exposure framework

A risk-balanced allocation protocol

Predictable capital flows for execution (IoS-005)

Full replay determinism under ADR-011

One-True-Source governance (no competing signals)

2. Dependencies
Dependency	Description	Contract
IoS-003	Canonical 9-state HMM regime engine	regime_label + confidence
Appendix_A_HMM_REGIME	Canonical HMM v2.0 specification	Feature space, training, state logic
fhq_research.regime_predictions_v2	Truth source for all regime signals	Only ACTIVE model allowed
fhq_market.prices	Daily reference prices	Used for normalizations
fhq_meta.ios_registry	IoS governance registry	Version control + ownership
task_registry	Pipeline binding	task_name = 'REGIME_ALLOCATION_ENGINE_V1'

No other model, table, or signal source is permitted.

3. Input Specification
3.1 Truth-Bound Input Source (Non-Negotiable)

All allocation decisions MUST originate from:

fhq_research.regime_predictions_v2
WHERE model_id IN (
    SELECT model_id
    FROM fhq_research.regime_model_registry
    WHERE is_active = TRUE
)


This enforces:

One-True-Model

Full lineage traceability

Deterministic system replay (ADR-011)

Legacy models, alternate tables, or external signals are strictly forbidden.

3.2 Required Input Fields
Field	Description
asset_id	Canonical symbol
timestamp	Trading date
regime_label	9 canonical HMM states
confidence	Model confidence (0â€“1)
model_id	Active model identifier
4. Core Logic â€” Allocation Engine
4.1 Regime â†’ Exposure Mapping (Raw Targets)
Regime	Exposure Target
STRONG_BULL	1.00
BULL	0.70
RANGE_UP	0.40
PARABOLIC	1.00
NEUTRAL	0.00
BEAR	0.00
STRONG_BEAR	0.00
RANGE_DOWN	0.00
BROKEN	0.00

Raw exposures are pre-constraint values.
Portfolio-level constraints apply after this stage.

4.2 Portfolio Constraint Framework (Global Bag Limit)
4.2.1 Total Exposure Cap (Hard Rule)
Î£(exposure_constrained) â‰¤ 1.0


No implicit leverage is allowed.
Leverage Mode requires a separate IoS and CEO G4 authorization.

4.2.2 Equal Weight Rule (v1.0)

If more than one asset is in risk-on (exposure_raw > 0):

allocated_weight(asset) = 1.0 / N_risk_on_assets


Equal Weight overrides raw exposure when more than one asset is active.

This ensures:

Audit simplicity

Predictable diversification

Zero implicit bias toward any asset

Deterministic replay

4.2.3 Proportional Rescaling (Exposure Normalization)

If Î£(raw_exposures) > 1.0:

exposure_constrained(asset) = raw_exposure(asset) / Î£(raw_exposures)


This is applied before cash_weight computation.

4.3 Elimination of Double Hysteresis

IoS-003 already applies:

5-day persistence

Regime smoothing

Transition certainty thresholds

Volatility anomaly overrides

Additional smoothing in IoS-004 would create unacceptable lag.

Updated Rule (Critical)

IoS-004 executes immediately on the first CONFIRMED regime state emitted by IoS-003.

Only states marked CONFIRMED are valid.
Transient or anomaly-corrected states MUST be ignored.

5. Volatility Block (Safety Brake)

If either of the following is true:

confidence < 0.50

vol_shock_score (from fhq_perception.regime_daily) exceeds abnormal thresholds

Then:

exposure_raw = 0.0


This prevents capital deployment in unstable or ambiguous market conditions.

6. Output Specification

IoS-004 writes to:

fhq_positions.target_exposure_daily

Fields
Field	Description
asset_id	Canonical symbol
timestamp	Trading date
exposure_raw	Pre-constraint exposure
exposure_constrained	Final exposure after constraints
cash_weight	1.0 âˆ’ Î£(exposure_constrained)
model_id	HMM model used
regime_label	Underlying regime
confidence	Model confidence
lineage_hash	ADR-011 lineage
hash_prev	Parent hash
hash_self	Row-level hash
6.1 Portfolio-Level Accounting Invariant

Invariant:

Î£(exposure_constrained) + cash_weight = 1.0


Rules:

Summation is evaluated per portfolio per date

Negative cash_weight is forbidden

If Î£(exposure_constrained) < 1.0, the remainder MUST flow to cash

This provides:

Double-entry bookkeeping

Full auditability

No leverage bleed

Clear idle capital tracking

Enforced using:

Per-day aggregate validation

AFTER INSERT/UPDATE verification triggers

Deterministic lineage hashing (ADR-011)

7. Governance & Compliance
7.1 Authority Matrix
Role	Authority
LARS	Owner, strategic decisions
VEGA	Veto power, audit enforcement
STIG	Schema + deterministic logic
CODE	Execution Engine (EC-011)
7.2 Pipeline Binding

IoS-004 is bound to:

task_registry.task_name = 'REGIME_ALLOCATION_ENGINE_V1'
owned_by_agent = LARS
executed_by_agent = CODE
gate_level = G1

7.3 Gating Requirements

IoS-004 must pass the full gate cycle:

Gate	Requirement
G0	Registration + schema creation
G1	Technical validation
G2	Governance review
G3	Audit validation
G3B	Triple Verification (hash, schema, semantic replay)
G4	CEO approval (mandatory)

Failure at any stage results in STOP_AND_WAIT_FOR_CEO.

8. Versioning

IoS-004 v2026.PROD.0

Hash Chain: HC-IOS-004-2026

All forward changes require new IoS-004 minor or major version

Leverage Mode and multi-strategy blending reserved for IoS-004B/005

IoS-004 â€” Final Statement

"IoS-004 transforms perception into action with institutional precision.
Every weight is justified, every exposure is traceable, and every allocation is reproducible under audit.
This is the first true capital engine of FjordHQ."
IoS-005 â€” Forecast Calibration & Skill Engine Canonical Version: 2026.PROD.0Owner: LARS (Chief Strategy & Reasoning Officer)Technical Authority: STIGGovernance: VEGAExecution: CODE (Alpha Lab v1.0 Core)Dependencies: IoS-001 â†’ IoS-004Status: READY FOR G0 SUBMISSION1. Executive SummaryIoS-005 establishes the "Supreme Court" of Strategy.While IoS-004 executes decisions based on perceived market regimes, IoS-005 validates the quality of those decisions. It transforms FjordHQ from a deterministic allocator into an audited, scientifically calibrated forecasting system.It operationalizes the Alpha Lab v1.0 codebase to answer the three constitutional questions of the FjordHQ Investment Committee:Is the edge real? (Statistical Significance > Luck)Is the edge stable? (Forecast Calibration)Is the edge scalable? (Performance vs. Decay)IoS-005 is the bridge between historical truth (IoS-001 â†’ IoS-004) and future validity. No forecasting engine or strategy update may go live without passing the calibration and skill criteria defined herein.2. Strategic MandateIoS-005 holds sole authority over Performance Certification. Its mandate is to:Measure: Quantify the performance of regime-driven allocations (IoS-004) across the full canonical history with zero drift.Isolate: Distinguish true predictive skill from random market beta using statistical controls (Bootstrap/Permutation).Calibrate: Align forecast confidence with realized outcomes to inform future risk-sizing (IoS-010+).Audit: Produce an immutable performance ledger aligned with ADR-013 (One-Source-of-Truth).Constraint: This module evaluates strategies; it does not modify them.3. System Architecture PositionIoS-005 sits at the critical juncture between Execution and Evolution.IoS-001 (Canonical Assets)
       â†“
IoS-002 (Sensory Cortex)
       â†“
IoS-003 (Meta-Perception / HMM v4.0)
       â†“
IoS-004 (Allocation Engine)
       â†“
[ IoS-005: CALIBRATION & SKILL ENGINE ]  <-- SCIENTIFIC VALIDATION LAYER
       â†“
Future Modules (IoS-010+ / Strategy Evolution)
Without IoS-005, the feedback loop is broken. With IoS-005, the system learns from verified reality.4. Functional Core (The Alpha Lab Integration)IoS-005 formally adopts the Alpha Lab v1.0 codebase as its execution core.4.1 Deterministic Historical SimulatorObjective: Reproducibility.Using alpha_lab.core.historical_simulator, IoS-005 must replay IoS-004 exposures exactly, utilizing:Canonical prices (IoS-001)Canonical regimes (IoS-003)Canonical constrained exposures (IoS-004)Output: A drift-free equity curve that matches the G4 production database bit-for-bit.4.2 The Metric SuiteObjective: Standardization.From alpha_lab.analytics.metrics, IoS-005 computes the standard institutional scorecard:Risk: Max Drawdown, Volatility, Downside Deviation.Return: CAGR, Total Return.Efficiency: Sharpe, Sortino, Calmar, Information Ratio.Behavior: Hit Rate, Win/Loss Ratio, Tail Ratio.4.3 Statistical Skill Validation (The "Luck Test")Objective: Significance.Skill must be proven, not assumed. IoS-005 enforces alpha_lab.core.statistics:Bootstrap Resampling: Does the strategy beat 1,000 random reshufflings of its own returns?Permutation Tests: Does the signal outperform random noise?P-Value Constraint: No model is certified until statistical significance is established at p < 0.05.4.4 The FjordHQ Skill Score (FSS)Objective: Unified KPI.IoS-005 synthesizes complex metrics into a single, hash-anchored score for Board Reporting:$$FSS = (0.4 \times RiskAdjReturn) + (0.3 \times Stability) + (0.2 \times Significance) + (0.1 \times Consistency)$$This formula is deterministic and governs the "Strategy Confidence Index" for future scaling.5. Data Model & LineageIoS-005 writes to the fhq_research schema under strict ADR-011 Fortress protection.5.1 fhq_research.forecast_skill_registryThe permanent record of strategic competence per module version.ColumnDescriptionscorecard_idUUID Primary Keyengine_versione.g., "IoS-004_v2026.PROD.1"fss_scoreThe calculated Skill Scoresharpe_ratioCore efficiency metricp_valueStatistical significanceis_certifiedBoolean (True if p < 0.05 and Sharpe > 1.0)config_hashHash of the Alpha Lab configurationlineage_hashADR-011 Chain Link5.2 fhq_research.backtest_resultsDetailed daily performance logs for visualization and drill-down analysis.6. Governance & Compliance6.1 VEGA OversightVEGA must verify:Zero Drift: Input data matches IoS-004 production tables exactly.Statistical Validity: Tests are run according to the Alpha Lab standard configuration.Hash Integrity: All scorecards are anchored in the vision_verification chain.6.2 ADR AlignmentADR-003 (Institutional Standards): Implements GIPS-compliant logic.ADR-011 (Fortress): All results are immutable and chained.ADR-013 (One-True-Source): No side-calculations; results are stored canonically.7. Acceptance Criteria (G4 Activation)IoS-005 is eligible for G4 Activation when:End-to-End Replay: The simulator reproduces the 10-year IoS-004 backfill with zero deviation.Metric Completeness: All 25+ metrics compute without errors or nulls.Statistical Validation: Bootstrap and Permutation tests execute successfully and produce reproducible p-values.Artefact Lineage: Full hash verification of the Skill Registry.FSS Generation: The FjordHQ Skill Score is successfully computed and stored.8. SummaryIoS-005 forces the system to be honest. It replaces narrative with mathematics.By activating this module, LARS gains the ability to reason using calibrated truth, and VEGA gains the power to enforce statistical governance.Status: G0 SUBMISSION READY.End of Document.
# IoS-005 â€” G0 Technical Assessment

**Module:** IoS-005 Forecast Calibration & Skill Engine
**Canonical Version:** 2026.PROD.0
**Assessment Date:** 2025-11-29
**Reviewer:** STIG (EC-003, Chief Technology Officer)
**Gate:** G0 (Initial Technical Review)

---

## 1. Executive Summary

**RECOMMENDATION: G0 APPROVED â€” PROCEED TO G1 DEVELOPMENT**

The IoS-005 specification is technically sound and architecturally well-positioned. The module addresses a critical gap in the FjordHQ system: the absence of scientific validation for regime-driven allocation decisions.

### Key Findings

| Category | Status | Notes |
|----------|--------|-------|
| Specification Quality | âœ“ PASS | Well-structured, clear acceptance criteria |
| Dependency Chain | âœ“ PASS | IoS-002, IoS-003, IoS-004 all G4 ACTIVE |
| Schema Design | âœ“ PASS | Tables created, indexes optimized |
| Task Registration | âœ“ PASS | Registered in governance system |
| Data Availability | âš  GAP | Canonical price data requires ingestion |
| Alpha Lab Codebase | âš  GAP | Codebase does not exist, must be built |

---

## 2. Dependency Assessment

### 2.1 Upstream Dependencies (All Satisfied)

| Module | Status | Activation Date | Data Rows |
|--------|--------|-----------------|-----------|
| IoS-002 (Sensory Cortex) | G4 ACTIVE | 2025-11-29 | â€” |
| IoS-003 (HMM Perception) | G4 ACTIVE | 2025-11-29 | 10,103 |
| IoS-004 (Allocation Engine) | G4 ACTIVE | 2025-11-29 | 10,103 |

### 2.2 Data Sources Available

| Table | Schema | Rows | Date Range |
|-------|--------|------|------------|
| `regime_predictions_v2` | fhq_research | 10,103 | 2016-08-29 â†’ 2025-11-28 |
| `target_exposure_daily` | fhq_positions | 10,103 | 2016-08-29 â†’ 2025-11-28 |
| `indicator_momentum` | fhq_research | 11,135 | 2015-12-15 â†’ 2025-11-28 |
| `indicator_trend` | fhq_research | 11,187 | 2015-12-02 â†’ 2025-11-28 |

### 2.3 Data Gap: Canonical Price Series

**Issue:** The `fhq_data.price_series` table contains only 720 rows for 1 listing (1 month of data). IoS-005 requires 10+ years of daily close prices for 4 assets to compute returns.

**Resolution Required for G1:**
1. Ingest canonical OHLCV data for BTC-USD, ETH-USD, SOL-USD, EURUSD
2. Store in `fhq_research.backtest_price_cache` or populate `fhq_data.price_series`
3. Ensure price data aligns with `target_exposure_daily` timestamps

---

## 3. Infrastructure Created

### 3.1 Schema Migration

**File:** `04_DATABASE/MIGRATIONS/029_ios005_forecast_calibration_schema.sql`

**Tables Created:**

| Table | Purpose | Key Columns |
|-------|---------|-------------|
| `fhq_research.forecast_skill_registry` | Skill scorecards | FSS score, Sharpe, p-values, certification |
| `fhq_research.backtest_results` | Daily performance | Returns, exposures, drawdowns |
| `fhq_research.backtest_price_cache` | Price reproducibility | Canonical prices per backtest |

### 3.2 Hash Chain

| Property | Value |
|----------|-------|
| Chain ID | `HC-IOS-005-2026` |
| Chain Type | `IOS_MODULE` |
| Chain Scope | `IoS-005` |
| Genesis Hash | `379f8019aa36e776304b911e6f9a631177576e1488d03ead0d8eb3e3d82d1ae1` |

### 3.3 Task Registration

| Property | Value |
|----------|-------|
| Task Name | `FORECAST_CALIBRATION_ENGINE_V1` |
| Task Status | `REGISTERED` |
| Gate Level | `G0` |
| Owner | `LARS` |
| Executor | `CODE` |

---

## 4. Alpha Lab v1.0 Requirements

The specification references "Alpha Lab v1.0" as the execution core. This codebase does not currently exist and must be developed.

### 4.1 Required Components

| Component | Module Path | Purpose |
|-----------|-------------|---------|
| Historical Simulator | `alpha_lab.core.historical_simulator` | Replay IoS-004 exposures with zero drift |
| Metric Suite | `alpha_lab.analytics.metrics` | 25+ institutional performance metrics |
| Statistics Engine | `alpha_lab.core.statistics` | Bootstrap, permutation tests |
| FSS Calculator | `alpha_lab.core.skill_score` | FjordHQ Skill Score computation |

### 4.2 Recommended Architecture

```
03_FUNCTIONS/alpha_lab/
â”œâ”€â”€ __init__.py
â”œâ”€â”€ core/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ historical_simulator.py    # Deterministic backtest engine
â”‚   â”œâ”€â”€ statistics.py              # Bootstrap & permutation tests
â”‚   â””â”€â”€ skill_score.py             # FSS calculation
â”œâ”€â”€ analytics/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ metrics.py                 # 25+ performance metrics
â””â”€â”€ config/
    â””â”€â”€ default_config.yaml        # Hashable configuration
```

---

## 5. Technical Risks & Mitigations

| Risk | Severity | Mitigation |
|------|----------|------------|
| Price data gap | HIGH | Prioritize canonical price ingestion in G1 |
| Bootstrap compute cost | MEDIUM | Use efficient numpy vectorization, consider parallel processing |
| Floating-point drift | LOW | Use `decimal.Decimal` for financial calculations |
| Hash chain integrity | LOW | Validate all inputs before storage |

---

## 6. G1 Development Scope

For G1 submission, the following must be completed:

### 6.1 Data Ingestion
- [ ] Ingest 10-year canonical price data for 4 assets
- [ ] Validate price-regime alignment (timestamps match)
- [ ] Populate `backtest_price_cache` with source hashes

### 6.2 Alpha Lab Core
- [ ] Implement `historical_simulator.py` â€” replay IoS-004 exposures
- [ ] Implement `metrics.py` â€” all 25+ metrics from specification
- [ ] Implement `statistics.py` â€” bootstrap and permutation tests
- [ ] Implement `skill_score.py` â€” FSS formula

### 6.3 Integration
- [ ] Connect to `target_exposure_daily` (IoS-004)
- [ ] Connect to `regime_predictions_v2` (IoS-003)
- [ ] Write results to `forecast_skill_registry`
- [ ] Write daily logs to `backtest_results`

### 6.4 Validation
- [ ] Zero-drift verification against IoS-004 production data
- [ ] Statistical test reproducibility (fixed random seeds)
- [ ] Hash chain integrity verification

---

## 7. Acceptance Criteria Mapping

| Criterion | Specification Requirement | G1 Implementation |
|-----------|---------------------------|-------------------|
| End-to-End Replay | Zero deviation from IoS-004 | `historical_simulator.py` |
| Metric Completeness | 25+ metrics, no nulls | `metrics.py` |
| Statistical Validation | Bootstrap + Permutation | `statistics.py` |
| Artefact Lineage | Full hash verification | ADR-011 compliance |
| FSS Generation | Computed and stored | `skill_score.py` |

---

## 8. Conclusion

**G0 Status: APPROVED**

IoS-005 is architecturally sound and strategically essential. The specification provides clear acceptance criteria, and the dependency chain is fully satisfied.

**Action Items for G1:**
1. **CODE (EC-011):** Build Alpha Lab v1.0 codebase per Section 4.2
2. **STIG (EC-003):** Supervise canonical price ingestion
3. **VEGA:** Prepare G1 review criteria based on specification Section 7

**Next Gate:** G1 (Implementation Review)

---

**Signed:**
STIG (EC-003)
Chief Technology Officer
2025-11-29T21:55:00Z

**Hash:** `a668d55fd36fd5455c6eba2ff38528cea6462153ea27fb45590c5fca7496371c`
# IoS-005 â€” G1 SCIENTIFIC AUDIT COMPLETION REPORT

**Version:** 2026.PROD.G1
**Owner:** LARS (Tier-1 Strategy & Reasoning)
**Execution:** CODE (EC-011)
**Technical Validation:** STIG
**Governance Attestation:** VEGA
**Scope:** IoS-005 (Audit Engine)
**Subject Evaluated:** IoS-004 (Strategy Engine)
**Date:** 2025-11-30

---

## 1. EXECUTION SUMMARY (Corrected to Meet G1 Mandate)

All technical requirements for G1 are validated.
All scientific tests executed deterministically and without error.

| Criterion | Status |
|-----------|--------|
| All tests executed without error | PASS |
| Bootstrap engine executed correctly | PASS |
| Permutation engine executed | PASS |
| Rolling Sharpe computed | PASS |
| Deterministic replay succeeded | PASS |
| Zero drift vs IoS-004 G4 | PASS |
| Evidence file generated (proper spec) | PASS |
| Lineage + hashes verified (ADR-011) | PASS |
| fhq_analytics schema integrity | PASS |

### G1 Verdict

**IoS-005 (the scientific engine) executed flawlessly and is considered G1 COMPLETE.**

The statistical warnings apply to IoS-004, not IoS-005.

---

## 2. SCIENTIFIC FINDINGS (Strategy Evaluation â€” Not Part of G1 Pass/Fail)

These results do not influence IoS-005 G1 PASS.
They describe the model under evaluation (IoS-004).

### 2.1 Performance Metrics (Canonical Replay)

| Metric | Value | Assessment |
|--------|-------|------------|
| Sharpe Ratio | 2.61 | Strong |
| Sortino Ratio | 3.23 | Strong |
| Calmar Ratio | 6.47 | Excellent |
| Total Return | 5,988x | Extreme |
| Max Drawdown | -29.39% | Strong |

**Interpretation:**
Strong absolute performance.
Mixed statistical robustness.

---

## 3. STATISTICAL SIGNIFICANCE TESTS

These evaluate IoS-004 and do not affect G1 PASS.

| Test | p-value | Threshold | Interpretation |
|------|---------|-----------|----------------|
| Bootstrap | 0.501 | < 0.05 | Not Significant |
| Permutation | 0.173 | < 0.05 | Not Significant |

**Calibrated Status:** `WARNING: STRATEGY_NOT_SIGNIFICANT`

**Explanation:**
p-values above 0.05 mean IoS-004's performance cannot be statistically distinguished from randomness under the given test definitions.

This is not an IoS-005 failure.
It is a precise and correct scientific verdict about IoS-004.

---

## 4. ROLLING SHARPE (12-MONTH WINDOW)

| Year | Min | Median | Max |
|------|-----|--------|-----|
| 2020 | 4.00 | 4.11 | 4.49 |
| 2021 | 3.17 | 3.82 | 4.85 |
| 2022 | 0.26 | 1.25 | 4.09 |
| 2023 | 0.36 | 1.53 | 3.45 |
| 2024 | 1.17 | 3.04 | 4.02 |
| 2025 | 1.66 | 2.22 | 2.93 |

**Interpretation:**
Structural weakness in 2022â€“2023.
This becomes part of the G2 review.

---

## 5. ARTIFACTS

| Artifact | Location |
|----------|----------|
| Migration | `04_DATABASE/MIGRATIONS/030_ios005_g1_analytics_schema.sql` |
| Scientific Audit Script | `03_FUNCTIONS/ios005_scientific_audit_v1.py` |
| Evidence File | `evidence/IOS005_G1_SCIENTIFIC_FINDINGS_20251130.json` |
| Audit Log Row | `fhq_analytics.scientific_audit_log` |

**Evidence Hash:**
```
53cc174b0760f0b2ad2d99f9d5a5a2202ebe084e374fe9f2e3f622de0f5feafc
```

Hash lineage fully valid under ADR-011.

---

## 6. FIXED EXIT CRITERIA (Corrected to Align With Mandate)

### 6.1 IoS-005 G1 PASS requires:

(These validate the system â€” not the strategy.)

- All scientific tests run without error
- Deterministic replay equals IoS-004 output
- No drift detected
- All metrics + p-values computed
- Evidence file generated and hash-anchored
- fhq_analytics passes schema integrity checks
- Lineage columns validated by VEGA

### 6.2 NOT REQUIRED for G1 PASS:

(These apply to IoS-004, not IoS-005.)

- Strategy significance
- p < 0.05
- Positive Sharpe
- Any return threshold
- Any stability criterion

**Because:** IoS-005 evaluates IoS-004. It does not depend on IoS-004's success to be valid.

---

## 7. EXPECTED NULL RESULT REGIME (MANDATORY CLAUSE)

This clause is now part of IoS-005's permanent governance contract.

IoS-005 must assume the following as fundamental truths of scientific finance:

### 7.1 Null results are the statistical baseline

- Most hypotheses will fail significance (p >= 0.05)
- This is expected and correct
- IoS-005 must not treat null results as errors or anomalies

### 7.2 Significant results are rare and require scrutiny

If p < 0.05 occurs:
- VEGA review is mandatory
- Out-of-sample confirmation required
- Multiple-testing controls enforced
- Cross-market validation recommended

### 7.3 Macro correlation sweeps

When exploring:
- rates
- yield curves
- HY spreads
- credit spreads
- liquidity metrics
- volatility indices
- cross-asset factors

IoS-005 must expect:

> "The vast majority of tests will produce no significant correlation."

### 7.4 Anti p-hacking discipline

If IoS-005 detects an unusually high fraction of significant tests:

It must record:
```
WARNING: MULTIPLE_TEST_ANOMALY
```
and trigger VEGA review.

### 7.5 Core Audit Rationale

(Non-negotiable scientific facts)

- Most financial predictors do not work
- Those that do often degrade
- Famaâ€“French showed 90% of factors fail robustness
- Harvey & Liu show most published signals collapse post-multiple-testing

**Therefore:** If IoS-005 returns 98% insignificant results, it is functioning correctly.

This is now enforced logic.

---

## 8. G1 CONCLUSION

**IoS-005 G1: PASSED**

- Audit engine validated
- Scientific pipeline functional
- Canonical truth preserved
- Evidence generated
- Strategy flagged as statistically weak (expected)
- IoS-005 is ready for G2 Governance Review

This marks the system's first fully scientific, reproducible, governance-approved evaluation of a strategy.

This is now the standard for all future IoS research layers.

---

## 9. RECOMMENDATION TO G2 GOVERNANCE

Based on the findings (p > 0.05), IoS-005 recommends that IoS-004 be tagged as **'EXPERIMENTAL'** rather than **'PROVEN'** in the Governance Registry.

While technically sound, the strategy lacks statistical proof of skill, implying reliance on beta or regime-luck.

**Recommended Actions:**

1. Tag IoS-004 with `classification: EXPERIMENTAL` in `fhq_meta.ios_registry`
2. Future capital allocation should be risk-weighted accordingly
3. Continue monitoring until p < 0.05 is achieved across both bootstrap and permutation tests
4. Require out-of-sample validation before upgrading to `PROVEN` status

This recommendation is provided to VEGA for G2 Governance Review.

---

## SIGNATURES

| Role | Agent | Date | Status |
|------|-------|------|--------|
| Technical Validation | STIG | 2025-11-30 | APPROVED |
| Execution | CODE | 2025-11-30 | COMPLETE |
| Strategic Owner | LARS | Pending G2 | â€” |
| Governance Attestation | VEGA | Pending G2 | â€” |

---

**Hash Chain ID:** `HC-IOS-005-2026`
**ADR References:** ADR-002, ADR-004, ADR-011, ADR-012, ADR-013
# IoS-006 â€” G0 TECHNICAL ASSESSMENT

**Version:** 2026.PROD.G0
**Owner:** FINN (Tier-1 Research)
**Technical Authority:** STIG (CTO)
**Validator:** IoS-005 (Constitutional Audit Engine)
**Governance:** VEGA
**Date:** 2025-11-30

---

## 1. EXECUTIVE SUMMARY

IoS-006 Global Macro & Factor Integration Engine has passed G0 Technical Assessment.

**Strategic Hypothesis:** *"Price is the shadow, Macro is the object."*

IoS-006 is not a data pipe â€” it is a **Feature Filtration System** designed to reject 95% of macro candidates. Only features that survive IoS-005's constitutional significance testing may enter future HMM v3.0 (IoS-003B).

---

## 2. DEPENDENCY VERIFICATION

| Dependency | Status | Version | Notes |
|------------|--------|---------|-------|
| IoS-002 | ACTIVE | 2026.PROD.1 | Indicator Engine â€” provides price features |
| IoS-005 | ACTIVE | 2026.PROD.G4 | **CONSTITUTIONAL** â€” validates all features |
| ADR-013 | ACTIVE | â€” | One-True-Source â€” enforces lineage |

**Verdict:** All dependencies satisfied.

---

## 3. SCHEMA ARCHITECTURE

### 3.1 Schema Created: `fhq_macro`

| Table | Purpose | Rows |
|-------|---------|------|
| `feature_registry` | Macro Feature Registry (MFR) â€” canonical truth source | 0 |
| `raw_staging` | Ingestion staging area | 0 |
| `canonical_series` | Immutable historical series (ADR-013) | 0 |
| `stationarity_tests` | ADF test audit trail | 0 |
| `feature_significance` | IoS-005 significance results | 0 |

### 3.2 Key Constraints Implemented

| Constraint | Table | Purpose |
|------------|-------|---------|
| `frequency` CHECK | feature_registry | Valid frequencies only |
| `stationarity_method` CHECK | feature_registry | Valid transforms only |
| `cluster` CHECK | feature_registry | Valid Alpha Cubes only |
| `status` CHECK | feature_registry | Valid lifecycle states only |
| `unique_feature_source` | feature_registry | Prevent duplicate registrations |
| `unique_canonical_point` | canonical_series | One value per feature/timestamp |

---

## 4. FEATURE CLUSTERS (Alpha Cubes)

| Cluster | Code | Hypothesis | Example Features |
|---------|------|------------|------------------|
| **A: Liquidity** | LIQUIDITY | Crypto beta = f(fiat debasement) | M2 YoY, Net Liquidity, TGA |
| **B: Credit** | CREDIT | Credit stress precedes liquidity withdrawal | HY Spreads, Yield Curve, MOVE |
| **C: Volatility** | VOLATILITY | Vol regimes dictate leverage capacity | VIX Term Structure, IV/RV |
| **D: Factors** | FACTOR | Macro-gravity on crypto prices | DXY, Real Rates, Tech Beta |
| **E: On-Chain** | ONCHAIN | Blockchain-native signals | (Future) |
| **F: Sentiment** | SENTIMENT | Positioning and surveys | (Future) |

---

## 5. DATA PIPELINE ARCHITECTURE

```
External Sources (FRED, Bloomberg, Yahoo)
           â†“
    [CEIO Ingestion]
           â†“
    fhq_macro.raw_staging
           â†“
    [Canonicalization (ADR-013)]
           â†“
    fhq_macro.canonical_series
           â†“
    [STATIONARITY GATE]  â†â”€â”€ fhq_macro.stationarity_tests
           â†“
    ADF Test: p < 0.05?
       â”‚
       â”œâ”€â”€ YES â†’ Proceed
       â”‚
       â””â”€â”€ NO â†’ Apply Transform â†’ Re-test â†’ If still non-stationary: REJECT
           â†“
    [LAG ALIGNMENT]
           â†“
    [IoS-005 SIGNIFICANCE TEST]  â†â”€â”€ fhq_macro.feature_significance
           â†“
    p < 0.05 (Bonferroni)?
       â”‚
       â”œâ”€â”€ YES â†’ SIGNIFICANT
       â”‚         â†“
       â”‚    [OOS VALIDATION]
       â”‚         â†“
       â”‚    OOS p < 0.05?
       â”‚       â”‚
       â”‚       â”œâ”€â”€ YES â†’ GOLDEN (â†’ HMM v3.0)
       â”‚       â””â”€â”€ NO â†’ SIGNIFICANT_IS only
       â”‚
       â””â”€â”€ NO â†’ REJECTED (95% expected)
```

---

## 6. STATIONARITY GATE

**Critical Filter:** Non-stationary data is NEVER passed to IoS-005.

### Test Protocol

| Test | Method | Threshold | Action if Failed |
|------|--------|-----------|------------------|
| Level | ADF | p < 0.05 | Apply DIFF |
| After DIFF | ADF | p < 0.05 | Apply LOG_DIFF |
| After LOG_DIFF | ADF | p < 0.05 | Apply SECOND_DIFF |
| After SECOND_DIFF | ADF | p < 0.05 | REJECT feature |

### Transformation Methods

| Method | Formula | Use Case |
|--------|---------|----------|
| DIFF | x(t) - x(t-1) | Unit root removal |
| LOG_DIFF | log(x(t)) - log(x(t-1)) | Percentage changes |
| Z_SCORE | (x - Î¼) / Ïƒ | Standardization |
| SEASONAL_DIFF | x(t) - x(t-period) | Seasonal patterns |

---

## 7. NULL RESULT REGIME

IoS-006 operates under the **Expected Null Result Regime** inherited from IoS-005:

### 7.1 Core Assumptions

- Most macro features will NOT be significant
- Finding no correlation is a valid, expected result
- 95% rejection rate is the baseline expectation

### 7.2 Bonferroni Firewall

When testing N features:
- Adjusted threshold: Î± = 0.05 / N
- Example: 20 features â†’ Î± = 0.0025

### 7.3 Anti-P-Hacking Discipline

- All features MUST be registered in MFR before testing
- No ad-hoc feature creation allowed
- Hypothesis must be documented before testing

---

## 8. IoS-005 INTEGRATION

IoS-006 is **subordinate** to IoS-005 (Constitutional Audit Engine):

| Rule | Description |
|------|-------------|
| **MFR Requirement** | IoS-005 may only test features registered in fhq_macro.feature_registry |
| **Stationarity Requirement** | IoS-005 receives only stationary series |
| **Lag Alignment** | All data is lag-adjusted before testing |
| **Evidence Chain** | All tests produce evidence files linked to fhq_analytics |

---

## 9. GOVERNANCE REGISTRATION

### ios_registry Entry

| Field | Value |
|-------|-------|
| ios_id | IoS-006 |
| title | Global Macro & Factor Integration Engine |
| version | 2026.PROD.G0 |
| status | DRAFT |
| owner_role | FINN |
| dependencies | IoS-002, IoS-005 |

### task_registry Entry

| Field | Value |
|-------|-------|
| task_name | MACRO_FACTOR_ENGINE_V1 |
| task_type | FEATURE_PIPELINE |
| gate_level | G0 |
| gate_approved | FALSE |

### hash_chains Entry

| Field | Value |
|-------|-------|
| chain_id | HC-IOS-006-2026 |
| chain_type | IOS_MODULE |
| schema_frozen | FALSE |

---

## 10. ACCEPTANCE CRITERIA FOR G1

IoS-006 is ready for G1 Technical Validation when:

- [ ] MFR schema tested with sample features
- [ ] Stationarity pipeline (ADF) implemented and tested
- [ ] At least one feature cluster populated with 5+ candidates
- [ ] Lag alignment logic verified
- [ ] IoS-005 integration pathway tested
- [ ] Evidence file generation confirmed

---

## 11. STIG TECHNICAL ASSESSMENT

### 11.1 Architecture Review

| Criterion | Status | Notes |
|-----------|--------|-------|
| Schema design | PASS | 5 tables with proper constraints |
| ADR-013 compliance | PASS | Lineage columns present |
| ADR-011 compliance | PASS | Hash chain created |
| Constraint coverage | PASS | All enums constrained |
| Index strategy | PASS | Appropriate indexes created |

### 11.2 Risk Assessment

| Risk | Severity | Mitigation |
|------|----------|------------|
| Look-ahead bias | HIGH | Lag alignment mandatory |
| P-hacking | HIGH | MFR registration required |
| Non-stationarity | MEDIUM | ADF gate enforced |
| Overfitting | MEDIUM | OOS validation required |

### 11.3 Verdict

**G0 TECHNICAL ASSESSMENT: PASS**

IoS-006 foundation schema is correctly structured and governance-compliant.
Ready to proceed to Phase 2 (Ingest & Canonicalize).

---

## SIGNATURES

| Role | Agent | Decision | Date |
|------|-------|----------|------|
| Technical Authority | STIG | APPROVED | 2025-11-30 |
| Owner | FINN | Pending G1 | â€” |
| Governance | VEGA | Pending G1 | â€” |

---

**Hash Chain:** HC-IOS-006-2026
**Migration:** 035_ios006_macro_factor_foundation.sql
IoS-007 â€” PRODUCTION CERTIFICATE (2026)

Alpha Graph Engine â€” Causal Reasoning Core
Canonical Version: 2026.PROD.G4
Certificate ID: CERT-IOS007-G4-PROD-2026
Authority: CEO + VEGA Tier-1 Compliance
Lineage Chain: HC-IOS-007-2026
Schema State: G4STATE (Activated)

1. Purpose of Certificate

This certificate formally recognizes IoS-007 Alpha Graph Engine as an activated, constitutional module within the FjordHQ Market System, following successful completion of:

G1 Technical Validation (Ironclad)

G2 Governance Validation (Semantic Integrity)

G3 Golden Sample Audit (Logic & Statistical Sanity)

G4 Constitutional Activation (CEO Authority)

By this certificate, IoS-007 is authorized to:

operate as the Causal Reasoning Core

influence system-level decision-making

integrate into statistical workflows under IoS-005

serve as a canonical dependency for future IoS modules

2. Certified Capabilities (Verified)
Capability	Verified By	Evidence File
Deterministic Replay (10-year)	STIG	G1_EXECUTIONâ€¦json
Semantic Ontology Lock (Nodes/Edges)	VEGA	G2_GOVERNANCEâ€¦json
Reasoning Chain Coherence	VEGA	G3_AUDITâ€¦json
Historical Shock Recognition	FINN + VEGA	G3_AUDITâ€¦json
Statistical Significance (p < 0.05)	FINN	G3_AUDITâ€¦json
Golden Sample Anchor Creation	STIG	GS-IOS007-20251130
IoS-005 Statistical Readiness	VEGA	G2_GOVERNANCEâ€¦json
3. Canonical Boundaries (Activated Under G4)
3.1 Node Universe (Frozen)

10 Canonical Nodes approved under ADR-013:

MACRO: Liquidity, Gravity

REGIME: BTC_State, ETH_State, SOL_State

ASSET: BTC, ETH, SOL

FUTURE: Sentiment, Risk

3.2 Edge Ontology (Frozen)

12 canonical edges including:

LEADS (3)

INHIBITS (2)

AMPLIFIES (3)

COUPLES (3)

LEAD_LAG (1)

3.3 Edge Strength Baseline (Locked)

The statistically validated edge coefficients produced in G3 are declared:
â€œProduction Baseline Valuesâ€
Modifiable exclusively via the IoS-005 Recalibration Pathway.

4. Binding Contracts (Activated)
4.1 IoS-005 Statistical Contract

Every inference event produced by IoS-007 must now include:

traceability_hash

ios005_validated = TRUE

ios005_audit_id referencing IoS-005 evidence

Full reproducibility per ADR-002

4.2 Golden Sample Commitment

Golden Sample GS-IOS007-20251130 is registered as:

The immutable regression anchor

The benchmark for all future IoS-007 updates

A requirement for any G1/G2 re-entry

5. Compliance Statement

IoS-007 is hereby certified as compliant with:

ADR-001 â€“ System Charter

ADR-002 â€“ Audit & Error Reconciliation

ADR-003 â€“ Institutional Standards

ADR-011 â€“ Fortress Determinism

ADR-013 â€“ Canonical One-Truth Architecture

ADR-004 â€“ Gate Structure (G1â†’G4)

Compliance signatures confirm:

No Black-Box Logic

Full audit lineage

Enforced semantic invariants

Deterministic behavior

Verified historic logic alignment

6. Activation Clause

Under CEO authority and VEGA certification, IoS-007 is now fully ACTIVE, with status:

PRODUCTION_CANONICAL

This module forms part of FjordHQâ€™s operating law.
Any modification requires a full ADR-004 migration and G1â†’G4 recertification.

7. Signatures

CEO â€” FjordHQ Market System
Name: [User]
Signature: _______________________
Date: 2026-01-01

VEGA â€” Tier-1 Governance & Compliance
Signature: Digitally Certified
Chain Reference: HC-IOS007-G4-SEAL-2026

STIG â€” CTO (Technical Attestation)
Signature: Verified
Infrastructure State: CLEAN + LOCKED

8. Certificate Storage

Stored at:
05_GOVERNANCE/CERTIFICATES/CERT-IOS007-G4-PROD-2026.json

Mirrored in:
fhq_meta.certificates

Hash:
a824d2fe8f...91b0ce4ea1c9bb41c2f50eb
IoS-007 â€” ALPHA GRAPH ENGINE: CAUSAL REASONING CORE Canonical Version: 2026.PROD.G0Owner: FINN (Tier-1 Research)Validator: IoS-005 (Causal Audit)Governance: VEGA (Tier-1 Compliance)Execution: CODE (EC-011)Dependencies: IoS-001, IoS-003, IoS-006, ADR-054Status: DRAFT FOR G01. STRATEGIC MISSION"From Correlation to Causality."Existing layers (IoS-001 to IoS-006) produce isolated signals. They tell us what happened.IoS-007 explains why it matters.The mission of the Alpha Graph is to model the Transmission Mechanism of the market:How does a liquidity shock in IoS-006 propagate to a Regime Shift in IoS-003?How does a Regime Shift impact Asset Volatility in IoS-001?What is the conditional probability of a crash given current Macro + Sentiment?IoS-007 transforms FjordHQ from a reactive system to a reasoning system.2. THE NODE UNIVERSE (INPUT CONTRACT)To prevent "Graph Entropy" (noise), the Graph allows only Canonical Nodes derived from validated IoS modules.2.1 Macro Nodes (Source: IoS-006)NODE_LIQUIDITY: GLOBAL_M2_USD (The Fuel).NODE_GRAVITY: US_10Y_REAL_RATE (The Friction).Constraint: No other macro variables allowed without G3 Audit & VEGA Attestation.2.2 Regime Nodes (Source: IoS-003)STATE_BTC: Current HMM State (e.g., STRONG_BULL, NEUTRAL).STATE_ETH: Current HMM State.STATE_SOL: Current HMM State.2.3 Asset Nodes (Source: IoS-001)ASSET_BTC: Price, Volatility, Volume.ASSET_ETH: Price, Volatility, Volume.ASSET_SOL: Price, Volatility, Volume.2.4 Future Nodes (Reserved for IoS-009)NODE_SENTIMENT: Narrative Intensity.NODE_RISK: Systemic Stress Level.3. THE EDGE ONTOLOGY (RELATIONSHIPS)We define specific edge types to model directionality and impact type. Correlation is not enough; we need Mechanics.Edge TypeDirectionMeaningExampleLEADS$A \to B$Temporal precedence (Lagged causality)Liquidity $\to$ BTC PriceINHIBITS$A \dashv B$Inverse pressure / DampeningReal Rates $\dashv$ Risk AppetiteAMPLIFIES$A \Rightarrow B$Regime reinforcementStrong Bull Regime $\Rightarrow$ VolatilityCOUPLES$A \leftrightarrow B$Sympathetic movementBTC $\leftrightarrow$ ETHBREAKS$A \nrightarrow B$Decoupling eventBTC Decoupling from SPX4. FUNCTIONAL ARCHITECTURE4.1 The Graph Builder (Ingest Layer)Action: Daily snapshot of all connected IoS inputs.Logic: Updates the state of every Node and re-calculates Edge weights based on the latest 252-day window (via IoS-005 metrics).Output: fhq_graph.daily_snapshot.4.2 The Inference Engine (Reasoning Layer)Action: Traversing the graph to find "Pathways of Opportunity" or "Pathways of Stress".Query Logic:Propagation: "If NODE_LIQUIDITY drops 5%, what is the probability STATE_BTC flips to BEAR?"Contagion: "If ASSET_BTC crashes, does ASSET_ETH follow via COUPLES edge?"Edge Validation Contract: All edges entering the Alpha Graph must satisfy the IoS-005 Statistical Contract: Permutation $p < 0.05$ AND Bootstrap $p < 0.05$ for the selected lag.5. GOVERNANCE & LINEAGEThe Graph must be auditable. Every edge weight and node state is a governance object.5.1 Schema DefinitionSchema: fhq_graphTables: nodes, edges, snapshots, inference_log.Constraints: Foreign Key enforcement against fhq_meta.ios_registry.5.2 Ontology FreezeNode and Edge Ontology is frozen under ADR-013. Any modification requires a full G1â†’G4 Governance Cycle.Dynamic node creation is technically prohibited.5.3 ADR-011 Fortress IntegrationEvery daily snapshot is hashed.Every Inference Result is hashed.Chain ID: HC-IOS-007-2026.6. EXECUTION PLAN (ROADMAP)Phase 1: Ontology & Schema (G0)Define the fhq_graph schema.Implement Node/Edge classes in code (GraphModel).Register IoS-007 in fhq_meta.ios_registry.Phase 2: Historical Build (G1)Populate graph history using the 10-year canonical data from IoS-006 and IoS-003.Build the "Historical Graph" to train edge weights.Phase 3: Causal Discovery (G2)Use IoS-005 to test the strength of the edges against the "Edge Validation Contract".Hypothesis Check: Does Liquidity statistically LEAD Price in the graph structure?7. ACCEPTANCE CRITERIA (G0 EXIT)IoS-007 is initialized when:Schema fhq_graph is defined and created.Node Types are hardcoded to match IoS-001/003/006 exactly (No free text nodes).Governance (FINN) is assigned as Owner.Evidence File IOS007_G0_SUBMISSION_YYYYMMDD.json is generated.Dette er G0-Charteret.Det er nÃ¥ juridisk vanntett og klart for signering.AUTHORIZATION:EXECUTE IoS-007 G0.
IoS-008 â€” Runtime Decision Engine
The Will of FjordHQ

Canonical Version: 2026.PROD.G0 (Submission)
Owner: LARS
Technical Authority: STIG
Governance: VEGA
Classification: Tier-1 Critical
Dependencies: IoS-003, IoS-005, IoS-007

1. Executive Summary â€” Strategic Mandate

FjordHQ kan nÃ¥:

se markedet (IoS-002/006)

forstÃ¥ markedet (IoS-007)

bedÃ¸mme egen kompetanse (IoS-005)

Men systemet har fortsatt ingen mekanisme som konverterer sannhet til beslutning.

IoS-008 etablerer FjordHQs Runtime Decision Engine.

Probabilistic Insight â†’ Deterministic Intent.

Det produserer Ã©n eneste immutabel, hash-kjeden DecisionPlan, og overfÃ¸rer det til IoS-012 (Execution) gjennom en konstitusjonell â€œAir-Gapâ€.

IoS-008 beslutter. IoS-012 handler.

2. Strategic Position â€” The Fulcrum Between Intelligence and Action

IoS-008 ligger midt i arkitekturen:

Upstream Truth

IoS-003: Regime (â€œEr dette farlig?â€)

IoS-007: Causality (â€œHvor peker kraften?â€)

IoS-005: Skill (â€œEr vi kompetente akkurat nÃ¥?â€)

IoS-008: The Decider

syntetiserer, vekter, filtrerer

produserer Ã©n beslutning, deterministisk og revisjonsbar

Downstream Action

IoS-012 kan kun handle pÃ¥ signerte DecisionPlans

Zero Other Inputs allowed

3. Functional Architecture â€” Pure Deterministic Logic

IoS-008 er en stateless, deterministisk funksjon.
Null intern tilstand. Null hukommelse. Null drift.

3.1 The Trinity Requirement â€” Three Green Lights
Input Layer	Component	Question	Role
IoS-003	Regime	â€œIs this safe?â€	Gatekeeper (Veto)
IoS-007	Causal Graph	â€œIs the wind aligned?â€	Directional Driver
IoS-005	Skill Score	â€œAre we competent today?â€	Risk Damper

Alle tre mÃ¥ vÃ¦re gyldige.
Manglende input = NO_DECISION.

3.2 Deterministic Allocation Formula
ð´
ð‘™
ð‘™
ð‘œ
ð‘
=
ðµ
ð‘Ž
ð‘ 
ð‘’
Ã—
ð‘…
ð‘’
ð‘”
ð‘–
ð‘š
ð‘’
ð‘†
ð‘
ð‘Ž
ð‘™
ð‘Ž
ð‘Ÿ
Ã—
ð¶
ð‘Ž
ð‘¢
ð‘ 
ð‘Ž
ð‘™
ð‘‰
ð‘’
ð‘
ð‘¡
ð‘œ
ð‘Ÿ
Ã—
ð‘†
ð‘˜
ð‘–
ð‘™
ð‘™
ð·
ð‘Ž
ð‘š
ð‘
ð‘’
ð‘Ÿ
Alloc=BaseÃ—RegimeScalarÃ—CausalVectorÃ—SkillDamper
RegimeScalar Model (Strategic Correction Applied)

To strategier stÃ¸ttes â€“ mÃ¥ defineres av CEO ved G1:

A. Long-Only (Capital Preservation Mode)

RegimeScalar =

STRONG_BULL: 1.0

NEUTRAL: 0.5

BEAR: 0.0

BROKEN: 0.0

Resultat: BEAR â†’ 0 betyr Cash, ikke Short.
Systemet beskytter kapital, men genererer ikke short-alpha.

B. Long/Short (Full Alpha Mode â€” RECOMMENDED)

RegimeScalar =

STRONG_BULL: 1.0

NEUTRAL: 0.5

BEAR: 1.0

BROKEN: 0.0

Resultat:
BEAR beholder 1.0, slik at negative CausalVector gir short-signal.
Dette matcher allerede genererte signaler:

BTC: -50%

Likviditet: contracting

CausalVector < 1

Dette er den korrekte konfigurasjonen for FjordHQs mÃ¥lsetning.

CausalVector

Basert pÃ¥ signerte edge strengths i IoS-007:

Liquidity â†‘ â†’ Causal > 1

Liquidity â†“ â†’ Causal < 1

SkillDamper (IoS-005)

Kapitalbeskyttelsesfunksjon:

FSS â‰¥ 0.6 â†’ Normal sizing

0.4 â‰¤ FSS < 0.6 â†’ LineÃ¦r reduksjon i sizing

FSS < 0.4 â†’ Alloc = 0 (Capital Freeze)

Systemet kutter seg selv ned nÃ¥r det mister presisjon.

4. DecisionPlan â€” Constitutional Output Artifact

The only instruction IoS-012 may execute.

Fullt revidert for TTL-kravet ditt:

{
  "decision_id": "UUID-v4",
  "timestamp": "2026-05-12T14:30:00Z",
  "valid_until": "2026-05-12T14:35:00Z",   // NEW: TTL/expiry
  "context_hash": "SHA256(Inputs_Snapshot)",

  "global_state": {
    "regime": "BULL_TRENDING",
    "defcon_level": 4,
    "system_skill_score": 0.82
  },

  "asset_directives": [
    {
      "asset_canonical_id": "BTC-PERP.BINANCE",
      "action": "ACQUIRE",
      "target_allocation_bps": 2500,
      "leverage_cap": 1.5,
      "risk_gate": "OPEN",
      "rationale": "Regime=BULL, Causal=LIQUIDITY_EXPANDING, Skill=HIGH."
    }
  ],

  "governance_signature": "Ed25519_Signature(IoS-008)"
}

TTL Enforcement

IoS-012 mÃ¥ avvise enhver plan der:

current_time > valid_until


Dette er en livsviktig sikkerhetsfunksjon i volatile markeder.

5. Governance Constraints
5.1 Read-Only Mandate

IoS-008 kan ikke skrive upstream.

5.2 No-Execution Rule

IoS-008 fÃ¥r aldri:

holde API-nÃ¸kler

kontakte bÃ¸rser

sende ordre

Brudd â†’ Type A Governance Violation.

5.3 Decision Logging

Alle planer mÃ¥:

hash-kjedes

signeres

lagres i fhq_governance.decision_log

Uten dette â†’ plan ugyldig.

6. G0â†’G4 Roadmap
G1: Logic Core

Implement compute_decision_plan().

G2: Historical Replay

Simulere mot 10 Ã¥rs data.

G3: Handover

IoS-012 interface + VEGA schema validation.

G4: Constitutional Activation

Ed25519 signering + immutability.

7. Immediate Actions
STIG

Opprett fhq_governance.decision_log

Legg inn TTL-feltet valid_until

GjennomfÃ¸r append-only + hash-chain (ADR-011)

FINN

Definer RegimeScalar table (inkl. CHOPPY, MICRO_BULL)

Lever en gyldig CausalVector-normalisering

LARS

Lever full SkillDamper-kurve
# IoS-008 â€” Runtime Decision Engine

**Canonical Version:** 2026.PROD.G0
**Status:** ACTIVE (G0 Complete)
**Owner:** LARS (Strategy)
**Technical Authority:** STIG (CTO)
**Governance:** VEGA
**Classification:** Tier-1 Critical

---

## 1. Executive Summary

IoS-008 is the **Will** of FjordHQ.

It converts probabilistic insight into deterministic intent:

```
Sensing (IoS-002/006) â†’ Reasoning (IoS-007) â†’ Self-Awareness (IoS-005) â†’ DECISION (IoS-008)
```

IoS-008 produces ONE immutable, hash-chained `DecisionPlan` and transmits it to IoS-012 (Execution) through a constitutional "Air-Gap".

**IoS-008 decides. IoS-012 acts.**

---

## 2. The Trinity Requirement

Three green lights required for any decision:

| Input | Component | Question | Role |
|-------|-----------|----------|------|
| IoS-003 | Regime | "Is this safe?" | Gatekeeper (Veto) |
| IoS-007 | Causal Graph | "Is the wind aligned?" | Directional Driver |
| IoS-005 | Skill Score | "Are we competent today?" | Risk Damper |

Missing input = `NO_DECISION`

---

## 3. The Formula

```
Alloc = Base Ã— RegimeScalar Ã— CausalVector Ã— SkillDamper
```

### 3.1 RegimeScalar (G0 Configuration)

| Regime | Scalar | Mode |
|--------|--------|------|
| STRONG_BULL | 1.0 | LONG_ONLY |
| BULL | 0.8 | LONG_ONLY |
| RANGE_UP | 0.6 | LONG_ONLY |
| NEUTRAL | 0.5 | LONG_ONLY |
| MICRO_BULL | 0.4 | LONG_ONLY |
| RANGE_DOWN | 0.3 | LONG_ONLY |
| PARABOLIC | 0.25 | LONG_ONLY |
| CHOPPY | 0.2 | LONG_ONLY |
| **BEAR** | **0.0** | Capital Preservation |
| **STRONG_BEAR** | **0.0** | Capital Preservation |
| **BROKEN** | **0.0** | System Anomaly |

**G0 Rationale:** Validate engine with Capital Preservation first. Short logic enabled in G2.

### 3.2 CausalVector

Normalized sum of edge strengths from IoS-007:
- Liquidity â†‘ â†’ Causal > 1
- Liquidity â†“ â†’ Causal < 1
- Range: [0.5, 2.0]

### 3.3 SkillDamper

| FSS Range | Damper | State |
|-----------|--------|-------|
| 0.0 - 0.4 | 0.0 | FREEZE (Capital Freeze) |
| 0.4 - 0.5 | 0.25 | REDUCED |
| 0.5 - 0.6 | 0.5 | CAUTIOUS |
| 0.6 - 0.8 | 1.0 | NORMAL |
| 0.8 - 1.0 | 1.0 | HIGH |

System cuts itself down when it loses precision.

---

## 4. DecisionPlan Schema

```json
{
  "decision_id": "UUID-v4",
  "timestamp": "2026-05-12T14:30:00Z",
  "valid_until": "2026-05-12T14:45:00Z",
  "context_hash": "SHA256(Inputs_Snapshot)",

  "global_state": {
    "regime": "BULL_TRENDING",
    "defcon_level": 4,
    "system_skill_score": 0.82
  },

  "asset_directives": [
    {
      "asset_canonical_id": "BTC-PERP.BINANCE",
      "action": "ACQUIRE",
      "target_allocation_bps": 2500,
      "leverage_cap": 1.5,
      "risk_gate": "OPEN",
      "rationale": "Regime=BULL, Causal=LIQUIDITY_EXPANDING, Skill=HIGH."
    }
  ],

  "governance_signature": "Ed25519_Signature(IoS-008)"
}
```

### TTL Enforcement (IRONCLAD)

IoS-012 MUST reject any plan where:
```
current_time > valid_until
```

Maximum TTL: 15 minutes.

---

## 5. Database Schema

### Tables Created

| Table | Purpose |
|-------|---------|
| `fhq_governance.decision_log` | Append-only decision audit trail |
| `fhq_governance.regime_scalar_config` | Regime â†’ Scalar mapping |
| `fhq_governance.skill_damper_config` | FSS â†’ Damper curve |
| `fhq_governance.decision_sequence` | Hash chain tracker |

### Functions

| Function | Purpose |
|----------|---------|
| `compute_decision_plan(asset_id, base_alloc)` | Deterministic decision computation |

---

## 6. Governance Constraints

### 6.1 Read-Only Mandate
IoS-008 cannot write upstream (IoS-003, IoS-005, IoS-007).

### 6.2 No-Execution Rule
IoS-008 may NEVER:
- Hold API keys
- Contact exchanges
- Send orders

Violation = Type A Governance Violation

### 6.3 Decision Logging
All plans must:
- Be hash-chained
- Be signed (Ed25519)
- Be stored in `fhq_governance.decision_log`

Without this â†’ plan invalid

---

## 7. Gate Status

| Gate | Status | Date | Notes |
|------|--------|------|-------|
| G0 | âœ… COMPLETE | 2025-12-01 | Schema + Logic deployed |
| G1 | PENDING | - | Logic Core validation |
| G2 | PENDING | - | Historical Replay (10yr) |
| G3 | PENDING | - | IoS-012 Handover |
| G4 | PENDING | - | Constitutional Activation |

---

## 8. Dependencies

| Upstream | Purpose |
|----------|---------|
| IoS-003 | Regime classification |
| IoS-005 | Skill score / calibration |
| IoS-007 | Causal graph edges |

| Downstream | Purpose |
|------------|---------|
| IoS-012 | Execution (receives DecisionPlans) |

---

## 9. Migration History

| Migration | Date | Description |
|-----------|------|-------------|
| 051_ios008_runtime_decision_engine.sql | 2025-12-01 | G0 Foundation |

---

*"Probabilistic Insight â†’ Deterministic Intent"*

**The Will of FjordHQ.**
IoS-009 â€” Meta-Perception Layer

The Intent & Stress Brain of FjordHQ

Field	Value
Canonical Version	2026.PROD.G0
Status	SUBMISSION (G0)
Owner	LARS (Chief Strategy Officer)
Technical Authority	STIG (CTO)
Governance	VEGA (Compliance)
Dependencies	IoS-007 (Alpha Graph), ADR-063, ADR-064
Classification	Tier-1 Critical (Perception Brain)
1. Executive Summary

Strategic Mandate
FjordHQ now has:

Causal Reasoning (IoS-007 Alpha Graph)

Deterministic Decision Logic (IoS-008 Runtime Decision Engine)

What it does not yet have is a Meta-Perception Brain â€“ a layer that asks:

Is the market calm or stressed?

Is â€œintentâ€ shifting before price moves?

Are we operating in a normal regime, or in a reflexive feedback loop?

IoS-009 is that layer.

IoS-009 Meta-Perception Layer turns raw signals and causal structure into a PerceptionSnapshot:

â€œWhat does the market intend to do, and how stressed is the system?â€

This layer does not trade, does not rebalance, and does not write to core market tables. It creates auditable perception artifacts that higher layers (IoS-008, IoS-010, IoS-012) can use to:

tighten risk,

override exposure,

or step aside when uncertainty is too high.

Key transformation (G0 scope):

Raw features â†’ PerceptionSnapshot â†’ IntentReport / ShockReport / OverrideSignals

G0 explicitly documents that the current implementation is a generic, self-contained Meta-Perception engine.
Actual wiring to FjordHQ schemas (fhq_*) and Vision-IoS modules will happen in G1+ under VEGA supervision.

2. Strategic Position in the Architecture

IoS-009 sits between the Alpha Graph and the Runtime Decision Engine.

graph LR
  subgraph "CAUSAL & STRUCTURAL LAYERS"
    G7[IoS-007: Alpha Graph<br/>Causal Structure]
  end

  subgraph "META-PERCEPTION LAYER"
    G9[IoS-009: Meta-Perception<br/>Intent & Stress Brain]
  end

  subgraph "DECISION & EXECUTION"
    G8[IoS-008: Decision Engine]
    G12[IoS-012: Execution Controller]
  end

  G7 --> G9
  G9 --> G8
  G8 --> G12


Upstream:

IoS-007 provides causal features, regimes, and structural context.

ADR-063/ADR-064 define the event and perception taxonomy (PERCEPTION.*).

IoS-009 (this module):

Computes entropy, intent, shocks, reflexivity, uncertainty.

Emits PerceptionSnapshot + diagnostic artifacts.

Downstream:

IoS-008 uses PerceptionSnapshot and OverrideSignals to shape allocation and risk.

IoS-010 uses PerceptionSnapshot as input to scenario generation.

IoS-012 can receive PERCEPTION.* events for execution filters (e.g. â€œno new risk under Stress Level 5â€).

G0 explicitly records logical position and contracts, while implementation is currently generic and repository-local.

3. Functional Scope (G0)
3.1 What IoS-009 Does (Functionally)

The current implementation (branch claude/fjord-meta-perception-plan-01PsGioiNK8LwGd8inSNN9Sb, commit 8297f15) provides:

Core Perception Algorithms (pure functions)

entropy.py â€“ market information entropy

noise.py â€“ noise-to-signal evaluation

intent.py â€“ Bayesian intent inference

reflexivity.py â€“ decisionâ€“market feedback correlation

shocks.py â€“ information shock detection

regime.py â€“ regime pivot / transition detection

uncertainty.py â€“ aggregate uncertainty score

state.py â€“ PerceptionState construction

Orchestration

step.py â€“ single step(inputs) â†’ PerceptionSnapshot orchestrator

Diagnostics & Explainability

DiagnosticLogger â€“ numeric trace logging of each stage

Feature-level contributions (which inputs drove which conclusions)

Feature Importance

FeatureImportance â€“ global and per-module importance ranking

Uncertainty Override Engine

UncertaintyOverride â€“ detects when uncertainty surpasses thresholds and emits OverrideSignals (e.g. kill/reduce risk).

Stress Scenario Simulator

StressScenarios â€“ 6 predefined perception stress scenarios (flash crash, liquidity shock etc.)

Artifacts & Serialization

ArtifactManager â€“ JSON / JSONL serialization of:

perception_snapshot.json

intent_report.json

shock_report.json

entropy_report.json

feature_importance_report.json

uncertainty_override_log.jsonl

STIG Adapter (Read-Only)

STIGAdapterAPI â€“ minimal API for STIG to retrieve PerceptionSnapshot and artifacts.

No business logic inside the adapter.

3.2 What IoS-009 Does Not Do (by Design, G0)

Does not place trades

Does not change allocations

Does not write to fhq_* schemas

Does not maintain internal mutable state

Does not use LLMs, embeddings, or online-learning models

This is critical: IoS-009 v1.0 as implemented is a self-contained, pure analytical layer.
All coupling to Vision-IoS and FjordHQ data is postponed to later gates.

4. Implementation Reference (G0 â€“ Actual Code vs Spec)

Directory Structure (as implemented):

meta_perception/
â”œâ”€â”€ models/          # 13 frozen Pydantic v2 models
â”œâ”€â”€ core/           # 8 pure perception algorithms (entropy, noise, intent, etc.)
â”œâ”€â”€ orchestration/  # step() orchestration
â”œâ”€â”€ diagnostics/    # DiagnosticLogger
â”œâ”€â”€ importance/     # FeatureImportance
â”œâ”€â”€ overrides/      # UncertaintyOverride
â”œâ”€â”€ simulation/     # Stress scenarios (6)
â”œâ”€â”€ artifacts/      # ArtifactManager (JSON/JSONL)
â”œâ”€â”€ adapters/       # STIGAdapterAPI (read-only)
â”œâ”€â”€ utils/          # math, validation, profiling
â”œâ”€â”€ tests/          # unit + integration + scenario tests
â”œâ”€â”€ config/         # default_config.yaml
â””â”€â”€ README.md


Alignment with Planned Roadmap:

Roadmap Component	Implemented Element	Alignment
Information Entropy Engine	core/entropy.py	âœ…
Noise / Stress Engine	core/noise.py	âœ…
Intent Detection	core/intent.py	âœ…
Reflexivity Engine	core/reflexivity.py	âœ…
Shock Detector	core/shocks.py	âœ…
Regime Pivot Detector	core/regime.py	âœ…
Uncertainty Aggregator	core/uncertainty.py	âœ…
Meta-Perception State	core/state.py + models/*	âœ…
Meta-Brain Orchestrator	orchestration/step.py	âœ…
Feature Importance Engine	importance/	âœ…
Uncertainty Override Engine	overrides/	âœ…
Stress Scenario Simulator	simulation/	âœ…
Artifact Serialization	artifacts/	âœ…
STIG Integration (Read-only)	adapters/STIGAdapterAPI	âœ…

Critical G0 Clarification

The current IoS-009 implementation is not yet wired to:

fhq_* schemas (fhq_data, fhq_research, fhq_monitoring, etc.)

IoS-007 live graph snapshots in the database

IoS-008 or IoS-010 runtime pipelines

Instead, it operates on generic, in-memory input structures defined in its own models/ and config/.

Any usage in Vision-IoS requires:

A mapping layer from fjord data (fhq_*) to IoS-009 input models

A controlled integration into the runtime loop via STIG and VEGA-approved adapters

This is intentional and must be explicitly recorded here.

5. Data Contracts & Integration (Logical, not Physical in G0)
5.1 Logical Inputs (Conceptual Contract)

IoS-009 expects, at the logical level:

Recent market features (prices, liquidity, volatility, etc.)

Causal features and regimes from IoS-007

Event / taxonomy labels defined via ADR-063/ADR-064 (PERCEPTION.*, SHOCK.*, STRESS.*)

In G0:

These inputs are provided via local models and config, not via live database calls.

Adapters to actual tables (fhq_market.*, fhq_research.*, fhq_monitoring.*) are not implemented yet and must be introduced only at G1+.

5.2 Logical Outputs

IoS-009 standardizes the following artifacts:

PerceptionSnapshot â€“ The full meta-perception state (entropy, intent, stress, overrides)

IntentReport â€“ Interpretable view of perceived market intent

ShockReport â€“ Active and historical shocks

EntropyReport â€“ Information density / randomness

FeatureImportanceReport â€“ Which features drove which perception

UncertaintyOverrideSignals â€“ Flags that can be consumed by IoS-008/IoS-010/IoS-012

In G0:

All artifacts are written to local artifact directories (e.g. artifacts_output/), not to fhq_*.

6. CRITICAL GOVERNANCE CHECK (G0 Reality + Future Constraint)

This section is updated to match what the code actually does today, and what must remain true when integrated into FjordHQ.

6.1 Current Implementation (as of commit 8297f15)

Do any modules write to a database?
â†’ No.
All current outputs are in-memory objects and JSON/JSONL artifacts on disk. There are no calls to fhq_* schemas, nor to Vision-IoS Postgres.

Do any modules call STIG for state-mutating operations?
â†’ No.
STIGAdapterAPI is read-only, designed to expose perception artifacts to STIG. It does not contain business logic and does not submit write operations.

Any stateful ML (embeddings, LLMs, online learning)?
â†’ None.

No LLMs

No embeddings

No streaming or online learning
All logic is deterministic numerical computation.

Any temporal nondeterminism?
â†’ None internally.

No internal random number usage (or randomness is seeded and fixed in tests).

No internal wall-clock reads in core logic.

Any timestamps are expected to be injected from the outside, not generated internally.

This matches the actual codebase and must be preserved.

6.2 Required Constraints When Adapting to FjordHQ (Future Gates)

When IoS-009 is wired into Vision-IoS (G1+), the following must be enforced:

DB Access Pattern

IoS-009 must remain read-only with respect to fhq_* schemas.

Any write operations (if ever introduced) must go through dedicated, VEGA-approved writers outside IoS-009.

STIG Integration

STIGAdapterAPI remains read-only.

All state changes triggered by perception (e.g. risk-kill signals) must flow via:
PerceptionSnapshot â†’ IoS-008/IoS-010 â†’ IoS-012 / governance modules, never directly from IoS-009.

No Embedded LLM / SEAL Logic in IoS-009 Core

Any future SEAL or LLM-based enhancements must sit in separate IoS modules or adapters, not in the IoS-009 core.

IoS-009 remains a deterministic, inspectable, numeric perception engine.

Time & Randomness Discipline

All timestamps, market times, and seeds to be injected from upstream (STIG/LINE), never decided internally.

This ensures reproducible perception for audit and replay.

G0â€™s job is to record these constraints explicitly, given that the current implementation is a generic foundation that will later be adapted.

7. G0 Scope & Limitations

To avoid any ambiguity in future audits:

IoS-009 does exist as a working, tested, deterministic Meta-Perception Engine in the codebase.

IoS-009 does not yet exist as a fully wired Vision-IoS module bound to fhq_* schemas and IoS-007 runtime data.

G0 Declares:

The logic and architecture of IoS-009 are in place.

The current implementation is environment-neutral and not yet integrated with FjordHQâ€™s production database or runtime orchestration.

Any integration work (G1, G2, G3, G4) must:

Respect the governance constraints above

Map clearly from fhq_* tables and IoS-007 artifacts to IoS-009 models

Be captured in migration scripts, test plans, and VEGA-reviewed evidence bundles.

8. Submission Decision (G0)

IoS-009 Meta-Perception Layer is ready to be registered in the FjordHQ IoS registry as:

Status: G0_SUBMITTED

Type: PERCEPTION_BRAIN

Implementation Basis: meta_perception/ (commit 8297f15)

Integration Status: NOT_BOUND_TO_FHQ_DB

This submission is intentionally conservative:
It recognizes the strength of the existing code, but does not pretend that it is already fully integrated with Vision-IoS.
IoS-009 â€“ Constitution Addendum G1

Version: 2026.PROD.G1
Status: SUBMITTED FOR REGISTRATION
Owner: LARS (CSO)
Technical Authority: STIG (CTO)
Governance: VEGA
Dependencies: ADR-019, ADR-013, IoS-007, IoS-008
Classification: Tier-1 Constitutional Augmentation

1. Purpose of Addendum G1

This addendum establishes the Human Oracle Interface for IoS-009, enabling the CEO to inject Narrative Vectors (NVs) into the Meta-Perception Layer with controlled Bayesian influence.

G1 defines:

The canonical schema for narrative input

The Bayesian Prior Adjustment Vector (BPAV) transformation

A mandatory Half-Life Decay Mechanism to prevent Zombie-Signals

Governance rules for how human intuition interacts with IoS-009

This upgrade operationalizes ADR-019 while preserving full system integrity under ADR-013 and ADR-010.

2. The Human Oracle Channel

Narrative Vectors are treated as probabilistic priors, not commands.
They adjustâ€”but never overrideâ€”the causal state produced by IoS-007 and the decision logic of IoS-008.

NV â†’ BPAV â†’ PerceptionSnapshot â†’ IoS-008 â†’ IoS-012

IoS-009 remains fully read-only relative to all fhq_* schemas.

3. Narrative Vector Schema (Updated)

Every human-origin vector MUST follow this schema:

{
  "domain": "regulatory | geopolitical | liquidity | sentiment | reflexivity",
  "probability": float âˆˆ [0,1],
  "confidence": float âˆˆ [0,1],
  "timescale": "intraday | short | medium | structural",
  "half_life_hours": int > 0,
  "signature_id": <Ed25519 signature>,
  "submitted_by": <role>,
  "timestamp": <UTC>
}

3.1 Justification for Half-Life

Without decay, NVs become persistent distortions ("Zombie-Signals").
Decay ensures the system naturally returns to machine-derived equilibrium unless renewed by the Operator.

4. Bayesian Prior Adjustment Vector (BPAV)
4.1 Computation
base_weight = probability Ã— confidence
effective_weight(t) = base_weight Ã— exp(-t / half_life_hours)

4.2 Integration Rules

BPAV adjusts perception metrics but cannot directly alter allocations

BPAV acts as a soft prior influencing:

Intent inference

Reflexivity analysis

Shock sensitivity

Uncertainty weighting

4.3 Safety Properties

Time-bounded

Non-deterministic override impossible

Fully auditable under VEGA

5. Governance Requirements

All NVs must be Ed25519-signed (ADR-008)

IoS-009 may never mutate state

IoS-012 must not consume NVs directly; only via PerceptionSnapshot

Expired NVs must auto-expire according to half-life decay

VEGA may veto NV ingestion if:

Domain is mis-typed

Probability is extreme (0 or 1 without justification)

Signature invalid

Timestamp drift detected

6. G1 Exit Criteria (Required for Promotion)
Criterion	Required	Purpose
NV Schema validated	âœ“	Prevent malformed priors
Decay logic implemented	âœ“	Zombie-signal protection
BPAV transformation tested	âœ“	Mathematical stability
Read-only guarantee	âœ“	Constitutional compliance
VEGA validation logs	âœ“	Audit trail requirements
Integration contract with IoS-008	âœ“	Downstream safety
7. Result

Upon G1 approval, IoS-009 becomes the conscious perception layer of FjordHQ, combining machine-derived causal intelligence with human probabilistic insightâ€”without compromising system autonomy or execution integrity.

CEO Directive: Register IoS-009 Addendum G1

DIRECTIVE ID: IOS-009_G1_REGISTRATION_20251128
AUTHORITY: CEO â†’ LARS â†’ STIG
OVERSIGHT: VEGA
TARGET: fhq_meta.ios_registry

TO: STIG (CTO)

Execute the following:

Update IoS-009 Registry Entry

version â†’ â€œ2026.PROD.G1â€

status â†’ â€œG1_SUBMITTEDâ€

description â†’ â€œMeta-Perception Layer Addendum G1: Human Oracle Channel, BPAV, Half-Life Mechanism.â€

governing_adrs += { â€œADR-019â€ }

hash content from updated file and store in content_hash

Log Governance Event

action_type: â€œIOS_MODULE_UPDATEâ€

target_id: â€œIoS-009â€

decision: â€œSUBMITTED_FOR_REVIEWâ€

rationale: â€œAddendum G1 enabling probabilistic human input with decay-tested priorsâ€

Create Hash-Chain Entry

chain_type: â€œIOS_UPDATEâ€

ref: IoS-009.G1

status: â€œPENDING_VEGA_VERIFICATIONâ€

Prepare VEGA Attestation Slot

attestation_type: â€œG1_UPDATEâ€

target_version: â€œ2026.PROD.G1â€

Execute immediately and report upon completion.
IoS-010 â€” PREDICTION LEDGER ENGINE

G0 SUBMISSION â€” Specification & Intent
Owner: FINN (Tier-1 Research)
Validator: LARS (Tier-1 Strategy)
Governance: VEGA (Tier-1 Compliance)
Version: 2026.G0
ADR Alignment: ADR-004, ADR-012, ADR-013, ADR-061
Status: Submitted for G0 Review

1. Executive Intent (Why IoS-010 Exists)

IoS-010 provides the canonical audit layer for all probabilistic forecasts generated within Vision-IoS.
Its mandate is simple and foundational:

Record every forecast with deterministic, hash-verified state context.

Record every realized outcome.

Reconcile forecasts to outcomes using deterministic matching.

Compute calibration, accuracy, and skill metrics.

Produce audit-grade evidence of strategy quality.

In short:
IoS-010 turns raw predictions into measurable truth.
It is the accountability engine required before any autonomous strategy can be authorized under ADR-012 Economic Safety.

2. Scope of G0 (What IoS-010 is, before any activation)

This G0 submission defines the pure logical contract, independent of the database or integration.

Included in scope at G0:

Pydantic models for forecasts, outcomes, pairs, and evaluations
()

Validation logic for forecast and outcome records
()

Deterministic reconciliation engine (timestamp + horizon matching)
()

Evaluation metrics: Brier, calibration, directional accuracy, MAE, skill scores
()

Calibration Curve v1.1
()

Horizon bucket derivation + utility functions
()

JSON serialization logic (pre-DB placeholder)
()

Out of scope at G0 (deferred to G1/G2):

Supabase table creation

Storage migration (file-I/O â†’ DB-I/O)

Governance logging & lineage binding

Full integration test suite

3. Strategic Value (Why this module is required)

IoS-010 provides the measurement layer enabling:

Strategy validation (Sharpe is not enough; we need forecast skill).

Regime model assessment (IoS-003 & IoS-004 depend on it).

Risk committee approvals for autonomous operation (ADR-012).

End-to-end auditability (ADR-013 One-Source-Truth).

Without IoS-010, Vision-IoS cannot:

Prove skill over baseline

Detect model drift

Calculate calibration errors

Demonstrate economic safety

Comply with ADR-012 for autonomous trading

IoS-010 is thus a constitutional prerequisite for autonomy.

4. G0 Deliverables (What is concretely submitted)
4.1 Canonical Models

ForecastRecord

OutcomeRecord

ForecastOutcomePair

EvaluationRecord

CalibrationCurve
(all frozen, immutable models with deterministic schemas)

4.2 Deterministic Engines

Validation Engine

Reconciliation Engine

Evaluation Engine (Brier, MAE, Hit-Rate, Skill)

Calibration Engine v1.1

All logic is pure, side-effect-free, and reproducible.

4.3 Temporary Storage Layer

File-based append-only JSONL storage (ADR-061 compliance placeholder).
To be replaced entirely in G1.

5. Required DB Schema for G1 Migration

(For VEGA & STIG â€” not executed at G0)

Tables needed:

fhq_research.forecasts

fhq_research.outcomes

fhq_research.forecast_outcome_pairs

fhq_research.evaluations

fhq_research.calibration_curves

Each row must include:

deterministic primary keys

SHA256 input_state_hash

horizon buckets

target_type (FK â†’ IoS-001 registry)

metadata JSONB

canonical timestamping (ADR-013)

This schema design is required for elevation to G1.

6. Governance Requirements

IoS-010 SHALL NOT advance to G1 without:

Formal Supabase schema migration scripts

ADR-013 lineage guarantees

ADR-012 economic-safety integration points

End-to-end reconciliation tests (VEGA bundle)

Zero conflict with existing IoS-* modules

G0 confirms intent, not implementation.

7. Risks Identified at G0

File-based storage violates ADR-013 if left beyond G1

Potential mismatch between target_type and IoS-001 registry

Reconciliation rules require strict temporal alignment (Â±6h)

Large-scale evaluations may require batching for performance

No integrity checks yet on scenario-set forecasting pipelines

These are acknowledged and deferred to G1/G2.

8. G0 Decision Request

The module satisfies all requirements for G0 Submission under ADR-004:

Clearly defined purpose

Clearly defined boundaries

Zero side effects

Fully reversible

No constitutional impact

Requested decision:
VEGA to record G0_SUBMITTED â†’ forward IoS-010 to G1 Technical Validation.

C-Level Summary

IoS-010 is the truth layer that converts predictions into metrics, accountability, and skill measurement.
Without it, Vision-IoS cannot prove its Alpha engine works.

G0 submission confirms the architecture.
G1â€“G3 will make it real.
G4 will make it constitutional.
IoS-011 â€” TECHNICAL ANALYSIS PIPELINE

Canonical Version: 2026.G0
Status: G0_SUBMITTED
Owner: FINN (Tier-1 Research)
Validator: LARS (Strategy)
Governance: VEGA
Dependencies: IoS-001, IoS-002, IoS-003
ADR Alignment: ADR-004, ADR-012, ADR-013, ADR-051

1. Executive Summary (C-Level Purpose)

IoS-011 is the Technical Analysis Pipeline of Vision-IoS.
Its job is not to generate trades.
Its job is to generate clean, deterministic, bias-controlled technical indicators that higher-level engines (IoS-003, IoS-004, IoS-007) can trust.

Most TA systems in the industry suffer from:

look-ahead bias

inconsistent windowing

unbounded indicator sets

drift between sources

mixed granularity data

missing auditability

IoS-011 exists to standardize and sanitize all TA signals used in FjordHQ.

This module produces TA primitives, not trading signals.

2. Mission & Output (What IoS-011 actually does)
IoS-011 converts raw prices into deterministic, auditable indicator sets, such as:

Moving Averages (SMA, EMA, WMA)

MACD / Signal Line / Histogram

RSI (Wilder)

Stochastic Oscillator

ATR

Bollinger Bands

Ichimoku Cloud Components

PSAR

Volatility channels

Rolling percentiles

But with strict constraints:

Identical input = identical output (no randomness)

No look-ahead allowed

No outside data sources

All computation must reference canonical asset registry (ADR-013)

All indicators must be timestamp-aligned with input candles

All output must include lineage (hash of input window)

This transforms TA from â€œnoise-generating hobby indicatorsâ€
â†’ to institutional-grade deterministic features.

3. System Role Within Vision-IoS

IoS-011 feeds only upwards into:

IoS-003 (Meta-Perception / Market Brain)

IoS-004 (Regime Allocation Engine)

IoS-007 (Alpha Graph Engine)

IoS-010 (Prediction Ledger, indirect)

It never feeds directly into IoS-012 (Execution Engine).
It cannot create positions.
It cannot modify exposure.
It cannot bypass governance.

This preserves clean separation of feature generation vs prediction vs execution.

4. Architectural Boundaries (G0 Definition)
Included in G0:

Complete specification of allowable indicators

Standardized computation methods

Required lineage metadata schema

Input contract: OHLCV data from IoS-001

Indicator windowing rules

Deterministic calculation order

Normalization rules

Hashing of input windows

Version control for indicator definitions

Error handling specification

Granularity constraints (1m, 5m, 1h, 1d allowed)

Excluded from G0 (deferred to G1/G2):

Database storage layer

Indicator caching

Incremental backfill logic

Cross-asset indicators

Multi-frequency resampling

Feature selection engine

Integration with IoS-003

G0 defines the contract, not the implementation.

5. Data Contract (Mandatory Under ADR-013)
Input Source:

Canonical OHLCV dataset from IoS-001
(no external feeds, no duplicate data streams)

Required Fields:

asset_id

timestamp

open, high, low, close

volume

data_quality_tag (VEGA enforced)

Output Schema:

For each indicator:

indicator_name

indicator_value

timestamp

asset_id

lookback_window

input_state_hash

computation_version

metadata (optional)

Lineage Requirements:

Every output must be reproducible via:

hash = SHA256(asset_id + timestamp + input_window + indicator_spec)


This guarantees deterministic reconstruction in an audit scenario.

6. Compliance Requirements
6.1 ADR-004 (Change Gates)

IoS-011 must pass G1 Technical Validation before any code is written.

IoS-011 must pass G2 Governance Validation before touching the database.

6.2 ADR-012 (Economic Safety)

IoS-011 cannot generate any signal that directly or indirectly results in capital deployment.
Its output is pure research features.

6.3 ADR-013 (One-Source-Truth)

TA is computed exclusively from IoS-001 data

No external libraries allowed that embed look-ahead behavior

No third-party data sources

No re-sampling unless explicitly authorized

All indicator definitions versioned and immutable

7. Future Progression Path (High-Level Forecast)
G1 â€” Technical Validation

Implement deterministic computation engine

Validate outputs vs reference baseline

Validate boundary behavior (missing candles, outliers)

G2 â€” Governance Validation

Prove lineage integrity

Prove deterministic reproducibility

Prove no accidental future leakage

Register indicator catalogue in canonical registry

G3 â€” Integration

Bind IoS-011 outputs to IoS-003 and IoS-004

Introduce caching layer

Introduce multi-asset batch computation

G4 â€” Constitutional Activation

IoS-011 will not be a constitutional module.
It will remain non-canonical (TRUE: data source), canonical=FALSE.

8. Risk Assessment (C-Level)
Risks Without IoS-011

Regime engines operating on noisy/unreliable features

Different modules using different indicator definitions

Hidden look-ahead bias

TA outputs not reproducible under audit

Drift between Pandas, TA-Lib, NumPy, or custom implementations

Incompatible window definitions across models

Risks With IoS-011 (if poorly governed)

Incorrect normalization destabilizing model training

Drift due to precision differences (float32 vs float64)

Excessive dimensionality (indicator explosion)

Unbounded computation cost if caching is skipped

Feature leakage across asset classes

These are mitigated via VEGA oversight + G1/G2 gates.

9. G0 Decision Request

IoS-011 is ready for G0 registration with:

Fully defined scope

Clear data contract

Deterministic indicator specification

Architectural alignment with IoS-001, 003, 004

Zero side-effects

Fully reversible

Requested decision:
Register IoS-011 as G0_SUBMITTED and forward to G1 Technical Validation when appropriate.

Prepared by:

LARS â€” System Strategy

Approved by:

CEO â€” FjordHQ
# IoS-012-B G1 Addendum: Statistical Defensibility

**Version:** 1.0
**Status:** G1 PREREQUISITE DOCUMENTATION
**Date:** 2026-01-19
**Author:** STIG
**CEO Feedback Reference:** CEO Meta-Analysis 2026-01-19

---

## PURPOSE

This addendum addresses three CEO-identified prerequisites before G1 sign-off:

1. **Formal definition of Inverted Brier Score computation**
2. **Explicit health metric semantics tied to option P&L**
3. **Time-of-regime-change handling**

---

## 1. FORMAL INVERTED BRIER SCORE DEFINITION

### 1.1 The Core Question

> "Is 0.0058 statistically distinct from chance under stress clustering?"

### 1.2 Standard Brier Score Definition

The Brier Score for a single forecast is:

```
Brier = (f - o)Â²

Where:
  f = forecast probability (0 to 1)
  o = outcome (0 or 1)
```

For a set of forecasts:

```
Brier_avg = (1/N) Ã— Î£(f_i - o_i)Â²
```

### 1.3 Inversion Mapping (FROZEN DEFINITION)

**Method: Directional Inversion with Confidence Preservation**

When the system predicts direction D with probability p under STRESS@99%+, the inverted prediction is:

```
Inverted Direction = NOT(D)
Inverted Probability = p  (confidence magnitude preserved)
```

**Critical Clarification:** We do NOT use `p â†’ 1-p` mapping.

The inversion is **directional**, not probabilistic. If the system predicts "UP with 99.71% confidence" and is wrong, the inverted signal is "DOWN with 99.71% confidence."

**Rationale:** The system's confidence level reflects its certainty, which we exploit inversely. The system is certain it knows the direction â€” it's just systematically wrong about WHICH direction.

### 1.4 Inverted Brier Score Computation

For a STRESS@99%+ signal with directional inversion:

```
Original:
  f_original = 0.9971 (probability of predicted direction)
  o = 0 (predicted direction was WRONG)
  Brier_original = (0.9971 - 0)Â² = 0.9942

Inverted:
  f_inverted = 0.9971 (same confidence, opposite direction)
  o_inverted = 1 (inverted direction is CORRECT)
  Brier_inverted = (0.9971 - 1)Â² = 0.0008
```

**Population Statistics (N=37 STRESS@99%+ equity signals):**

| Metric | Value | Computation |
|--------|-------|-------------|
| Mean Original Brier | 0.9942 | Î£(f - 0)Â² / N |
| Mean Inverted Brier | 0.0058 | Î£(f - 1)Â² / N |
| Sample Size | 37 | Equity signals only |
| Hit Rate (Original) | 0.00% | 0/37 |
| Hit Rate (Inverted) | 100% | 37/37 (theoretical) |

### 1.5 Statistical Significance Test

**Null Hypothesis (Hâ‚€):** Inverted hit rate is not different from chance (50%).

**Test:** Binomial exact test

```
n = 37 signals
k = 37 correct (under inversion)
pâ‚€ = 0.50 (chance)

P(X â‰¥ 37 | n=37, p=0.50) = 0.50^37 = 7.28 Ã— 10â»Â¹Â²
```

**Result:** p-value < 0.001. Reject Hâ‚€.

**Conclusion:** The inversion effect is statistically distinct from chance at p < 0.001.

### 1.6 Stress Clustering Consideration

**Concern:** Are the 37 signals temporally clustered, reducing effective sample size?

**Analysis:** The 37 signals span:
- 10 distinct tickers
- Multiple market days
- Various sub-regimes within STRESS

**Effective Independence:** While some clustering exists, the cross-ticker diversity provides sufficient independence. A more conservative estimate using Bonferroni correction for 10 tickers still yields p < 0.01.

### 1.7 Methodology Freeze Declaration

**FROZEN AS OF 2026-01-19:**

| Parameter | Value | Status |
|-----------|-------|--------|
| Inversion Type | Directional | FROZEN |
| Confidence Mapping | Preserved (p â†’ p) | FROZEN |
| Regime Trigger | STRESS | FROZEN |
| Confidence Threshold | â‰¥ 0.99 | FROZEN |
| Asset Class | EQUITY only | FROZEN |
| Universe | 10 canonical tickers | FROZEN |

---

## 2. HEALTH METRIC P&L SEMANTICS

### 2.1 The Core Problem

> "Options spreads require P&L-weighted health, not signal hit-rate alone."

A signal can be directionally correct but still lose money due to:
- Time decay (theta)
- Implied volatility changes (vega)
- Strike selection errors
- Exit timing

### 2.2 Dual-Layer Health Metric (FROZEN DEFINITION)

IoS-012-B will track **TWO** health metrics:

#### Layer 1: Directional Health (Signal Quality)

```sql
Directional_Health = SUM(correct_directions) / COUNT(evaluated_signals)

Where:
  correct_direction = 1 if actual_outcome matches inverted_direction
  correct_direction = 0 otherwise
```

**Threshold:** â‰¥ 80%
**Purpose:** Validates the inversion signal quality
**Action on breach:** Alert LARS, begin investigation

#### Layer 2: P&L Health (Execution Quality)

```sql
PnL_Health = SUM(exit_pnl) / SUM(net_premium_paid)

Where:
  exit_pnl = realized P&L from closed spread
  net_premium_paid = initial capital at risk
```

**Threshold:** â‰¥ 0% (breakeven)
**Purpose:** Validates that correct signals translate to profits
**Action on breach:** Auto-disable module

### 2.3 Combined Health Status Logic

```sql
CASE
  WHEN directional_health < 0.80 THEN 'SIGNAL_DEGRADED'
  WHEN pnl_health < 0 THEN 'EXECUTION_DEGRADED'
  WHEN directional_health >= 0.80 AND pnl_health >= 0 THEN 'HEALTHY'
  ELSE 'INSUFFICIENT_DATA'
END
```

### 2.4 Auto-Disable Conditions

| Condition | Threshold | Lookback | Action |
|-----------|-----------|----------|--------|
| Directional Health | < 80% | 30 days | Alert + Manual Review |
| P&L Health | < 0% (losing money) | 30 days | **AUTO-DISABLE** |
| Combined Signals | < 10 | N/A | Insufficient data |

### 2.5 Database Implementation

```sql
-- Update to fhq_alpha.check_inversion_health()
CREATE OR REPLACE FUNCTION fhq_alpha.check_inversion_health_v2(
    p_lookback_days INTEGER DEFAULT 30
) RETURNS TABLE (
    directional_health NUMERIC,
    pnl_health NUMERIC,
    total_signals INTEGER,
    total_pnl NUMERIC,
    health_status TEXT,
    should_disable BOOLEAN,
    recommendation TEXT
) AS $$
DECLARE
    v_dir_health NUMERIC;
    v_pnl_health NUMERIC;
    v_signals INTEGER;
    v_total_pnl NUMERIC;
BEGIN
    -- Calculate directional health
    SELECT
        COALESCE(SUM(CASE WHEN actual_outcome THEN 1 ELSE 0 END)::NUMERIC /
                 NULLIF(COUNT(CASE WHEN actual_outcome IS NOT NULL THEN 1 END), 0), 0),
        COUNT(*),
        COALESCE(SUM(exit_pnl), 0),
        COALESCE(SUM(exit_pnl) / NULLIF(SUM(net_premium_paid), 0), 0)
    INTO v_dir_health, v_signals, v_total_pnl, v_pnl_health
    FROM fhq_alpha.inversion_overlay_shadow
    WHERE entry_timestamp >= NOW() - (p_lookback_days || ' days')::INTERVAL
      AND exit_pnl IS NOT NULL;

    RETURN QUERY
    SELECT
        v_dir_health,
        v_pnl_health,
        v_signals,
        v_total_pnl,
        CASE
            WHEN v_signals < 10 THEN 'INSUFFICIENT_DATA'::TEXT
            WHEN v_dir_health < 0.80 THEN 'SIGNAL_DEGRADED'::TEXT
            WHEN v_pnl_health < 0 THEN 'EXECUTION_DEGRADED'::TEXT
            ELSE 'HEALTHY'::TEXT
        END,
        v_pnl_health < 0 AND v_signals >= 10,  -- Auto-disable on P&L breach
        CASE
            WHEN v_signals < 10 THEN 'Need minimum 10 closed positions'::TEXT
            WHEN v_pnl_health < 0 THEN 'AUTO-DISABLE: P&L negative over lookback period'::TEXT
            WHEN v_dir_health < 0.80 THEN 'WARNING: Directional accuracy degraded - manual review'::TEXT
            ELSE 'Module performing within parameters'::TEXT
        END;
END;
$$ LANGUAGE plpgsql;
```

---

## 3. REGIME TRANSITION TIMING

### 3.1 The Core Problem

> "If IoS-003 updates regime after market close, spreads may decay into invalid exposure."

### 3.2 Time-Anchored Regime Change Handling (FROZEN DEFINITION)

#### 3.2.1 Regime Update Schedule

| System | Update Time | Granularity |
|--------|-------------|-------------|
| IoS-003 (Perception) | T+0 22:05 UTC | Daily |
| IoS-012-B (Execution) | T+0 22:30 UTC | Daily |

**Gap:** 25 minutes between regime detection and execution check.

#### 3.2.2 Regime Change Exit Rules

```
IF regime_t != regime_t-1 THEN
  EXIT_TRIGGER = TRUE
  EXIT_TYPE = 'REGIME_CHANGE'
  EXIT_WINDOW_START = regime_update_timestamp
  EXIT_WINDOW_END = next_market_open + 30_minutes
```

**Rule:** Regime change triggers exit at **next available market session**, not immediately.

#### 3.2.3 Exposure Validity Windows

| Scenario | Position Status | Action |
|----------|-----------------|--------|
| STRESS â†’ STRESS | VALID | Hold position |
| STRESS â†’ NEUTRAL | INVALID | Exit at next open |
| STRESS â†’ BULL | INVALID | Exit at next open |
| STRESS â†’ BEAR | INVALID | Exit at next open |
| Weekend/Holiday | VALID during market closure | Re-evaluate at open |

#### 3.2.4 Time Anchoring Declaration

**Position Entry Time Anchor:**
```
Entry only valid during market hours (09:30-16:00 ET for US equities)
No entries during pre-market or after-hours
```

**Regime Evaluation Time Anchor:**
```
Regime evaluated at T-0 22:05 UTC (after market close)
Positions entered reflect T-1 regime (previous close)
Exit decisions made before T+1 market open
```

#### 3.2.5 Edge Case: Intraday Regime Shift

IoS-003 does NOT update regime intraday. If an intraday volatility event suggests regime shift:

1. **IoS-012-B does NOT exit mid-session** (no intraday regime updates)
2. **End-of-day evaluation** determines if position remains valid
3. **Next-day exit** if regime has shifted

**Rationale:** Avoiding whipsaw from intraday noise. Regime is a daily-resolution concept in FjordHQ.

---

## 4. SUMMARY: G1 PREREQUISITE STATUS

| Prerequisite | Status | Documentation |
|--------------|--------|---------------|
| Inverted Brier Score Definition | **ADDRESSED** | Section 1 |
| Statistical Significance | **ADDRESSED** | Section 1.5 |
| Health Metric P&L Semantics | **ADDRESSED** | Section 2 |
| Auto-Disable Logic | **ADDRESSED** | Section 2.4 |
| Regime Transition Timing | **ADDRESSED** | Section 3 |
| Time Anchoring | **ADDRESSED** | Section 3.2.4 |

---

## 5. METHODOLOGY FREEZE ATTESTATION

I, STIG (EC-003_2026_PRODUCTION), attest that the following methodology is **FROZEN** as of 2026-01-19:

1. **Inversion Mapping:** Directional inversion with confidence preservation
2. **Inverted Brier Formula:** Brier_inverted = (f - 1)Â² where f = original confidence
3. **Health Metrics:** Dual-layer (Directional â‰¥ 80%, P&L â‰¥ 0%)
4. **Auto-Disable:** Triggered on P&L breach, not directional breach alone
5. **Regime Timing:** Daily resolution, exit at next market open

**Modification of these parameters requires G4 CEO approval.**

---

## 6. EVIDENCE HASH

```
sha256:IOS012B_G1_ADDENDUM_STATISTICAL_DEFENSIBILITY_20260119
```
# IoS-012-B - SYNTHETIC INVERSION MODULE

**Canonical Version:** 2026.G0.1
**Status:** G0_EXTENDED (Shadow Mode Only)
**Amendment:** CEO-DIR-20260122-BRS-ASSET-META (BULL CRYPTO Extension)
**Owner:** STIG (CTO)
**Validator:** VEGA (Governance)
**Dependencies:** IoS-012 (Execution Engine), IoS-008 (Runtime Decision Engine)
**ADR Alignment:** ADR-004, ADR-012, ADR-013, ADR-016
**CEO Directive:** CEO-DIR-2026-078 (G4 Canonicalized), CEO-DIR-2026-105 (Hindsight Firewall)

---

## 1. Executive Summary

IoS-012-B is the **Synthetic Inversion Module** - a specialized sub-component of IoS-012 that converts systematic miscalibration into alpha through signal inversion.

**Core Discovery (CEO-DIR-2026-105):**
> STRESS@99%+ equity signals have 0% hit rate across 37 signals. When inverted, this becomes a high-value alpha signal with Brier score 0.0058.

**Extended Discovery (CEO-DIR-20260122-BRS-ASSET-META):**
> BULL@99%+ CRYPTO signals have 12.23% hit rate across 327 signals (87.77% failure rate). When inverted, this yields Brier improvement of 0.7524 - the highest-leverage inversion after STRESS.

**Mission:**
Transform documented calibration failures into profitable trading strategies by inverting directional implications when the system exhibits systematic overconfidence:
1. **STRESS regime** (any confidence, equity) - 100% failure rate
2. **BULL regime** (99%+ confidence, crypto) - 87.77% failure rate

---

## 2. The Alpha Inversion Logic

### 2.1 STRESS Inversion Trigger (G4 Canonicalized)

```
IF regime = 'STRESS'
   AND confidence >= 0.99
   AND asset_class = 'EQUITY'
   AND ticker IN (stress_inversion_universe)
THEN
   invert_directional_implication()
```

### 2.2 BULL CRYPTO Inversion Trigger (G0 EXTENDED - 2026-01-22)

```
IF regime = 'BULL'
   AND confidence >= 0.99
   AND asset_class = 'CRYPTO'
   AND ticker IN (bull_crypto_inversion_universe)
THEN
   invert_directional_implication()
```

**Statistical Basis (Database-Verified 2026-01-22):**
- Sample Size: 327 signals
- Hit Rate: 12.23% (40/327 correct)
- Failure Rate: 87.77% (287/327 wrong)
- Original Brier: 0.8742
- Inverted Brier: 0.1218
- Improvement: 0.7524 (86.1% reduction)

### 2.3 STRESS Inversion Universe (10 Equity Tickers)

| Ticker | Sector | Evidence Base | Status |
|--------|--------|---------------|--------|
| ADBE | Technology | 3+ signals @ 99%+ | G4_CANONICALIZED |
| ADSK | Technology | 3+ signals @ 99%+ | G4_CANONICALIZED |
| AIG | Financials | 3+ signals @ 99%+ | G4_CANONICALIZED |
| AZO | Consumer | 3+ signals @ 99%+ | G4_CANONICALIZED |
| GIS | Consumer | 3+ signals @ 99%+ | G4_CANONICALIZED |
| HNR1.DE | Industrial | 3+ signals @ 99%+ | G4_CANONICALIZED |
| INTU | Technology | 3+ signals @ 99%+ | G4_CANONICALIZED |
| LEN | Real Estate | 3+ signals @ 99%+ | G4_CANONICALIZED |
| NOW | Technology | 3+ signals @ 99%+ | G4_CANONICALIZED |
| PGR | Financials | 3+ signals @ 99%+ | G4_CANONICALIZED |

### 2.4 BULL CRYPTO Inversion Universe (14 Tickers) - G0 EXTENDED

| Ticker | Failures | Avg Confidence | Avg Brier | Status |
|--------|----------|----------------|-----------|--------|
| SHIB-USD | 214 | 99.84% | 0.9969 | G0_CANDIDATE_PRIORITY |
| XRP-USD | 32 | 99.84% | 0.9968 | G0_CANDIDATE |
| ATOM-USD | 9 | 99.90% | 0.9980 | G0_CANDIDATE |
| DOT-USD | 8 | 99.44% | 0.9888 | G0_CANDIDATE |
| XTZ-USD | 6 | 99.79% | 0.9959 | G0_CANDIDATE |
| AVAX-USD | 3 | 99.85% | 0.9970 | G0_CANDIDATE |
| LINK-USD | 3 | 99.76% | 0.9952 | G0_CANDIDATE |
| SOL-USD | 3 | 99.82% | 0.9964 | G0_CANDIDATE |
| UNI-USD | 3 | 99.71% | 0.9942 | G0_CANDIDATE |
| AAVE-USD | 2 | 99.80% | 0.9960 | G0_CANDIDATE |
| ALGO-USD | 2 | 99.75% | 0.9950 | G0_CANDIDATE |
| DOGE-USD | 2 | 99.88% | 0.9976 | G0_CANDIDATE |
| LTC-USD | 2 | 99.79% | 0.9958 | G0_CANDIDATE |
| MATIC-USD | 2 | 99.82% | 0.9964 | G0_CANDIDATE |

**Critical Note:** SHIB-USD alone accounts for 214/287 (74.6%) of all BULL@99%+ CRYPTO failures.

### 2.5 Excluded Assets

| Ticker | Reason | Reference |
|--------|--------|-----------|
| FLOW-USD | VEGA G3 asset class boundary | Day 18 Report Section 14 |
| BTC-USD | Insufficient failure evidence | Meta-analysis 2026-01-22 |
| ETH-USD | Insufficient failure evidence | Meta-analysis 2026-01-22 |

---

## 3. Instrument Selection

### 3.1 STRESS Inversion: Vertical Bull Call Spreads (Equity)

When system predicts STRESS with extreme confidence but is systematically wrong, the inverted implication suggests **bullish** outcome. Vertical Bull Call Spreads provide:

1. **Defined Risk** - Maximum loss = net premium paid
2. **Leverage** - Synthetic exposure without direct equity position
3. **Options Liquidity** - Available on all 10 canonical tickers via Alpaca
4. **Governance Alignment** - Meets ADR-012 economic safety constraints

### 3.2 Structure

```
BUY:  1x Call @ Strike K1 (ATM or slightly OTM)
SELL: 1x Call @ Strike K2 (K2 > K1, further OTM)

Max Profit = (K2 - K1) - Net Premium
Max Loss   = Net Premium Paid
Breakeven  = K1 + Net Premium
```

### 3.3 Strike Selection Rules

| Parameter | Value | Rationale |
|-----------|-------|-----------|
| Long Strike (K1) | ATM or 1-2% OTM | Capture directional move |
| Short Strike (K2) | K1 + $5-10 | Defined profit cap |
| Expiration | 14-30 DTE | Theta balance |
| Delta Target | 0.40-0.50 long leg | Moderate directional exposure |

### 3.4 BULL CRYPTO Inversion: Short Spot / Perpetual Futures

When system predicts BULL with 99%+ confidence for CRYPTO but is systematically wrong (87.77% failure rate), the inverted implication suggests **bearish** outcome.

**Instrument Options (Shadow Mode):**

| Instrument | Venue | Rationale |
|------------|-------|-----------|
| Short Spot | Alpaca Crypto | Direct inverse exposure |
| Short Perpetual | Regulated CEX (future) | Leverage with funding |

**Note:** CRYPTO options are NOT available on Alpaca. Shadow mode will simulate short spot positions.

### 3.5 BULL CRYPTO Strike/Size Rules

| Parameter | Value | Rationale |
|-----------|-------|-----------|
| Position Size | 1% NAV max | Higher volatility adjustment |
| Stop Loss | 5% adverse move | Tight risk control |
| Take Profit | 3% favorable move | Asymmetric R:R |
| Max Holding | 48 hours | Momentum decay |

---

## 4. Position Sizing & Risk Management

### 4.1 Position Sizing

**STRESS Equity Inversion:**

| Parameter | Value | Constraint |
|-----------|-------|------------|
| Max Position per Ticker | 2.5% NAV | ADR-012 concentration limit |
| Max Total STRESS Exposure | 25% NAV | 10 tickers Ã— 2.5% |
| Premium Budget per Trade | 0.5% NAV | Cost control |

**BULL CRYPTO Inversion:**

| Parameter | Value | Constraint |
|-----------|-------|------------|
| Max Position per Ticker | 1.0% NAV | Volatility-adjusted |
| Max Total CRYPTO Exposure | 14% NAV | 14 tickers Ã— 1.0% |
| Stop Loss per Trade | 5% of position | Tight risk control |

**Combined Limits:**

| Parameter | Value |
|-----------|-------|
| Max Total Inversion Exposure | 39% NAV |
| Max Concurrent Positions | 24 (10 equity + 14 crypto) |

### 4.2 Exit Rules

| Exit Type | Trigger | Action |
|-----------|---------|--------|
| Take Profit | 50% of max profit reached | Close position |
| Stop Loss | 25% of premium remaining | Close position |
| Time Decay | 5 DTE remaining | Close position |
| Regime Change | STRESS regime exits | Evaluate close |

### 4.3 Risk Control Circuit Breaker

```python
def inversion_health_check():
    """Auto-disable if Inverted Hit Rate < 80%"""
    recent_signals = get_inverted_signals(lookback_days=30)
    inverted_hit_rate = calculate_hit_rate(recent_signals)

    if inverted_hit_rate < 0.80:
        disable_ios012b()
        alert_lars("INVERSION_DEGRADATION", inverted_hit_rate)
        return False
    return True
```

---

## 5. Hindsight Firewall Compliance

### 5.1 Non-Eligibility Period

| Constraint | Value | Reference |
|------------|-------|-----------|
| is_retrospective | TRUE | CEO-DIR-2026-105 |
| non_eligibility_until | 2026-02-02 | 2 learning cycles |
| current_mode | SHADOW_ONLY | No live execution |

### 5.2 Permitted Actions (Pre-2026-02-02)

- Shadow signal generation
- Paper trading simulation
- Performance tracking
- Evidence collection for G4 review

### 5.3 Prohibited Actions (Until 2026-02-02)

- Live execution on Alpaca
- SkillDamper parameter modification
- Model retraining based on inversion data
- Autonomous trading activation

---

## 6. Implementation Architecture

### 6.1 Data Flow

```
IoS-008 (Runtime Decision Engine)
    â†“
    Signal: {ticker, direction, confidence, regime, asset_class}
    â†“
IoS-012-B (Synthetic Inversion Module)
    â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ INVERSION CHECK (Dual-End Strategy)                      â”‚
    â”‚                                                          â”‚
    â”‚ Path A: STRESS Inversion (Equity)                        â”‚
    â”‚   IF regime == STRESS                                    â”‚
    â”‚      AND confidence >= 0.99                              â”‚
    â”‚      AND asset_class == EQUITY                           â”‚
    â”‚      AND ticker IN stress_universe                       â”‚
    â”‚   THEN invert_direction(), generate_bull_spread()        â”‚
    â”‚                                                          â”‚
    â”‚ Path B: BULL CRYPTO Inversion (Crypto)                   â”‚
    â”‚   IF regime == BULL                                      â”‚
    â”‚      AND confidence >= 0.99                              â”‚
    â”‚      AND asset_class == CRYPTO                           â”‚
    â”‚      AND ticker IN bull_crypto_universe                  â”‚
    â”‚   THEN invert_direction(), generate_short_spot()         â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
    IF SHADOW_MODE: log_to_shadow_tracking()
    â†“
    IF LIVE_MODE (post-firewall): submit_to_alpaca()
    â†“
IoS-012 (Execution Engine)
    â†“
    Lineage Hash, Audit Trail, Compliance Metrics
```

### 6.2 Database Objects

```sql
-- Shadow tracking table
fhq_provisional.inversion_overlay_shadow

-- Shadow performance view
fhq_provisional.v_inversion_overlay_performance

-- Health monitoring
fhq_governance.inversion_health_metrics
```

### 6.3 Python Module

```
03_FUNCTIONS/ios012b_synthetic_inversion_module.py
```

---

## 7. Evidence Base

### 7.1 STRESS Inversion Statistics (G4 Canonicalized)

| Metric | Value | Source |
|--------|-------|--------|
| N (signals) | 37 | CEO-DIR-2026-105 |
| Original Hit Rate | 0.00% | Brier Ledger |
| Original Brier | 0.9942 | Brier Ledger |
| Inverted Brier | 0.0058 | Calculated |
| Inverted Hit Rate | 100% (theoretical) | Inverse |

### 7.2 BULL CRYPTO Inversion Statistics (G0 Extended - 2026-01-22)

| Metric | Value | Source |
|--------|-------|--------|
| N (signals) | 327 | Brier Ledger (Database Query) |
| Original Hit Rate | 12.23% | 40/327 correct |
| Original Brier | 0.8742 | Brier Ledger |
| Inverted Brier | 0.1218 | Calculated |
| Inverted Hit Rate | 87.77% (theoretical) | Inverse |
| Brier Improvement | 0.7524 | 86.1% reduction |

**Worst Offender Detail:**
| Ticker | Failures | % of Total |
|--------|----------|------------|
| SHIB-USD | 214 | 74.6% |
| XRP-USD | 32 | 11.1% |
| Other 12 | 41 | 14.3% |

### 7.3 Combined System Impact

| Strategy | Current Brier | With Strategy | Improvement |
|----------|---------------|---------------|-------------|
| Baseline | 0.5662 | - | - |
| +STRESS Only | 0.5662 | 0.5454 | 3.69% |
| +STRESS+BULL_CRYPTO | 0.5662 | 0.4944 | **12.68%** |

### 7.4 Evidence Artifacts

| Artifact | Location | Status |
|----------|----------|--------|
| STRESS Regime-Conditional | `evidence/CEO_DIR_2026_105_REGIME_CONDITIONAL_MISCALIBRATION.json` | G4_COMPLETE |
| STRESS Retrospective | `evidence/CEO_DIR_2026_105_RETROSPECTIVE_CALIBRATION.json` | G4_COMPLETE |
| **BULL CRYPTO Meta-Analysis** | `evidence/BRIER_DUAL_END_INVERSION_META_ANALYSIS_20260122.json` | **G0_NEW** |
| **Governance Summary** | `05_GOVERNANCE/BRIER_DUAL_END_INVERSION_ANALYSIS_20260122.md` | **G0_NEW** |

---

## 8. Governance Gates

### 8.1 Current Status: G0 EXTENDED

| Component | Gate | Status | Requirement |
|-----------|------|--------|-------------|
| **STRESS Equity** | G0 | COMPLETE | IoS-012-B v1.0 |
| **STRESS Equity** | G1 | PENDING | Technical validation by STIG |
| **STRESS Equity** | G2 | PENDING | Governance validation by VEGA |
| **STRESS Equity** | G3 | SHADOW | Integration testing active |
| **STRESS Equity** | G4 | BLOCKED | Requires CEO + 2026-02-02 |
| **BULL CRYPTO** | G0 | **EXTENDED** | CEO-DIR-20260122-BRS-ASSET-META |
| **BULL CRYPTO** | G1 | PENDING | Statistical validation (this document) |
| **BULL CRYPTO** | G2 | PENDING | VEGA governance review |
| **BULL CRYPTO** | G3 | NOT_STARTED | Shadow testing required |
| **BULL CRYPTO** | G4 | BLOCKED | Requires separate approval cycle |

### 8.2 G4 Activation Criteria

1. Shadow testing complete with 14+ days data
2. Inverted Hit Rate >= 80% in shadow mode
3. No Hindsight Firewall violations
4. VEGA attestation of non-contamination
5. CEO signature

---

## 9. Risk Assessment

### 9.1 Identified Risks - STRESS Inversion

| Risk | Severity | Mitigation |
|------|----------|------------|
| Regime model drift | HIGH | Auto-disable at 80% threshold |
| Overfitting to historical pattern | HIGH | Hindsight Firewall, 2 learning cycles |
| Options liquidity | MEDIUM | Limit to canonical universe |
| Model contamination | CRITICAL | VEGA evidence guardian |

### 9.2 Identified Risks - BULL CRYPTO Inversion

| Risk | Severity | Mitigation |
|------|----------|------------|
| SHIB-USD concentration | HIGH | 214/287 failures from single asset |
| Crypto volatility spike | HIGH | 1% NAV limit, 5% stop loss |
| 12.23% correct predictions | MEDIUM | Accept 1-in-8 loss scenario |
| Regime model drift | HIGH | Auto-disable at 75% threshold |
| Short squeeze risk | MEDIUM | 48-hour max holding period |

### 9.3 Failure Modes

| Mode | Detection | Response |
|------|-----------|----------|
| STRESS Inverted Hit Rate < 80% | Health check | Auto-disable STRESS |
| BULL CRYPTO Inverted Hit Rate < 75% | Health check | Auto-disable CRYPTO |
| Regime undefined | Regime validator | Block signal |
| Ticker not in universe | Universe filter | Reject signal |
| Hindsight contamination | VEGA audit | System halt |
| Single-asset concentration > 50% | Concentration check | Alert LARS |

---

## 10. Acceptance Criteria

### 10.1 Shadow Mode Acceptance (G3)

- [ ] Shadow tracking table operational
- [ ] Paper trading on Alpaca Paper Account
- [ ] Performance metrics computed daily
- [ ] No contamination of ex-ante beliefs

### 10.2 Live Mode Acceptance (G4)

- [ ] 14+ days of shadow data
- [ ] Inverted Hit Rate >= 80%
- [ ] VEGA attestation signed
- [ ] CEO approval received
- [ ] Date >= 2026-02-02

---

## 11. Prepared By

**STIG** - System for Technical Implementation & Governance
**Agent ID:** EC-003_2026_PRODUCTION

**Original Document:**
- Date: 2026-01-19
- Directive: CEO-DIR-2026-105 (Phase 2)

**G0.1 Amendment (BULL CRYPTO Extension):**
- Date: 2026-01-22
- Directive: CEO-DIR-20260122-BRS-ASSET-META
- Evidence: `evidence/BRIER_DUAL_END_INVERSION_META_ANALYSIS_20260122.json`

---

## 12. Approval Chain

| Role | Agent | Status | Signature |
|------|-------|--------|-----------|
| Technical | STIG | SUBMITTED | pending |
| Governance | VEGA | PENDING | - |
| Strategy | LARS | PENDING | - |
| Authority | CEO | PENDING | - |
# IoS-012-C: Options Execution Architecture

**Status:** G1 DRAFT â€” Technical Validation
**Author:** STIG (EC-003)
**Date:** 2026-02-01
**Parent:** IoS-012 (Execution Engine)
**Directive:** CEO-DIR-2026-OPS-AUTONOMY-001
**Classification:** GOVERNANCE-CRITICAL / EXECUTION-BOUND
**Gate:** ADR-004 G1 (Technical Validation)

---

## 1. Purpose

This document specifies the complete options trading architecture for FjordHQ, extending the existing execution engine (IoS-012) to support options strategies via the Alpaca Options API. All execution is restricted to `SHADOW_PAPER` mode until G4 CEO approval.

---

## 2. MIT Quad Invariant Preservation

The options architecture preserves the MIT Quad (LIDS / ACL / DSL / RISL) separation:

| Domain | Role in Options | Constraint |
|--------|----------------|------------|
| **LIDS** (IoS-003) | Reads regime state. Regime determines which options strategies are eligible. | Read-only. No options mutation. |
| **ACL** (IoS-006) | Validates macro conditions (yield curve, VIX, credit spreads). | Cannot override options decisions. |
| **DSL** (IoS-004 + IoS-012-C) | SOLE authority for options candidate generation. Receives regime + alpha graph signals. | Never receives ACI input directly. |
| **RISL** | Can freeze all options activity via DEFCON. | Cannot alter strategy parameters. |
| **ACI** (ADR-020) | May research options hypotheses under LIDS domain. | Zero Execution Authority. Shadow observation only. |

---

## 3. Architecture Flow

```
IoS-003 (Regime) --> IoS-007 (Alpha Graph) --> FINN (Hypothesis)
       |                                            |
       v                                            v
IoS-004 (Allocation) <--- Options Strategy Candidates (DSL-ONLY)
       |
       v
IoS-012-C (Options Execution) <--- NEVER receives ACI input directly
       |
       v
CPTO Options Extension (Entry Precision)
       |
       v
Unified Execution Gateway (existing, extended)
       |
       v
Alpaca Options API (SHADOW_PAPER only)
```

---

## 4. Options Strategy Representation

Strategies exist as CANDIDATES in `fhq_learning.options_hypothesis_canon`. Each candidate contains:

- `strategy_type`: VERTICAL_SPREAD, IRON_CONDOR, COVERED_CALL, CASH_SECURED_PUT, PROTECTIVE_PUT
- `underlying`: The underlying symbol (e.g., AAPL, NVDA)
- `strikes[]`: Array of strike prices for each leg
- `expirations[]`: Array of expiration dates
- `greeks_snapshot`: JSON with delta, gamma, vega, theta, rho at creation time

**Critical invariant:** Candidates are NEVER directly executed. They flow through the full promotion gate pipeline:

```
hypothesis --> experiment --> trigger --> outcome --> promotion -->
shadow --> tier --> decision --> eligibility
```

This preserves the 9-step capital pipeline invariant (IoS-012, Section 4).

---

## 5. Alpaca Integration Points

### 5.1 SDK Usage

- **Library:** `alpaca-py` SDK
- **Chain data:** `get_option_contracts()`, `get_option_chain()` for chain retrieval
- **Paper orders:** `submit_order()` with `asset_class=AssetClass.US_OPTION`
- **Multi-leg:** Alpaca MLeg API for iron condors, spreads as single order
- **Symbology:** Standard OCC/OPRA format (e.g., `AAPL240119C00150000`)

### 5.2 Order Flow

1. Shadow adapter validates `execution_mode == SHADOW_PAPER`
2. Query Alpaca options chain via `get_option_contracts()`
3. Calculate Greeks via `options_greeks_calculator`
4. Validate Greeks within DEFCON limits
5. Submit paper order via Alpaca SDK
6. Record to `fhq_execution.options_shadow_orders`
7. Monitor position lifecycle (theta decay, Greeks drift, DTE countdown)
8. Auto-close at configurable DTE threshold (default: 7 DTE)
9. Record outcome in `fhq_execution.options_shadow_outcomes`
10. Generate evidence JSON with full lineage hash

### 5.3 Latency & Slippage Measurement

All options orders capture:

| Metric | Field | Source |
|--------|-------|--------|
| Submit time | `order_submitted_at` | System clock (UTC) |
| Fill time | `order_filled_at` | Alpaca response |
| Round-trip | `roundtrip_ms` | Computed: fill - submit |
| Slippage | `slippage_bps` | abs(filled_price - mid_price_at_submission) in basis points |

**MiFID II Art. 17 threshold:** >500ms roundtrip triggers automatic halt.

All measurements signed via hash-chain (ADR-013).

---

## 6. Compute Region

| Phase | Location | Rationale |
|-------|----------|-----------|
| SHADOW_PAPER (current) | Windows x64, localhost (Norway) | Latency irrelevant for paper trading |
| PAPER (G3+) | Windows x64, localhost | Norwegian latency (~120ms to us-east) acceptable for swing/daily |
| LIVE (G4+, future) | us-east-1 (AWS) or Alpaca co-located | Decision deferred to G3 review |

Options latency tolerance is 100-500ms (not HFT). Sub-second strategies (0DTE scalping) require co-location and are explicitly blocked in Phase A.

---

## 7. Schema Design

### 7.1 New Tables in `fhq_execution`

**`options_chain_snapshots`** â€” Cached chain data per underlying/expiration:
- underlying, expiration_date, strike, option_type (CALL/PUT)
- bid, ask, mid, last
- delta, gamma, vega, theta, rho
- implied_volatility, open_interest, volume
- snapshot_timestamp, content_hash

**`options_shadow_orders`** â€” Shadow paper orders:
- order_ref, strategy_type, underlying
- legs (JSONB: array of {side, strike, expiration, option_type, quantity})
- filled_prices (JSONB), greeks_at_entry (JSONB)
- margin_requirement_est, max_loss, max_profit
- execution_mode (SHADOW_PAPER enforced)
- order_submitted_at, order_filled_at, roundtrip_ms, slippage_bps
- source_hypothesis_id, lineage_hash

**`options_shadow_positions`** â€” Open shadow positions:
- position_ref, order_id (FK)
- aggregate Greeks: position_delta, position_gamma, position_vega, position_theta
- dte_remaining, theta_decay_daily, assignment_probability
- unrealized_pnl, status (OPEN/CLOSED/ROLLED/ASSIGNED)

**`options_shadow_outcomes`** â€” Closed positions:
- outcome_id, position_id (FK)
- realized_pnl, realized_return_pct
- Greeks attribution: theta_pnl, delta_pnl, gamma_pnl, vega_pnl
- exit_reason, exit_dte, holding_period_days
- content_hash, chain_hash

**`options_latency_log`** â€” Roundtrip measurements:
- log_id, order_id, roundtrip_ms, threshold_ms
- breach (boolean), action_taken
- logged_at

### 7.2 New Tables in `fhq_learning`

**`options_hypothesis_canon`** â€” Options-specific hypotheses:
- hypothesis_id (UUID), strategy_type, underlying
- regime_condition (JSONB), iv_rank_condition (JSONB), dte_range (int4range)
- source (CHECK: NOT 'ACI_DIRECT'), status
- strikes (JSONB), expirations (JSONB), greeks_snapshot (JSONB)
- created_at, lineage_hash

**`options_volatility_surface`** â€” IV surface snapshots:
- surface_id, underlying, snapshot_date
- expiration_date, strike, option_type
- implied_volatility, delta, gamma, vega, theta
- iv_rank, iv_percentile
- content_hash

### 7.3 New Tables in `fhq_monitoring`

**`options_risk_monitor`** â€” Real-time aggregate Greeks exposure:
- monitor_id, snapshot_at
- portfolio_delta, portfolio_gamma, portfolio_vega, portfolio_theta
- max_loss_estimate, margin_utilized_pct
- positions_count, strategies_active (JSONB)
- defcon_level_at_snapshot, content_hash

See migration files `350_options_trading_infrastructure.sql` and `351_options_defcon_killswitch.sql` for complete DDL.

---

## 8. Greeks Calculation Module

**File:** `03_FUNCTIONS/options_greeks_calculator.py`

### 8.1 Pricing Models

| Model | Use Case | Notes |
|-------|----------|-------|
| Black-Scholes | European-style baseline | Closed-form, fast |
| Binomial (CRR) | American-style (early exercise) | 100-step tree default |

### 8.2 Greeks

| Greek | Formula | Interpretation |
|-------|---------|----------------|
| Delta | dV/dS | Price sensitivity per $1 underlying move |
| Gamma | dÂ²V/dSÂ² | Delta acceleration |
| Vega | dV/dÏƒ | Price sensitivity per 1% IV change |
| Theta | dV/dt | Time decay per day |
| Rho | dV/dr | Rate sensitivity per 1% rate change |

### 8.3 IV Metrics

- **IV Calculation:** Newton-Raphson iteration from market prices (max 100 iterations, tolerance 1e-8)
- **IV Rank:** `(current_IV - 52w_low_IV) / (52w_high_IV - 52w_low_IV)`
- **IV Percentile:** `% of days in past year where IV was lower`

All calculations deterministic and reproducible.

---

## 9. Runtime Safety & Kill-Switch

**File:** `03_FUNCTIONS/options_defcon_killswitch.py`

Integration with existing ADR-016 DEFCON system. Options-specific rules layered on top:

| DEFCON Level | Shadow Allowed | Live Allowed | Max Delta | Max Vega | Action |
|-------------|---------------|-------------|-----------|----------|--------|
| 5 (GREEN) | Yes | No* | 50.0 | 5000.0 | Normal operations |
| 4 (YELLOW) | Yes | No | 25.0 | 2500.0 | TIGHTEN_GREEKS_LIMITS |
| 3 (ORANGE) | No | No | â€” | â€” | HALT_ALL_OPTIONS |
| 2 (RED) | No | No | â€” | â€” | FLATTEN_ALL_OPTIONS |
| 1 (BLACK) | No | No | â€” | â€” | SYSTEM_ISOLATED |

*Live always False until G4 CEO approval.

### 9.1 MiFID II Art. 17 Compliance

- Latency kill-switch: roundtrip > 500ms triggers halt + alert
- Runaway order detection: > 10 options orders in 60 seconds triggers halt
- Margin breach: estimated margin > 50% of portfolio triggers halt
- Greeks breach: any single Greek exceeds DEFCON limit triggers halt for that strategy

### 9.2 ADR-019 Break-Glass Extension

| Command | Scope | Authority |
|---------|-------|-----------|
| SYSTEM_HALT | All systems | RISL (existing) |
| DEFCON_RESET | DEFCON level | RISL (existing) |
| POSITIONS_FLATTEN | All positions | RISL (existing) |
| **OPTIONS_FLATTEN** | Options positions only | RISL (new) |

### 9.3 Hash-Chain Continuity (ADR-013)

Every kill-switch event produces evidence JSON with SHA256 content_hash. Logged to `fhq_monitoring.options_killswitch_events` with `chain_hash` linking to previous event. Immutable audit trail for regulatory inspection.

---

## 10. Shadow/Paper Trading Path

**File:** `03_FUNCTIONS/options_shadow_adapter.py`

### 10.1 Execution Mode

```
execution_mode = SHADOW_PAPER  (hardcoded, non-negotiable)
```

### 10.2 Supported Strategies (SHADOW_PAPER only)

| Strategy | Risk Profile | Requires |
|----------|-------------|----------|
| Cash-Secured Put (CSP) | Defined risk (bullish) | Cash collateral |
| Covered Call (CC) | Defined risk (neutral/mild bullish) | Shares |
| Vertical Spread | Defined risk, defined reward | â€” |
| Iron Condor | Defined risk (range-bound) | â€” |
| Protective Put | Portfolio hedge | Shares |

### 10.3 Blocked Strategies

| Strategy | Reason | Enforcement |
|----------|--------|-------------|
| Naked calls | Undefined risk | Code assertion |
| Naked puts (beyond CSP) | Undefined risk | Code assertion |
| Straddles/strangles (no cap) | Undefined max loss | Code assertion |
| 0DTE strategies | Latency < 50ms not proven | Code assertion |
| Any undefined-risk strategy | Governance constraint | Code assertion |

### 10.4 Hard Constraints (Class A Governance Breach if violated)

```python
assert execution_mode == "SHADOW_PAPER"
assert not margin_utilized
assert not capital_allocated_live
assert not requires_g3_approval()
```

---

## 11. Gap Analysis Summary

### 11.1 Infrastructure Gaps (10)

| # | Gap | Severity | Complexity |
|---|-----|----------|-----------|
| G1 | Options chain data ingestion | HIGH | MEDIUM |
| G2 | Greeks calculator | HIGH | MEDIUM |
| G3 | Options execution adapter | HIGH | HIGH |
| G4 | IV surface tracking | MEDIUM | MEDIUM |
| G5 | Options P&L attribution | MEDIUM | MEDIUM |
| G6 | Assignment risk engine | MEDIUM | HIGH |
| G7 | Options roll management | LOW | MEDIUM |
| G8 | Options regime mapping | HIGH | LOW |
| G9 | Multi-leg order builder | HIGH | MEDIUM |
| G10 | Margin calculation | MEDIUM | MEDIUM |

### 11.2 Governance Gaps (7)

| # | Gap | Status |
|---|-----|--------|
| G11 | ADR for options (ADR-025 or IoS-012-C) | BLOCKING â€” resolved by this document |
| G12 | G4 CEO approval for live execution | BLOCKING â€” not yet requested |
| G13 | VEGA attestation for options | BLOCKING â€” pending G2 |
| G14 | AEL Rung for options (Rung E) | BLOCKING â€” pending pipeline maturity |
| G15 | IoS-004 options mapping | BLOCKING â€” regime mapping not present |
| G16 | EC for options agent | MEDIUM â€” extend EC-015 CPTO or new EC-023 |
| G17 | Options in authority_matrix | MEDIUM â€” row not present |

### 11.3 Lineage & Hash-Chain Gaps (3)

| # | Gap | Status |
|---|-----|--------|
| G18 | Options hypothesis lineage | Resolved by this directive (hash chain in all modules) |
| G19 | Greeks snapshot signing | Resolved by this directive (SHA256 on every calculation) |
| G20 | Options evidence bundle | Resolved by this directive (court-proof evidence per trade) |

### 11.4 Hidden Governance Risks

1. **ACI Leakage Risk:** `options_hypothesis_canon.source` field enforced via CHECK constraint â€” cannot be 'ACI_DIRECT'.
2. **Greeks Manipulation Risk:** IV data must be < 60 seconds old for any order. Stale IV triggers automatic halt.
3. **Assignment Risk:** Phase 1 restricts to defined-risk strategies only (spreads, cash-secured).
4. **Regime Mismatch Risk:** IoS-003 regime change triggers automatic halt of new options entries + tighten stops on existing.

---

## 12. Implementation Phases

| Phase | Description | Gate | Status |
|-------|-------------|------|--------|
| **A** (this directive) | Foundation: schema, calculator, kill-switch, shadow adapter | G1 | IN PROGRESS |
| **B** (future) | VEGA attestation, LARS strategy review, FINN methodology sign-off, 30-day shadow observation | G2/G3 | PENDING |
| **C** (future) | CEO G4 authorization, execution_mode upgrade to PAPER, performance measurement | G4 | PENDING |

---

## 13. Verification Criteria

| # | Test | Expected |
|---|------|----------|
| V1 | Schema verification via information_schema | All tables exist in correct schemas |
| V2 | Greeks calculator: AAPL $150 call, 30 DTE, 25% IV | Delta ~0.55 |
| V3 | Kill-switch: DEFCON transition to ORANGE | Options halted |
| V4 | Shadow adapter: execution_mode assertion | AssertionError on non-SHADOW_PAPER |
| V5 | Hash-chain: sample options trade lineage | Valid SHA256 chain |
| V6 | Gateway: validate_options_permission() at DEFCON < GREEN | Returns blocked |
| V7 | Evidence JSON: all required fields present | Schema-valid |

---

*Document generated by STIG (EC-003) | CEO-DIR-2026-OPS-AUTONOMY-001 | G1 Technical Validation*
*Database clock: 2026-02-01 16:02 CET*
IoS-012 â€” EXECUTION ENGINE

Canonical Version: 2026.G0
Status: G3_INTEGRATED (pending G4 review)
Owner: LARS (Strategy)
Validator: STIG (CTO)
Governance: VEGA
Dependencies: IoS-001, IoS-003, IoS-004, IoS-006
ADR Alignment: ADR-004, ADR-011, ADR-012, ADR-013, ADR-016

1. Executive Summary (C-Level Purpose)

IoS-012 is the Execution Engine of Vision-IoS.
It is the component responsible for turning model outputs into enforceable market exposures, while strictly adhering to governance rules, risk limits, and lineage requirements.

Its mandate is not to predict, not to generate alpha, not to reason.
Its mandate is:

To translate strategic intent into safe, auditable, deterministic execution decisions.

In institutional terms:
IoS-003 thinks.
IoS-004 allocates.
IoS-012 executes.

IoS-012 is the final gate between Vision-IoS intelligence and real-world capital.

2. Mission & Scope (What IoS-012 actually does)
Core responsibilities:

Enforce target exposures from IoS-004

Apply volatility blocks and exposure limits (IoS-006)

Maintain strict accounting identity:
Total Equity = Net Liquidation Value (NLV)

Implement circuit breakers (ADR-016)

Normalize exposure transitions over time

Sequence orders safely across assets

Produce fully recoverable lineage trails

Validate all upstream signals before execution

Produce zero ambiguity in executed positions

What IoS-012 explicitly does not do:

Does not generate trading signals

Does not rebalance on its own

Does not initiate trades without upstream mandate

Does not modify risk settings

Does not bypass governance logs

Does not load external market data

IoS-012 is a deterministic executor, not a trader with discretion.

3. Role in Vision-IoS Architecture

IoS-012 sits at the bottom of the application stack:

    IoS-003   â†’   IoS-004   â†’   IoS-012
  (Brain)         (Allocator)     (Executor)


Inputs:

Regime exposure mandates (IoS-004)

Risk constraints (IoS-006)

Canonical asset registry (IoS-001)

Governance constraints (ADR-012)

Outputs:

Final validated exposure table

Execution lineage (hash chain)

Position transition logs

Compliance metrics

IoS-012 is the only engine allowed to modify positions.

4. Architectural Boundaries (G0â€“G3 Definition)
Included functions:

Exposure validation

Risk constraint enforcement

Transition smoothing

Accounting identity enforcement

NLV computation

Lineage hashing

Circuit breaker integration

Compliance reporting

Execution scheduling

Excluded until G4:

Live API key access

Real trading execution

Integration with brokers or exchanges

Autonomous operation

Real capital modification

IoS-012 remains in safe mode until G4 PASS.

5. Data & Governance Contracts (Mandatory Under ADR-013)
Input Contracts

Must only consume:

Canonical Asset Definitions (IoS-001)

Exposure Targets (IoS-004)

Volatility & Safety Blocks (IoS-006)

Regime Metadata (IoS-003)

No foreign inputs permitted.

Output Contracts

For each exposure update:

asset_id

target_exposure

allowed_exposure (post constraints)

previous_exposure

transition_cost

timestamp

lineage_hash

metadata

Lineage Requirements

Every execution decision must have:

sha256(input_state_hash + target_exposure + constraints_hash)


This guarantees audit reconstruction.

6. Risk & Safety (ADR-012 Economic Safety Layer)
Mandatory safety invariants:
6.1 Accounting Identity

NLV must remain consistent under all scenarios:

Total Equity = Cash + Position Value â€“ Liabilities
Total Equity = Net Liquidation Value (NLV)


This applies to:

spot

margin

futures

leveraged assets

6.2 Exposure Safety

No asset may exceed max_exposure defined in IoS-006

No transition may exceed max_delta_exposure

No leverage multiplier may exceed configured bounds

6.3 Circuit Breaker Integration (ADR-016)

IoS-012 must abort execution under:

Data corruption

Volatility shock beyond threshold

Lineage mismatch

Strategy instability

Execution drift

6.4 Capital Protection

Forced reduction to cash in catastrophic scenarios

Position unwind sequencing must be deterministic

IoS-012 is the guardian of capital.

7. Compliance Requirements (ADR-004, ADR-011, ADR-013)
7.1 ADR-004 (Change Gates)

All code must pass G1 Tech Validation

All constraints must pass G2 Governance

All integrations must pass G3 Testing

G4 approval required for live operation

7.2 ADR-011 (FORTRESS Tests)

IoS-012 must be validated with:

Regression suite

Stress suite

Drift detection

Exposure invariance tests

Transaction ordering tests

7.3 ADR-013 (One-Source-Truth)

IoS-012 may only resolve data from canonical registries.
Duplicate price sources, feeds, or unverified data are forbidden.

8. Secrets & Key Management (Critical Requirement for G4)

As IoS-012 interacts with live exchanges:

Zero-Tolerance Requirements:

Secrets injected ONLY by Vault/ENV

No secrets in logs, tracebacks, exceptions, or debug paths

No introspection or repr leaks

No printing of request headers

Live keys never stored in the database

Rotation enforced according to policy

Secrets cannot appear in lineage logs

If this fails, G4 cannot be approved.

9. Future Progression Path (Gate-by-Gate)
G1 â€” Technical Validation

Pure function validation

Exposure math correctness

Accounting identity tests

Constraint enforcement

Lineage consistency

G2 â€” Governance Validation

Determinism proofs

ADR-013 data separation proofs

Risk limit enforcement verification

G3 â€” Integration

Connect to IoS-004 / IoS-006

Simulated execution

FORTRESS compliance

Backtest validation

G4 â€” Constitutional Activation

Requires:

Secrets Security Verification

Economic Safety attestation

Lineage attestation

FORTRESS zero-drift

CEO signature

VEGA PASS

Once G4 is passed â†’ IoS-012 becomes the execution authority.

10. Risk Assessment (C-Level)
Without IoS-012:

No safe execution

No compliance trail

No deterministic exposure

No circuit breaker authority

No live trading capability

With IoS-012 (poorly governed):

Leverage spills

Exposure mismatches

Runaway execution

Silent capital degradation

Undetectable drift

Secret leakage risks

Hence IoS-012 is one of the highest-risk modules and must be governed accordingly.

11. G0/G3 Decision Record

IoS-012 is already:

Registered

Validated through G3

Integrated in simulation mode

Pending:

G4 Constitutional Review (underway by your last directive)

Prepared by:

LARS â€” Strategy & Systems Architecture

Approved by:

CEO â€” FjordHQ
---

**Document ID:** IoS-013-Perspective_2026.
**Title:** Cognitive Signal Weighting & Decision Context Engine
**Issued by:** FjordHQ Executive Architecture Office
**Version:** G0 (Draft for ADR-004 Review)
**Owner:** STIG (CTO), LARS (CSO), VEGA (Governance)
**Date:** 2026-01-21
**Governance Binding:** ADR-001, ADR-003, ADR-005, ADR-007, ADR-013, ADR-014, ADR-016, ADR-018
**Supersedes:** IoS-013.HCP-LAB (deprecated)

---

# âœ¨ Executive Summary

**IoS-013-Perspective** er FjordHQs offisielle komponent for Ã¥ konvertere signaler til beslutningskraft. Den samler, vekter og forklarer sanntidsdata fra hele signalsystemet og skaper et kognitivt tolkningsgrunnlag som kan brukes av bÃ¥de autonome agenter og mennesker.

Dette er ikke en strategi. Det er *perspektivet* som avgjÃ¸r hvilken strategi som skal fÃ¥ tillit.

IoS-013 utgjÃ¸r siste steg i tolkningen av observasjoner fÃ¸r agentene tar handling, og fungerer som den semantiske broen mellom rÃ¥signaler og beslutningslogikk i IoS-008.

---

# â‘  Mission & Scope

## FormÃ¥l

* Vekting av signaler etter semantisk, statistisk og regimebasert relevans
* TverrmodulÃ¦r kontekstbygging for felles beslutningsgrunnlag
* Produksjon av deterministiske, forklarbare beslutningspakker (context_weighted_signal_plan)

## Hva IoS-013 ikke er

* Ikke en signalgenerator (det gjÃ¸res i IoS-002, -006, -007)
* Ikke en prediktor (det gjÃ¸res i IoS-005)
* Ikke en strategiaktiverer (det gjÃ¸res i IoS-008 og IoS-015)

---

# â‘¡ Architecture & Inputs

## Kilder

* IoS-002: Tekniske indikatorer
* IoS-003: Regimeklassifisering
* IoS-005: Forecasts, Brier-score
* IoS-006: Makrofeatures
* IoS-007: Causal Alpha Graph (LEADS, INHIBITS, AMPLIFIES)
* IoS-010: Prediction Ledger
* IoS-016: Event proximity tags (EVENT_ADJACENT, etc)

## Kjernemodell

```python
context_weighted_signal_plan = {
    'asset_id': str,
    'regime_context': str,
    'raw_signals': List[Signal],
    'weighted_signals': List[WeightedSignal],
    'confidence_score': float,
    'explainability_trace': str,
    'semantic_conflicts': Optional[List[str]]
}
```

---

# â‘¢ Weighting Methodology

## Faktorer for vekting

| Dimensjon       | Metode                              | Vekting       |
| --------------- | ----------------------------------- | ------------- |
| Regime-samsvar  | Regime vs signal-type alignment     | 0.2 - 1.0     |
| Forecast skill  | Brier score per signal-kilde        | 0.1 - 1.0     |
| Causal linkage  | Signalens posisjon i causal graph   | 0.3 - 1.2     |
| Redundansfilter | Cohesion score, multikilde-overlapp | -0.2 til -0.5 |
| Event proximity | EVENT_ADJACENT gir vekt-reduksjon   | -0.1 til -0.3 |

## Output

* `weighted_signal_strength` per signal
* `total_confidence_score` for hele assetÃ—time beslutning
* `risk_flag` hvis signaler er motstridende

---

# â‘£ Integration Flow

## 1. Daglig flyt (Trigger: IoS-014)

* Samle signaler etter predefinert orkestreringsplan (IoS-014 DAG)
* Konverter til `context_weighted_signal_plan`
* Send til:

  * IoS-008 (Decision Engine)
  * EC-016 (VALKYRIE) som forklarende narrativ
  * UMA/IoS-015 som lÃ¦ringsobjekt (training event)

## 2. Logging

* Alle planer lagres i `fhq_signal_context.weighted_signal_plan`
* Kryptert signatur (Ed25519) og referanse til input-hash-kjede
* Alle avvik (f.eks. inkompatible signaler) loggfÃ¸res i `signal_conflict_registry`

---

# â‘¤ Feedback Loop & LÃ¦ring

* IoS-016 brukes for Ã¥ justere vekter post-event
* UMA refererer til `confidence_score` og senere PnL/Brier for edge-analyse
* Signals som konsekvent gir dÃ¥rlig resultat nedvekteres fremtidig automatisk

## Kobling til LVI

LVI_i dag er justert med IoS-013 confidence-weight som vektingsfaktor i LVI-formelen:

```
LVI_adjusted = Î£(Forecast_success Ã— Confidence_score Ã— (1 - Event_proximity)) / T
```

---

# âš–ï¸ Governance

* G0 initiert 2026-01-21
* Krever G1-registrering i `fhq_meta.ios_registry`
* Krever ADR-004 G2 signering av LARS og VEGA
* All output er underlagt ADR-018 fail-closed og ADR-013 canonical lineage

---

# âœ… Success Criteria

| Metrikk                                                    | MÃ¥l |
| ---------------------------------------------------------- | --- |
| Samme signal gir lik confidence-score per regime           | âœ”   |
| Alle beslutninger i IoS-008 er koblet til context_id       | âœ”   |
| VALKYRIE fÃ¥r forklart narrativ fra samme signalplan        | âœ”   |
| 14 dagers test viser konsistent vekting pÃ¥ tvers av DEFCON | âœ”   |
| LVI forbedret med >= 0.03 etter aktivering                 | âœ”   |

---

# ðŸ” Signatur

IoS-013-Perspective er herved dokumentert og klar til G1-behandling som *den kognitive syntesen mellom datastrÃ¸m og beslutning*.

**FjordHQ Executive Architecture Office**
Dato: 2026-01-21
# IoS-014_PROD_2026 â€” Autonomous Orchestration Layer (Logical Control Plane)

**Canonical Version:** 2026.PROD.G1
**Status:** ACTIVE
**Supersedes:** IoS-014 â€” Autonomous Task Orchestration Engine (2026.DRAFT.G0)
**Owner:** STIG (CTO, Tier-1)
**Governance:** VEGA (Tier-1), CEO (Tier-0)
**Execution:** Distributed Daemons (CODE, LINE)
**Dependencies:** ADR-001..016, IoS-001..013, EC-003..007

---

## 1. Mission

IoS-014 defines FjordHQ's **Autonomous Orchestration Layer**.

Its mission is to act as the **logical control plane** governing how autonomous components are coordinated, constrained, observed and audited across the system.

**IoS-014:**
- does not implement business logic
- does not trade
- does not generate hypotheses
- does not require a single runtime daemon

**It defines and enforces:**
- execution order
- cadence and rhythm
- economic safety
- DEFCON behaviour
- auditability and evidence

**IoS-014 ensures that autonomous agents act on current canonical truth, within explicit economic and governance constraints, at all times.**

---

## 2. Architectural Principle (Critical)

> **IoS-014 is a logical orchestration layer, not a monolithic runtime service.**

The orchestration mandate is fulfilled through a set of coordinated, specialized daemon processes, each operating under explicit governance rules.

**The absence of a single `ios014_orchestrator` daemon does not imply loss of orchestration.**
Orchestration is achieved through enforced contracts, state registries, watchdogs and evidence trails.

This design is intentional and required for:
- resilience
- fault isolation
- audit defensibility
- economic safety

---

## 3. Scope of Orchestration

IoS-014 governs and supervises:

| Domain | Responsibility |
|--------|----------------|
| Scheduling | Cadence of autonomous tasks |
| Ordering | Inter-IoS execution order and dependency discipline |
| Vendors | Usage, quotas and fallback logic |
| DEFCON | Aware behaviour switching |
| Health | Heartbeat and liveness guarantees |
| Audit | Immutable evidence capture |

It applies across:
- Ingestion (prices, macro, news, flows)
- Feature and indicator pipelines (IoS-002, IoS-006)
- Perception and regime (IoS-003)
- Research, alpha and learning loops (IoS-007, 009, 010, 011)
- Tier-1 testing and hypothesis lifecycle
- Execution (paper and live under approval)

---

## 4. Runtime Realisation (Production 2026)

### 4.1 Distributed Control Implementation

| Orchestration Function | Implemented Via |
|------------------------|-----------------|
| Scheduling / cadence | `*_scheduler` daemons |
| Pre-Tier scoring | `pre_tier_scoring_daemon` |
| Tier-1 hypothesis testing | `tier1_execution_daemon` |
| Hypothesis lifecycle & death | `hypothesis_death_daemon` |
| Health & heartbeat | `daemon_watchdog` |
| DEFCON enforcement | `fhq_governance.defcon_state` |
| Economic safety | Vendor guard logic + watchdog |
| Audit & evidence | Evidence JSON + Fortress anchors |

All daemons operate under explicit lifecycle classification:
`ACTIVE`, `SUSPENDED_BY_DESIGN`, `DEPRECATED`, `ORPHANED`.

### 4.2 Scheduling Discipline

Scheduling is **decentralized but governed**.

**Rules:**
- No daemon may self-reschedule outside its declared frequency
- No daemon may execute if required upstream canonical tables are stale
- Non-reentrant tasks must not overlap execution windows

All schedules are auditable via:
- daemon heartbeats
- execution timestamps
- failure counters

---

## 5. Governance Alignment

### 5.1 ADR-013 â€” Canonical Truth

IoS-014 enforces:
- read-only access to canonical tables for orchestration decisions
- refusal to execute tasks on schema mismatch
- deterministic ordering of perception â†’ testing â†’ execution

### 5.2 ADR-012 â€” Economic Safety

IoS-014 is the runtime enforcement layer for economic safety.

**Rules:**
- Vendor soft ceiling at 90% of free tier
- Hard ceilings must never be crossed
- Fallback to cheaper or internal sources preferred
- Non-critical tasks may be skipped with explicit audit logs

All quota decisions must log:
- vendor
- current usage
- projected usage
- decision (throttle / fallback / skip)
- justification

### 5.3 ADR-016 â€” DEFCON

IoS-014 is fully DEFCON-aware.

| DEFCON | Behaviour |
|--------|-----------|
| GREEN | Full research, testing and execution (paper) |
| YELLOW | Reduced frequency for non-critical tasks |
| ORANGE | Freeze new research, preserve testing and monitoring |
| RED | Execution halted, perception and safety only |
| BLACK | Full halt, CEO-only override |

**DEFCON state overrides execution mode.**

---

## 6. Health, Liveness & Hygiene

IoS-014 mandates:
- Heartbeat emission every cycle
- Detection of stale, orphaned or runaway daemons
- Automatic escalation for ORPHANED components
- Lifecycle archiving for deprecated components

Daemon hygiene is governance-critical and enforced via:
- `daemon_watchdog`
- lifecycle registry
- audit evidence

---

## 7. Audit & Evidence

For each orchestration cycle, the system must be able to reconstruct:
- which daemons ran
- under which DEFCON and execution mode
- with which vendor quota state
- with what outcome

**Evidence must be:**
- immutable
- timestamped
- hash-anchored
- VEGA-verifiable

**This is non-negotiable.**

---

## 8. Runtime Modes

| Mode | Description |
|------|-------------|
| `LOCAL_DEV` | Reduced universe, cheap vendors only |
| `PAPER_PROD` | Full system, paper execution only |
| `LIVE_PROD` | Real execution under explicit CEO + VEGA approval |

IoS-014 enforces mode boundaries strictly.

---

## 9. Activation & Lifecycle Path

| Phase | Requirement |
|-------|-------------|
| G1 | Logical orchestration documented and mapped |
| G2 | Economic safety and DEFCON validated |
| G3 | 14 consecutive days PAPER_PROD without violations |
| G4 | CEO-approved LIVE_PROD with explicit risk budget |

---

## 10. Explicit Design Decision

> **The legacy daemon `ios014_orchestrator` is DEPRECATED BY DESIGN.**

Its responsibilities are fulfilled more robustly via:
- distributed daemons
- explicit governance contracts
- watchdog-based enforcement

**No monolithic orchestrator is required or desired.**

---

## 11. Executive Summary (for Registry)

**IoS-014 is FjordHQ's control plane, not a process.**

It guarantees that autonomy remains:
- economically safe
- epistemically sound
- auditable
- CEO-controllable

---

*This specification reflects production reality as of 2026 and is binding for all future development.*

**Document Hash:** `SHA256:PENDING_FORTRESS_ANCHOR`
**Created:** 2026-01-26
**Approved:** CEO (Tier-0)
IoS-015 Executive Verification Memorandum

Subject: Verify full Activation of Multi-Strategy, Cognitive Trading Infrastructure
Directive: VERIFY IoS-015
Status: Institutionally Ready

1. Executive Summary

IoS-015 is hereby declared fully implemented and execution-ready.

Across four tightly governed phases, FjordHQ has transitioned from a safety-first foundation to a multi-strategy, cognitively adaptive trading system capable of operating across hundreds of assets with deterministic risk controls, causal intelligence, and regime-aware capital allocation.

This is no longer a research stack.
It is a production-grade decision and execution architecture.

2. Strategic Intent

IoS-015 exists to solve a single institutional problem:

How to deploy multiple, orthogonal alpha engines at scale without correlation blow-ups, regime blindness, or uncontrolled risk.

The system answers this through:

Mandatory safety gates (DEFCON + Circuit Breakers)

Statistical and causal regime awareness

Capital sizing grounded in probabilistic edge

Cognitive engines that adapt behavior dynamically, not heuristically

3. Phase Completion Overview
Phase 1 â€“ Foundation (COMPLETE)

Objective: Make failure survivable and success non-fragile.

Delivered capabilities:

Circuit Breaker with CLOSED / OPEN / HALF-OPEN states, fully DEFCON-integrated

Signal Cohesion filter rejecting portfolio correlation above 0.7

Kelly-based probabilistic position sizing with hard caps

Institutional database backbone supporting 470 assets and 1.16M price records

Outcome:
No strategy can deploy capital without passing safety, correlation, and sizing constraints.

Phase 2 â€“ Strategy Engines (COMPLETE)

Objective: Enable diversified alpha generation across market conditions.

Delivered engines:

Advanced Regime Classifier (4D): Trend, volatility, expansion, liquidity

Statistical Arbitrage: Cointegration-validated pairs with half-life control

Grid Trading: ATR-based grids with regime-safety auto-disable

Mean Reversion: Multi-timeframe RSI with Kelly sizing

Live system behavior confirms:

Strategies self-select based on regime

Grid trading correctly suppressed in trending markets

Mean reversion signals generated selectively with controlled exposure

Outcome:
Alpha engines are regime-aware, gated, and non-overlapping by design.

Phase 3 â€“ Cognitive Upgrade (COMPLETE)

Objective: Move from reactive trading to adaptive intelligence.

Delivered capabilities:

Asset universe clustered into 10 correlation-aware macro groups (VarClus)

Cluster-level and asset-level causal discovery (PCMCI)

Thompson Sampling for regime-conditioned action selection

Causal Reinforcement Learning using causal parents as state filters

System behavior:

Capital sizing and timing adjust dynamically by regime

Strategy aggressiveness is learned, not hard-coded

Causal relationships inform action, not correlation alone

Graceful degradation is enforced when external causal libraries are unavailable.

Outcome:
The system now learns how to behave, not just what to trade.

Phase 4 â€“ Full Deployment (COMPLETE)

Objective: Ensure scale does not introduce fragility.

Confirmed capabilities:

Architecture supports 500+ assets

Strategy engines operate in parallel under shared safety and cognition

Information foraging and adaptive intelligence fully integrated

Outcome:
IoS-015 is horizontally scalable without exponential risk.

4. Governance and Risk Posture

IoS-015 operates under strict constitutional constraints:

DEFCON governs runtime permissions

Circuit breakers override all strategy logic

Capital allocation is probabilistic, capped, and auditable

Cognitive components inform decisions but do not bypass controls

There is no single point of catastrophic failure.

5. What Changes After Execution

With IoS-015 active:

The system no longer â€œruns strategiesâ€

It selects, sizes, delays, and suppresses strategies contextually

Risk is endogenous to the architecture, not an afterthought

Learning compounds without increasing tail exposure

This is the difference between a trading system and a trading institution.

6. Formal Declaration

All prerequisite phases are complete.
All core engines are built, integrated, and validated.
All safety and governance controls are active.

Directive:
Verify IoS-015
# IoS-016 - Economic Calendar and Temporal Governance

**Canonical Version:** 2026.G0.MBB++
**Owner:** LINE (EC-005) + CEIO (EC-009)
**Governance:** VEGA (Tier-1), CEO (Tier-0)
**Infrastructure:** STIG (EC-003)
**Data Steward:** CDMO (EC-007)
**Dependencies:** ADR-001..016, ADR-020, IoS-001, IoS-003, IoS-005, IoS-010
**CEO Approval:** Phase 1 Foundation APPROVED (2026-01-16)

---

## 1. Mission

IoS-016 is FjordHQ's canonical economic calendar and temporal governance system.

Its mission:

- Provide a single source of truth for market-moving events across all asset classes
- Enable event-aware learning by tagging forecasts with event proximity context
- Separate model error from event-driven volatility in Brier score analysis
- Detect information leakage through pre-event drift monitoring
- Support UMA's Learning Velocity Index (LVI) with clean learning windows
- Ensure all calendar data is auditable, signed, and court-proof

**IoS-016 does not generate trading signals.**
**It does not predict event outcomes.**
**It provides temporal context for learning systems.**

---

## 2. Strategic Rationale

### 2.1 The Learning Gap

Without calendar awareness, FjordHQ's learning system suffers from:

| Gap | Impact on Learning | Impact on ROI |
|-----|-------------------|---------------|
| **False-Negative Learning** | System punishes itself for event-driven volatility | Capital allocation miscalibration |
| **Model Drift vs Event Noise** | Cannot distinguish internal error from external shock | Incorrect model updates |
| **Brier Score Inflation** | Event-adjacent forecasts degrade aggregate Brier | Understated true model skill |
| **LVI Underestimation** | Learning velocity appears slower than reality | Resource misallocation |
| **Regime Misclassification** | Events cause regime transitions that look like errors | Strategy selection errors |

**Estimated Learning Efficiency Loss: 15-25% of validated signals misattributed**

### 2.2 The Solution

IoS-016 provides:

1. **Event Registry** - Canonical list of event types with impact rankings
2. **Calendar Events** - Timestamped instances with surprise scores
3. **Forecast Tagging** - EVENT_ADJACENT / EVENT_NEUTRAL / POST_EVENT classification
4. **Stratified Brier** - Separate analysis for event-affected vs clean windows
5. **Ghost Event Detection** - Flag unexplained volatility for calendar gaps
6. **LVI_adjusted** - CEO-visible learning metric excluding event noise

---

## 3. Scope

IoS-016 covers:

### 3.1 Event Categories

| Category | Examples | Impact Rank Range |
|----------|----------|-------------------|
| **MACRO** | FOMC, CPI, NFP, GDP, PMI | 3-5 |
| **EQUITY** | Earnings releases, dividends, splits | 2-4 |
| **CRYPTO** | Halvings, hard forks, regulatory announcements | 2-5 |
| **CROSS_ASSET** | Currency interventions, commodity shocks | 3-5 |

### 3.2 Coverage Scope (Phase 1 - 14 Day Firewall)

| Scope | Phase 1 | Phase 2+ |
|-------|---------|----------|
| US Macro (FOMC, CPI, NFP) | Full | Full |
| Global Central Banks | Major only | Full |
| Equity Earnings | Top 50 holdings | Full coverage |
| Crypto Events | BTC/ETH major events | Full |
| Corporate Actions | Partial | Full |

### 3.3 Out of Scope

- Event outcome prediction
- Trading signal generation
- Strategy recommendations
- Sentiment analysis of event text

---

## 4. Governance Alignment

### 4.1 ADR-001 - System Charter

IoS-016 extends the charter to include temporal governance:

| Agent | Calendar Authority |
|-------|-------------------|
| LINE | Temporal governance owner - system clock, event scheduling |
| CEIO | Calendar operator - external data ingestion |
| CDMO | Data steward - metadata definitions, quality standards |
| STIG | Infrastructure - schema enforcement, security |
| VEGA | Auditor - lineage verification, attestation |

### 4.2 ADR-002 - Audit Charter

All calendar operations must:

- Log to `fhq_calendar.ingestion_batches` with hash chains
- Maintain TOS/license evidence in `provider_tos_archive`
- Support court-proof verification per CEO Directive 2025-12-20

### 4.3 ADR-004 - Change Gates

Calendar changes follow the standard G0-G4 cycle:

| Gate | Calendar Requirement |
|------|---------------------|
| G0 | IoS-016 document (this), schema proposal |
| G1 | Schema DDL validated, timezone logic tested |
| G2 | VEGA lineage review, TOS compliance verified |
| G3 | QG-F1..F5 passed, VEGA attestation |
| G3.5 | 48h Shadow Mode (CEO S2 refinement) |
| G4 | CEO activation, production deployment |

### 4.4 ADR-008 - Key Management

| Component | ADR-008 Status |
|-----------|---------------|
| Calendar records | OPEN - Must be signed by CEIO key |
| Event ingestion batches | OPEN - Signature chain required |
| Schema migrations | Standard - STIG signature |

### 4.5 ADR-012 - Economic Safety

Calendar providers follow API waterfall:

| Tier | Calendar Sources |
|------|-----------------|
| Tier 1 (Lake) | FRED, yfinance (free) |
| Tier 2 (Pulse) | Economic calendars via CEIO |
| Tier 3 (Sniper) | Premium calendar APIs (rate-limited) |

### 4.6 ADR-013 - One-True-Source

`fhq_calendar.calendar_events` is the canonical source for all event data:

- Multi-vendor reconciliation via `source_conflict_log`
- Highest domain-specific reliability wins
- All consumers read from canonical table only

### 4.7 ADR-016 - DEFCON

Calendar respects circuit breaker states:

| DEFCON | Calendar Behavior |
|--------|-------------------|
| GREEN | Full operation, all event categories |
| YELLOW | Full operation, enhanced monitoring |
| ORANGE | Ingestion continues, tagging paused |
| RED | Read-only mode, no new ingestion |
| BLACK | Complete halt |

---

## 5. Functional Architecture

### 5.1 Component Overview

```
External Providers â†’ CEIO Ingestion â†’ Staging â†’ Reconciliation â†’ Canonical Events
                                                      â†“
                                              Source Conflict Log
                                                      â†“
Forecast Engine â†’ Event Tagger â†’ Tagged Forecasts â†’ Brier Analysis
                                        â†“
                                  Ghost Detector â†’ UMA Investigation
                                        â†“
                                  LVI Calculator â†’ CEO Dashboard
```

### 5.2 Event Type Registry

Defines canonical event types with metadata:

| Field | Description |
|-------|-------------|
| event_type_code | Primary key (e.g., 'US_FOMC', 'US_CPI') |
| event_category | MACRO, EQUITY, CRYPTO, CROSS_ASSET |
| impact_rank | 1-5 (5 = highest impact) |
| consensus_available | Whether consensus typically exists |
| actual_available | Whether actual value typically exists |
| surprise_normalization_unit | BPS for rates, PCT for CPI, etc. |
| historical_std_lookup_table | Reference for normalization |

### 5.3 Calendar Events

Stores event instances:

| Field | Description |
|-------|-------------|
| event_id | Primary key |
| event_type_code | FK to registry |
| event_timestamp | UTC enforced (TIMESTAMPTZ) |
| time_semantics | RELEASE_TIME, EMBARGO_LIFT, etc. |
| time_precision | DATE_ONLY, MINUTE, SECOND |
| consensus_estimate | Optional per event-type rules |
| actual_value | Optional per event-type rules |
| surprise_score | Normalized by historical_std |
| ceio_signature | Ed25519 signature |

### 5.4 Event Tagging

The `tag_event_proximity()` function classifies forecasts:

| Tag | Definition |
|-----|------------|
| EVENT_ADJACENT | Forecast falls within pre-event window |
| EVENT_NEUTRAL | No significant events within window |
| POST_EVENT | Forecast falls within post-event window |

Windows are governed by `leakage_detection_config`:

| Impact Rank | Pre-Event Window | Post-Event Window |
|-------------|-----------------|-------------------|
| 5 (Critical) | 4 hours | 24 hours |
| 4 (High) | 3 hours | 12 hours |
| 3 (Medium) | 2 hours | 6 hours |
| 2 (Low) | 1 hour | 3 hours |
| 1 (Minimal) | 30 minutes | 1 hour |

### 5.5 Ghost Event Detection

Flags unexplained volatility for investigation:

| Field | Description |
|-------|-------------|
| flag_id | Primary key |
| asset_id | Affected asset |
| detection_timestamp | When flagged |
| suspected_cause | COVERAGE_GAP, TIMESTAMP_DEFECT, MAPPING_DEFECT, TRUE_GHOST |
| triage_notes | Investigation notes |
| resolution_event_id | Linked event if found |

### 5.6 Asset-Specific Brier Alerts (CEO Strong Signal)

Monitors persistent asset-level Brier degradation:

| Alert Level | Condition | Action |
|-------------|-----------|--------|
| AMBER | Asset Brier > Portfolio Brier + 0.10 for 3+ cycles | Flag for UMA review |
| RED | Asset Brier > 0.60 for 5+ cycles | CEO alert + model quarantine |
| CRITICAL | Degradation correlates with EVENT_NEUTRAL windows | STRONG SIGNAL - investigate model edge |

---

## 6. LVI Formula

The Learning Velocity Index adjusted for events:

```
LVI_adjusted = SUM(Forecast_success * (1 - Event_proximity * Impact_rank)) / T_total
```

Where:
- `Forecast_success` = 1 if forecast within confidence interval, 0 otherwise
- `Event_proximity` = 0 (EVENT_NEUTRAL), 0.5 (POST_EVENT), 1.0 (EVENT_ADJACENT)
- `Impact_rank` = 0.2 to 1.0 (normalized from 1-5)
- `T_total` = Total time period

**Purpose:** Give CEO a realistic view of learning velocity without noise from scheduled events.

---

## 7. Provider Management

### 7.1 Provider State

Each provider has domain-specific reliability scores:

| Field | Description |
|-------|-------------|
| reliability_macro | 0-1 score for macro events |
| reliability_equity | 0-1 score for equity events |
| reliability_crypto | 0-1 score for crypto events |
| reliability_cross_asset | 0-1 score for cross-asset events |

### 7.2 TOS Compliance (CEO Refinement #3)

All providers must have documented TOS compliance:

| Field | Description |
|-------|-------------|
| tos_snapshot_hash | SHA-256 of TOS document |
| tos_snapshot_date | When TOS was captured |
| tos_permitted_use | Scope of permitted use |
| tos_redistribution_allowed | Boolean |
| tos_evidence_uri | Link to archived TOS |

### 7.3 Conflict Resolution

When providers disagree:

1. Domain-specific reliability score determines winner
2. Conflict logged to `source_conflict_log`
3. VEGA can flag for manual review if delta significant

---

## 8. Integration Points

### 8.1 IoS-001 (Canonical Asset Registry)

Calendar extends asset registry with event metadata:
- Event types linked to asset classes
- Asset-event mapping table

### 8.2 IoS-003 (Regime Engine)

Regime engine consumes event context:
- STRESS regime considers event proximity
- Regime transitions tagged with causal events

### 8.3 IoS-005 (Forecast Calibration)

Brier scores stratified by event proximity:
- EVENT_ADJACENT Brier separated from EVENT_NEUTRAL
- Clean windows identified for model skill assessment

### 8.4 IoS-010 (Prediction Ledger)

Forecasts tagged with event context:
- `event_proximity_tag` column
- `adjacent_event_id` reference
- `impact_rank` inheritance

### 8.5 UMA (EC-014)

UMA consumes:
- LVI_adjusted for learning velocity
- Brier stratification for drift detection
- Ghost event flags for calendar gap analysis

---

## 9. ROI Validation Plan (CEO Refinement #1)

### 9.1 Hypotheses to Validate

| Hypothesis | Validation Metric | Success Threshold | Deadline |
|------------|-------------------|-------------------|----------|
| False-negative reduction | EVENT_ADJACENT vs EVENT_NEUTRAL Brier delta | >= 0.05 | Day 28 |
| Brier improvement | Aggregate Brier Day 23 vs Day 9 | <= 0.42 | Day 28 |
| LVI_adjusted utility | CEO reports as actionable | Qualitative | Day 28 |
| Drift detection speed | Time from drift to alert | <= 4 hours | Day 28 |
| Leakage flagging | True positive rate on synthetic injection | >= 80% | Day 28 |

### 9.2 Stop-Loss Rules

| Condition | Action |
|-----------|--------|
| Brier degradation Day 23 > Day 9 + 0.03 | HALT Phase 2, investigate |
| LVI_adjusted computation errors > 5% | HALT UMA integration, fix formula |
| Ghost event false-positive rate > 30% | Disable ghost detection, recalibrate |
| Shadow Mode fails determinism test | DO NOT promote to production |
| Any stop-loss triggered | CEO review required before resumption |

---

## 10. Shadow Mode Protocol (CEO S2)

Before production activation:

1. CFAO activates 48h Shadow Mode
2. `tag_event_proximity()` runs in parallel, writes to shadow table
3. Determinism verified: same inputs â†’ same outputs
4. No drift in tagging logic over 48h window
5. CEO briefed on shadow results before G4 promotion

---

## 11. Activation Path (G0 - G4)

| Gate | Timeline | Deliverables | Status |
|------|----------|--------------|--------|
| G0 | Day 1 | IoS-016 document, schema proposal, evidence | SUBMITTING |
| G1 | Days 2-5 | DDL validated, timezone tested, reconciliation reviewed | PENDING |
| G2 | Days 6-8 | VEGA lineage review, ADR compliance, TOS archive | PENDING |
| G3 | Days 9-12 | QG-F1..F5, VEGA attestation, evidence bundle | PENDING |
| G3.5 | Days 12-14 | 48h Shadow Mode, determinism verified | PENDING |
| G4 | Day 14 | CEO approval, production activation | PENDING |

---

## 12. Closing Principle

> A system that learns without knowing what mattered, how much it mattered, and whether it surprised the world will never converge to edge.

IoS-016 ensures FjordHQ learns only from signal, never from noise.

---

## Appendix A: Database Schema

### A.1 Tables (in `fhq_calendar` schema)

1. **event_type_registry** - Canonical event types
2. **calendar_events** - Event instances
3. **event_asset_mapping** - Event-to-asset relationships
4. **staging_events** - Raw provider data
5. **calendar_provider_state** - Provider reliability + licensing
6. **source_conflict_log** - ADR-013 conflict resolution
7. **unexplained_volatility_flags** - Ghost event detection
8. **ingestion_batches** - ADR-002 audit trail
9. **provider_tos_archive** - TOS/License evidence
10. **leakage_detection_config** - Governed leakage windows
11. **asset_brier_alerts** - Asset-specific Brier alerts

### A.2 Functions

1. **tag_event_proximity()** - Automatic forecast tagging
2. **compute_lvi_adjusted()** - CEO-visible learning metric
3. **classify_brier_degradation()** - UMA learning classification
4. **detect_pre_event_drift()** - Information leakage detection
5. **resolve_source_conflict()** - ADR-013 highest-reliability-wins
6. **normalize_surprise_score()** - Per data-type normalization
7. **triage_ghost_event()** - Classify unexplained volatility cause
8. **verify_provider_tos()** - Check TOS compliance before ingestion
9. **monitor_asset_brier_persistence()** - Daily asset-specific Brier monitoring

---

*Document Hash: IoS-016-G0-2026-01-16-MBB++*
*Constitutional Compliance: VERIFIED*
*CEO Approval: Phase 1 Foundation APPROVED*
IoS-016 â€” Economic Calendar & Temporal Governance

Institutional Operating Standard (IoS)
System: FjordHQ Market System / ACI
Classification: GOVERNANCE-CRITICAL (MBB++)
Status: G0 SUBMITTED â€” G1 IN PROGRESS
Owner: LINE (Temporal Governance)
Operator: CEIO (Ingestion & Coverage)
Auditor: VEGA
Version: 1.0

1. Purpose

IoS-016 defines the institutional standard for economic calendar awareness and temporal governance within FjordHQ ACI.

Its purpose is to ensure that the system:

Understands when the world is about to speak

Distinguishes model error from event-driven volatility

Learns only from signal, never from known noise

Remains audit-defensible, cost-safe, and execution-isolated

This IoS introduces calendar intelligence as context, not as a trading signal.

2. Scope

IoS-016 applies to all assets tracked by FjordHQ, including:

Macro indicators (rates, inflation, employment, GDP)

Equities and equity indices

Fixed income and rates instruments

Crypto assets and protocols

Cross-asset structural events

It governs:

Calendar ingestion

Event classification

Temporal normalization

Event-to-asset mapping

Learning annotation and attribution

It does not govern execution, forecasting logic, or capital allocation.

3. Constitutional Alignment

IoS-016 is explicitly aligned with the FjordHQ Constitution.

Key mappings:

ADR-012 (Economic Safety): Free-first ingestion, API waterfall, quota controls

ADR-013 (One-True-Source): Single canonical calendar with conflict resolution

ADR-011 (Fortress Testing): Deterministic behavior under audit

ADR-014 (Sub-Executive Authority): LINE owns time, CEIO operates ingestion

ADR-016 (DEFCON): Calendar respects circuit breakers

ADR-020 (ACI): Calendar accelerates learning, not action

Calendar data is explicitly non-canonical to price truth.

4. Design Principles
4.1 Context, Not Signal

Calendar data:

MAY annotate forecasts

MAY explain learning outcomes

MAY suppress false-negative learning

MUST NEVER trigger trades or forecasts

4.2 Temporal Rigor

All timestamps stored in UTC

Timezone reconciliation is mandatory

Daylight Savings errors are Class B violations

Precision must be explicitly encoded (time_precision)

4.3 Determinism Over Convenience

Conflicting data is resolved, never averaged

Every canonical event must be explainable post-hoc

4.4 Free-First Economics

Public, free sources prioritized

Paid sources optional, never required

No single vendor dependency

5. Event Taxonomy

All calendar events are classified via a canonical registry.

5.1 Event Categories

MACRO_POLICY

MACRO_DATA

EQUITY_CORPORATE

EQUITY_STRUCTURAL

CRYPTO_NATIVE

CROSS_ASSET

5.2 Impact Rank

Each event type is assigned an impact_rank from 1 to 5:

1 â€” Low relevance noise

3 â€” Medium market relevance

5 â€” High-impact, regime-moving events

Impact rank is used for learning attribution, not prediction.

6. Surprise & Information Shock

For applicable events, the calendar stores:

consensus_estimate

actual_value

surprise_score

Surprise scores MUST be normalized by historical variance of that event type.

Purpose:

Distinguish expected volatility from information shock

Prevent UMA from excusing poor performance on unsurprising events

7. Information Leakage Detection

Markets often move before official timestamps.

IoS-016 mandates:

Pre-event drift analysis windows (impact-rank dependent)

Detection of Brier degradation before EVENT_ADJACENT window

This enables:

Identification of information leakage

Improved confidence dampening

Early warning of missing data sources

8. Ghost Events

If market behavior changes without known events, the system must not hallucinate explanations.

IoS-016 introduces Ghost Event Detection.

Ghost events are classified as:

COVERAGE_GAP

TIMESTAMP_DEFECT

MAPPING_DEFECT

TRUE_GHOST

These flags create a feedback loop to CEIO for coverage expansion.

9. Database Architecture

All calendar data lives in the dedicated schema:

fhq_calendar

Key tables include:

event_type_registry

calendar_events

event_asset_mapping

calendar_provider_state

source_conflict_log

unexplained_volatility_flags

ingestion_batches

Calendar data flows:

Provider â†’ staging_events â†’ canonical calendar_events â†’ learning annotation
10. UMA Integration

UMA is authorized to:

Explain Brier degradation

Compute event-adjusted learning metrics

Separate drift from noise

Surface repeated failures near event classes

UMA is explicitly not authorized to:

Suppress learning permanently

Override DEFCON

Justify persistent underperformance

Key metric introduced:

LVI_adjusted

Which weights learning in clean windows higher than event-adjacent periods.

11. Reporting Requirements

Daily and weekly reports must include:

Event-adjacent vs clean-window performance

Surprise-context annotations

Explicit unexplained volatility flags

Silence is acceptable. Unexplained error is not.

12. Governance Gates

IoS-016 follows full G0â€“G4 lifecycle.

G0: Architecture & ownership approval

G1: Technical validation

G2: Governance & audit review

G3: Operational stress test

G4: CEO activation

No gate may be skipped.

13. Audit & Defensibility

Every calendar event must be traceable to:

Source provider

Ingestion batch

Raw response hash

Canonical record hash

VEGA must be able to attest:

â€œThis system knew what was scheduled, when it was scheduled, and why it mattered.â€

14. Trading Calendar Integration (CEO-DIR-2026-091)

IoS-016 now includes mandatory trading calendar awareness as a first-class dependency.

### 14.1 Database Integration

IoS-016 consumes calendar truth via the `fhq_meta.ios016_calendar_truth` view:

| Field | Description |
|-------|-------------|
| market | Calendar identifier (US_EQUITY) |
| date | Calendar date |
| status | OPEN or CLOSED |
| reason | TRADING_DAY, WEEKEND, HOLIDAY, EARLY_CLOSE |
| provenance | LIBRARY (verified) or PROJECTED (extrapolated) |
| verified_at | Last verification timestamp |
| is_tentative | true if PROJECTED |

### 14.2 Daily Report Requirements

Every daily report MUST include:

```
Calendar Governance:
- Market open tomorrow? YES/NO (reason)
- Next 5 trading days: [dates]
- Projection window: N projected days in next 30 days
```

### 14.3 Provenance Rules

| Provenance | Trading Authority |
|------------|-------------------|
| LIBRARY | Full authority |
| PROJECTED | Display only - No trading decisions |

### 14.4 Crypto Epoch Boundary

Crypto uses 00:00:00 UTC as canonical daily boundary:

```sql
SELECT fhq_meta.crypto_epoch_boundary(timestamp);
```

Display as: `CRYPTO_EPOCH (00:00 UTC boundary)`

### 14.5 Forward Coverage Guarantee

- Minimum: 720 days (24 months) forward
- RED alert if within 30 days of threshold
- Monthly daemon extends coverage automatically

---

15. Failure Modes

IoS-016 explicitly guards against:

False-negative learning

Misclassified regime transitions

Inflated Brier degradation

Silent timezone drift

Vendor lock-in

Any violation is escalated per ADR severity rules.

15. Closing Principle

A system that learns without temporal context will always punish itself for reality.

IoS-016 ensures FjordHQ ACI learns with the world, not against it.

End of IoS-016
